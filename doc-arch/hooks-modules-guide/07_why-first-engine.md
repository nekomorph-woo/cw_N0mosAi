# Why-First å¼•æ“è¯¦è§£

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0
**æœ€åæ›´æ–°**: 2026-02-27
**ä½œè€…**: Claude Opus 4.6

---

## 1. æ¦‚è¿°

### 1.1 è®¾è®¡ç†å¿µ

Why-First å¼•æ“æ˜¯ N0mosAi ç³»ç»Ÿçš„"æ·±åº¦æ€è€ƒ"æ¨¡å—ï¼Œå…¶æ ¸å¿ƒè®¾è®¡ç†å¿µæ˜¯ **"å¼ºåˆ¶ AI åœ¨åŠ¨æ‰‹å‰å…ˆæ€è€ƒä¸ºä»€ä¹ˆ"**ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Why-First è®¾è®¡ç†å¿µ                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  ä¼ ç»Ÿ AI ç¼–ç æ¨¡å¼ï¼ˆ"æƒ³å½“ç„¶"æ¨¡å¼ï¼‰:                                    â”‚
â”‚  ç”¨æˆ·éœ€æ±‚ â†’ AI ç«‹å³å¼€å§‹å†™ä»£ç  â†’ å‘ç°é—®é¢˜ â†’ å¢é‡ä¿®è¡¥ â†’ è¶Šæ”¹è¶Šä¹±        â”‚
â”‚                                                                      â”‚
â”‚  N0mosAi Why-First æ¨¡å¼ï¼ˆæ·±åº¦æ€è€ƒæ¨¡å¼ï¼‰:                              â”‚
â”‚  ç”¨æˆ·éœ€æ±‚ â†’ Why é—®é¢˜ç”Ÿæˆ â†’ æ·±åº¦æ€è€ƒ â†’ çŸ¥è¯†æ²‰æ·€ â†’ Research â†’ ...      â”‚
â”‚              â†‘                              â”‚                        â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€ ä» project-why.md åŠ è½½å†å² â”€â”€â”€â”€â”˜              â”‚
â”‚                                                                      â”‚
â”‚  æ ¸å¿ƒä»·å€¼:                                                           â”‚
â”‚  - é¿å…å¹»è§‰: å¼ºåˆ¶ AI æ€è€ƒè€Œéå‡è®¾                                     â”‚
â”‚  - çŸ¥è¯†æ²‰æ·€: æ¯æ¬¡ä»»åŠ¡çš„"ä¸ºä»€ä¹ˆ"éƒ½æ²‰æ·€åˆ° project-why.md               â”‚
â”‚  - é¿å…é‡å¤é”™è¯¯: å†å²æ•™è®­è‡ªåŠ¨åŠ è½½åˆ°ä¸Šä¸‹æ–‡                            â”‚
â”‚  - æå‡è´¨é‡: å‰ç½®æ€è€ƒå‡å°‘åæœŸè¿”å·¥                                    â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 æ ¸å¿ƒåŠŸèƒ½

| åŠŸèƒ½ | è¯´æ˜ |
|------|------|
| **Why é—®é¢˜ç”Ÿæˆ** | æ ¹æ®ä»»åŠ¡åç§°å’Œæè¿°ç”Ÿæˆ 5-12 ä¸ªé’ˆå¯¹æ€§é—®é¢˜ |
| **çŸ¥è¯†åº“ç®¡ç†** | ç»´æŠ¤ project-why.md çŸ¥è¯†åº“ |
| **ç›¸ä¼¼æ£€æµ‹** | æ£€æµ‹æ–°çŸ¥è¯†ä¸å·²æœ‰æ¡ç›®çš„ç›¸ä¼¼åº¦ï¼Œé¿å…é‡å¤ |
| **çŸ¥è¯†å¢å¼º** | åœ¨ç°æœ‰æ¡ç›®åŸºç¡€ä¸Šè¡¥å……ä¿¡æ¯ |
| **çŸ¥è¯†åˆå¹¶** | å°†ç›¸ä¼¼æ¡ç›®åˆå¹¶ï¼Œä¿æŒçŸ¥è¯†åº“æ•´æ´ |

### 1.3 ä¸ Phase Gates çš„å…³ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Why-First åœ¨ Phase Gates ä¸­çš„ä½ç½®                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  Why-First    â”‚â”€â”€â”€â–ºâ”‚   Research    â”‚â”€â”€â”€â–ºâ”‚     Plan      â”‚        â”‚
â”‚  â”‚   (å†…åµŒé˜¶æ®µ)   â”‚    â”‚   (è°ƒç ”é˜¶æ®µ)   â”‚    â”‚   (è®¡åˆ’é˜¶æ®µ)   â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚         â”‚                                                              â”‚
â”‚         â”‚                                                              â”‚
â”‚         â–¼                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Why-First æ˜¯ Research é˜¶æ®µçš„ç¬¬ä¸€ä¸ªæ­¥éª¤:                         â”‚   â”‚
â”‚  â”‚ 1. ç”Ÿæˆ Why é—®é¢˜                                              â”‚   â”‚
â”‚  â”‚ 2. ä» project-why.md åŠ è½½ç›¸å…³å†å²                              â”‚   â”‚
â”‚  â”‚ 3. åœ¨ research.md çš„ "Why Questions" éƒ¨åˆ†å›ç­”é—®é¢˜              â”‚   â”‚
â”‚  â”‚ 4. å°†é‡è¦å†³ç­–æ²‰æ·€åˆ° project-why.md                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ç³»ç»Ÿæ¶æ„è®¾è®¡

### 2.1 æ¶æ„å®šä½

Why-First å¼•æ“åœ¨ N0mosAi ç³»ç»Ÿæ¶æ„ä¸­çš„ä½ç½®ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç”¨æˆ·äº¤äº’å±‚                                      â”‚
â”‚  (Claude Code CLI / Task Viewer HTML ç•Œé¢)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SKILL ç¼–æ’å±‚                                    â”‚
â”‚  (/nomos ä¸» SKILL + å­ SKILL)                                        â”‚
â”‚  â”œâ”€â”€ /nomos:start      â†’ å¯åŠ¨å®Œæ•´æµç¨‹ï¼ˆåŒ…å« Why-Firstï¼‰             â”‚
â”‚  â””â”€â”€ /nomos:update-why â†’ æ›´æ–° project-why.md                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ã€Why-First å¼•æ“åœ¨æ­¤å±‚ã€‘                          â”‚
â”‚                      çŸ¥è¯†ç®¡ç†å±‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ WhyFirstEngine                                                 â”‚ â”‚
â”‚  â”‚ â”œâ”€â”€ generate_why_questions()  â†’ ç”Ÿæˆ Why é—®é¢˜                  â”‚ â”‚
â”‚  â”‚ â”œâ”€â”€ add_knowledge()           â†’ æ·»åŠ çŸ¥è¯†æ¡ç›®                   â”‚ â”‚
â”‚  â”‚ â”œâ”€â”€ search_knowledge()        â†’ æœç´¢çŸ¥è¯†åº“                     â”‚ â”‚
â”‚  â”‚ â”œâ”€â”€ detect_similar_knowledge()â†’ æ£€æµ‹ç›¸ä¼¼æ¡ç›®                   â”‚ â”‚
â”‚  â”‚ â”œâ”€â”€ enhance_knowledge()       â†’ å¢å¼ºç°æœ‰æ¡ç›®                   â”‚ â”‚
â”‚  â”‚ â””â”€â”€ suggest_merge()           â†’ å»ºè®®åˆå¹¶æ¡ç›®                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      çŠ¶æ€æŒä¹…åŒ–å±‚                                    â”‚
â”‚  â”œâ”€â”€ project-why.md          â† ã€çŸ¥è¯†åº“æ–‡ä»¶ã€‘                       â”‚
â”‚  â””â”€â”€ tasks/t{N}-{date}-{name}/                                      â”‚
â”‚       â””â”€â”€ research.md         â† Why é—®é¢˜å›ç­”                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 è®¾è®¡è¦æ±‚ï¼ˆä»æ¶æ„æ–‡æ¡£æå–ï¼‰

æ ¹æ® `03_System_Architecture.md` ç¬¬ 3.1 èŠ‚ï¼ŒWhy-First å¼•æ“çš„è®¾è®¡è¦æ±‚ï¼š

| éœ€æ±‚ ID | è®¾è®¡è¦æ±‚ | æ¥æº |
|---------|----------|------|
| FR-011 | ç³»ç»Ÿåº”æ”¯æŒ Why-First é˜¶æ®µï¼Œé€šè¿‡è‹æ ¼æ‹‰åº•å¼æé—®å¼ºåˆ¶æ·±åº¦æ€è€ƒ | arch 3.1 |
| FR-022 | ç³»ç»Ÿåº”æ”¯æŒ project-why.md æ™ºèƒ½ç»´æŠ¤ | arch 3.12 |
| FR-119 | ç³»ç»Ÿåº”æ”¯æŒ Knowledge Similarity Detector | arch 3.12.1 |
| FR-120 | ç³»ç»Ÿåº”æ”¯æŒ Knowledge Merge | arch 3.12.2 |

### 2.3 çŸ¥è¯†åº“ç»“æ„è®¾è®¡

**project-why.md æ–‡ä»¶ç»“æ„**:

```markdown
---
project: N0mosAi
created: 2026-02-26
version: 0.1.0
status: active
---

# Project Why - N0mosAi é¡¹ç›®çŸ¥è¯†åº“

æœ¬æ–‡æ¡£è®°å½•é¡¹ç›®çš„æ ¸å¿ƒå†³ç­–ã€ç»éªŒæ•™è®­å’Œé‡è¦çŸ¥è¯†ã€‚

## æ ¸å¿ƒç†å¿µ

### ä¸ºä»€ä¹ˆéœ€è¦ N0mosAiï¼Ÿ

**æ—¶é—´**: 2026-02-26

[æ ¸å¿ƒåŠ¨æœºå’Œä»·å€¼çš„è¯¦ç»†æè¿°...]

## æ¶æ„å†³ç­–

### ä¸ºä»€ä¹ˆé€‰æ‹© Markdown ä½œä¸ºçŠ¶æ€å­˜å‚¨ï¼Ÿ

**æ—¶é—´**: 2026-02-25

**åŸå› **: Markdown äººç±»å¯è¯»ã€Git å‹å¥½ã€è·¨ä¼šè¯æŒä¹…åŒ–

**ç›¸å…³ä»£ç **: .claude/hooks/lib/

**æœ€åæ›´æ–°**: 2026-02-26

**çŠ¶æ€**: ä»æœ‰æ•ˆ

## ç»éªŒæ•™è®­

### 2026-02-25: å¿…é¡»èµ° Repository å±‚

**æ—¶é—´**: 2026-02-25

**é”™è¯¯**: å°è¯•ç›´æ¥è°ƒç”¨ ORM è€Œé Repository

**åŸå› **: æœªæ³¨æ„åˆ°äº‹åŠ¡ç®¡ç†ä¾èµ– Repository å±‚

**æ•™è®­**: æ‰€æœ‰æ•°æ®è®¿é—®å¿…é¡»é€šè¿‡ Repository å±‚

**è¡¥å……** (2026-02-26):
å¢åŠ äº†ç¼“å­˜å±‚åï¼ŒRepository å±‚çš„é‡è¦æ€§æ›´åŠ çªå‡º

## å¸¸è§é—®é¢˜

### å¦‚ä½•å¤„ç†è·¨æ¨¡å—ä¾èµ–ï¼Ÿ

**æ—¶é—´**: 2026-02-25

[è§£å†³æ–¹æ¡ˆæè¿°...]
```

---

## 3. ä»£ç å®ç°è¯¦è§£

### 3.1 æ–‡ä»¶ç»“æ„

```
.claude/hooks/lib/
â”œâ”€â”€ why_first_engine.py       # æ ¸å¿ƒ Why-First å¼•æ“
â””â”€â”€ ...

.claude/skills/nomos/prompts/
â”œâ”€â”€ start.md                  # ä»»åŠ¡å¯åŠ¨æµç¨‹ï¼ˆåŒ…å« Why-Firstï¼‰
â””â”€â”€ update-why.md             # project-why.md ç»´æŠ¤ prompt
```

### 3.2 WhyFirstEngine ç±»ç»“æ„

**æ–‡ä»¶ä½ç½®**: `/Volumes/Under_M2/a056cw/cw_N0mosAi/.claude/hooks/lib/why_first_engine.py`

```python
class WhyFirstEngine:
    """Why-First å¼•æ“"""

    def __init__(self, project_root: Optional[str] = None):
        """
        åˆå§‹åŒ– Why-First å¼•æ“

        Args:
            project_root: é¡¹ç›®æ ¹ç›®å½•
        """
        self.project_root = Path(project_root or os.getcwd())
        self.project_why_file = self.project_root / 'project-why.md'
```

**è®¾è®¡åˆ†æ**:

- å•ä¸€èŒè´£ï¼šä¸“æ³¨äº Why é—®é¢˜ç”Ÿæˆå’ŒçŸ¥è¯†åº“ç®¡ç†
- ä¾èµ–æœ€å°åŒ–ï¼šä»…ä¾èµ– Python æ ‡å‡†åº“
- è·¯å¾„çµæ´»æ€§ï¼šæ”¯æŒè‡ªå®šä¹‰é¡¹ç›®æ ¹ç›®å½•

### 3.3 Why é—®é¢˜ç”Ÿæˆ

**ä»£ç ä½ç½®**: `why_first_engine.py:27-46`

```python
def generate_why_questions(self, task_name: str, description: str) -> List[str]:
    """
    ç”Ÿæˆ Why é—®é¢˜

    Args:
        task_name: ä»»åŠ¡åç§°
        description: ä»»åŠ¡æè¿°

    Returns:
        Why é—®é¢˜åˆ—è¡¨
    """
    questions = [
        f"ä¸ºä»€ä¹ˆéœ€è¦ {task_name}ï¼Ÿ",
        f"ä¸ºä»€ä¹ˆç°åœ¨åš {task_name}ï¼Ÿ",
        f"ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ç§æ–¹å¼å®ç° {task_name}ï¼Ÿ",
        f"ä¸ºä»€ä¹ˆä¸ç”¨å…¶ä»–æ–¹æ¡ˆï¼Ÿ",
        f"{task_name} çš„æ ¸å¿ƒä»·å€¼æ˜¯ä»€ä¹ˆï¼Ÿ"
    ]

    return questions
```

**é—®é¢˜ç»´åº¦åˆ†æ**:

| é—®é¢˜ | ç»´åº¦ | ç›®çš„ |
|------|------|------|
| "ä¸ºä»€ä¹ˆéœ€è¦" | æ ¸å¿ƒåŠ¨æœº | ç¡®è®¤åŠŸèƒ½å¿…è¦æ€§ |
| "ä¸ºä»€ä¹ˆç°åœ¨åš" | æ—¶æœºé€‰æ‹© | è¯„ä¼°ä¼˜å…ˆçº§ |
| "ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ç§æ–¹å¼" | æ–¹æ¡ˆé€‰æ‹© | éªŒè¯æŠ€æœ¯å†³ç­– |
| "ä¸ºä»€ä¹ˆä¸ç”¨å…¶ä»–æ–¹æ¡ˆ" | æ›¿ä»£åˆ†æ | é¿å…é—æ¼æ›´å¥½æ–¹æ¡ˆ |
| "æ ¸å¿ƒä»·å€¼æ˜¯ä»€ä¹ˆ" | ä»·å€¼ä¸»å¼  | æ˜ç¡®æˆåŠŸæ ‡å‡† |

### 3.4 çŸ¥è¯†åº“ç®¡ç†

#### 3.4.1 æ·»åŠ çŸ¥è¯†æ¡ç›®

**ä»£ç ä½ç½®**: `why_first_engine.py:48-113`

```python
def add_knowledge(self, category: str, title: str, content: str) -> bool:
    """
    æ·»åŠ çŸ¥è¯†åˆ° project-why.md

    Args:
        category: åˆ†ç±»ï¼ˆæ ¸å¿ƒç†å¿µ/æ¶æ„å†³ç­–/ç»éªŒæ•™è®­/å¸¸è§é—®é¢˜ï¼‰
        title: æ ‡é¢˜
        content: å†…å®¹

    Returns:
        æ˜¯å¦æˆåŠŸ
    """
    if not self.project_why_file.exists():
        return False

    # è¯»å–ç°æœ‰å†…å®¹
    with open(self.project_why_file, 'r', encoding='utf-8') as f:
        lines = f.readlines()

    # æŸ¥æ‰¾åˆ†ç±»ä½ç½®
    category_map = {
        'æ ¸å¿ƒç†å¿µ': '## æ ¸å¿ƒç†å¿µ',
        'æ¶æ„å†³ç­–': '## æ¶æ„å†³ç­–',
        'ç»éªŒæ•™è®­': '## ç»éªŒæ•™è®­',
        'å¸¸è§é—®é¢˜': '## å¸¸è§é—®é¢˜'
    }

    category_header = category_map.get(category)
    if not category_header:
        return False

    # æ‰¾åˆ°åˆ†ç±»ä½ç½®
    insert_index = -1
    for i, line in enumerate(lines):
        if line.strip() == category_header:
            # æ‰¾åˆ°ä¸‹ä¸€ä¸ª ## æˆ–æ–‡ä»¶æœ«å°¾
            for j in range(i + 1, len(lines)):
                if lines[j].startswith('## '):
                    insert_index = j
                    break
            if insert_index == -1:
                insert_index = len(lines)
            break

    if insert_index == -1:
        return False

    # æ’å…¥æ–°å†…å®¹
    timestamp = datetime.now().strftime('%Y-%m-%d')
    new_content = [
        '\n',
        f'### {title}\n',
        '\n',
        f'**æ—¶é—´**: {timestamp}\n',
        '\n',
        f'{content}\n',
        '\n'
    ]

    lines[insert_index:insert_index] = new_content

    # å†™å›æ–‡ä»¶
    with open(self.project_why_file, 'w', encoding='utf-8') as f:
        f.writelines(lines)

    return True
```

**æ”¯æŒçš„åˆ†ç±»**:

| åˆ†ç±» | ç”¨é€” | ç¤ºä¾‹ |
|------|------|------|
| **æ ¸å¿ƒç†å¿µ** | é¡¹ç›®çš„æ ¸å¿ƒä»·å€¼è§‚å’Œè®¾è®¡ç†å¿µ | "ä¸ºä»€ä¹ˆéœ€è¦ N0mosAi" |
| **æ¶æ„å†³ç­–** | é‡è¦çš„æŠ€æœ¯æ¶æ„å†³ç­–åŠå…¶ç†ç”± | "ä¸ºä»€ä¹ˆé€‰æ‹© Hooks è€Œé Prompt" |
| **ç»éªŒæ•™è®­** | å¤±è´¥æ¡ˆä¾‹å’Œå­¦åˆ°çš„æ•™è®­ | "å¿…é¡»èµ° Repository å±‚" |
| **å¸¸è§é—®é¢˜** | å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ | "å¦‚ä½•å¤„ç†è·¨æ¨¡å—ä¾èµ–" |

#### 3.4.2 æœç´¢çŸ¥è¯†

**ä»£ç ä½ç½®**: `why_first_engine.py:115-145`

```python
def search_knowledge(self, keyword: str) -> List[Dict[str, str]]:
    """
    æœç´¢çŸ¥è¯†åº“

    Args:
        keyword: å…³é”®è¯

    Returns:
        åŒ¹é…çš„çŸ¥è¯†æ¡ç›®åˆ—è¡¨
    """
    if not self.project_why_file.exists():
        return []

    with open(self.project_why_file, 'r', encoding='utf-8') as f:
        content = f.read()

    results = []
    sections = re.split(r'\n### ', content)

    for section in sections[1:]:  # è·³è¿‡ç¬¬ä¸€ä¸ªï¼ˆYAML frontmatter å’Œæ ‡é¢˜ï¼‰
        if keyword.lower() in section.lower():
            lines = section.split('\n', 1)
            title = lines[0].strip()
            body = lines[1] if len(lines) > 1 else ''

            results.append({
                'title': title,
                'content': body.strip()
            })

    return results
```

**æœç´¢ç‰¹ç‚¹**:

- å¤§å°å†™ä¸æ•æ„Ÿ
- åŸºäº `###` æ ‡é¢˜åˆ†èŠ‚
- è¿”å›æ ‡é¢˜å’Œå†…å®¹

#### 3.4.3 è·å–æœ€è¿‘çŸ¥è¯†

**ä»£ç ä½ç½®**: `why_first_engine.py:147-184`

```python
def get_recent_knowledge(self, limit: int = 5) -> List[Dict[str, str]]:
    """
    è·å–æœ€è¿‘çš„çŸ¥è¯†æ¡ç›®

    Args:
        limit: è¿”å›æ•°é‡

    Returns:
        çŸ¥è¯†æ¡ç›®åˆ—è¡¨
    """
    if not self.project_why_file.exists():
        return []

    with open(self.project_why_file, 'r', encoding='utf-8') as f:
        content = f.read()

    results = []
    sections = re.split(r'\n### ', content)

    for section in sections[1:]:  # è·³è¿‡ç¬¬ä¸€ä¸ª
        lines = section.split('\n', 1)
        title = lines[0].strip()
        body = lines[1] if len(lines) > 1 else ''

        # æå–æ—¶é—´
        time_match = re.search(r'\*\*æ—¶é—´\*\*:\s*(\d{4}-\d{2}-\d{2})', body)
        timestamp = time_match.group(1) if time_match else '1970-01-01'

        results.append({
            'title': title,
            'content': body.strip(),
            'timestamp': timestamp
        })

    # æŒ‰æ—¶é—´æ’åº
    results.sort(key=lambda x: x['timestamp'], reverse=True)

    return results[:limit]
```

### 3.5 çŸ¥è¯†ç›¸ä¼¼åº¦æ£€æµ‹

#### 3.5.1 ç›¸ä¼¼åº¦è®¡ç®—

**ä»£ç ä½ç½®**: `why_first_engine.py:248-259`

```python
def _calculate_similarity(self, text1: str, text2: str) -> float:
    """
    è®¡ç®—æ–‡æœ¬ç›¸ä¼¼åº¦

    Args:
        text1: æ–‡æœ¬1
        text2: æ–‡æœ¬2

    Returns:
        ç›¸ä¼¼åº¦ (0-1)
    """
    return SequenceMatcher(None, text1.lower(), text2.lower()).ratio()
```

**ç®—æ³•è¯´æ˜**:

- ä½¿ç”¨ Python æ ‡å‡†åº“ `difflib.SequenceMatcher`
- åŸºäº longest common subsequence ç®—æ³•
- å¤§å°å†™ä¸æ•æ„Ÿ

#### 3.5.2 ç›¸ä¼¼æ¡ç›®æ£€æµ‹

**ä»£ç ä½ç½®**: `why_first_engine.py:208-246`

```python
def detect_similar_knowledge(self, new_content: str, threshold: float = 0.7) -> List[Dict[str, any]]:
    """
    æ£€æµ‹ç›¸ä¼¼çš„çŸ¥è¯†æ¡ç›®

    Args:
        new_content: æ–°å†…å®¹
        threshold: ç›¸ä¼¼åº¦é˜ˆå€¼ (0-1)

    Returns:
        ç›¸ä¼¼æ¡ç›®åˆ—è¡¨
    """
    if not self.project_why_file.exists():
        return []

    with open(self.project_why_file, 'r', encoding='utf-8') as f:
        content = f.read()

    similar_items = []
    sections = re.split(r'\n### ', content)

    for section in sections[1:]:
        lines = section.split('\n', 1)
        title = lines[0].strip()
        body = lines[1] if len(lines) > 1 else ''

        # è®¡ç®—ç›¸ä¼¼åº¦
        similarity = self._calculate_similarity(new_content, body)

        if similarity >= threshold:
            similar_items.append({
                'title': title,
                'content': body.strip(),
                'similarity': similarity
            })

    # æŒ‰ç›¸ä¼¼åº¦æ’åº
    similar_items.sort(key=lambda x: x['similarity'], reverse=True)

    return similar_items
```

**ç›¸ä¼¼åº¦é˜ˆå€¼å»ºè®®**:

| ç›¸ä¼¼åº¦èŒƒå›´ | å»ºè®®æ“ä½œ |
|-----------|---------|
| 0.8+ | å¢å¼ºç°æœ‰æ¡ç›®ï¼ˆæ·»åŠ è¡¥å……ä¿¡æ¯ï¼‰ |
| 0.6-0.8 | è€ƒè™‘åˆå¹¶æ¡ç›® |
| < 0.6 | åˆ›å»ºæ–°æ¡ç›® |

### 3.6 çŸ¥è¯†åˆå¹¶ä¸å¢å¼º

#### 3.6.1 åˆå¹¶å»ºè®®

**ä»£ç ä½ç½®**: `why_first_engine.py:261-276`

```python
def suggest_merge(self, item1: Dict, item2: Dict) -> Dict[str, str]:
    """
    å»ºè®®åˆå¹¶ä¸¤ä¸ªçŸ¥è¯†æ¡ç›®

    Args:
        item1: æ¡ç›®1
        item2: æ¡ç›®2

    Returns:
        åˆå¹¶å»ºè®®
    """
    return {
        'merged_title': f"{item1['title']} & {item2['title']}",
        'merged_content': f"{item1['content']}\n\n---\n\n{item2['content']}",
        'reason': f"ç›¸ä¼¼åº¦: {item1.get('similarity', 0):.2%}"
    }
```

#### 3.6.2 çŸ¥è¯†å¢å¼º

**ä»£ç ä½ç½®**: `why_first_engine.py:278-312`

```python
def enhance_knowledge(self, title: str, additional_info: str) -> bool:
    """
    å¢å¼ºç°æœ‰çŸ¥è¯†æ¡ç›®

    Args:
        title: æ¡ç›®æ ‡é¢˜
        additional_info: é¢å¤–ä¿¡æ¯

    Returns:
        æ˜¯å¦æˆåŠŸ
    """
    if not self.project_why_file.exists():
        return False

    with open(self.project_why_file, 'r', encoding='utf-8') as f:
        content = f.read()

    # æŸ¥æ‰¾æ¡ç›®
    pattern = rf'### {re.escape(title)}\n\n(.*?)(?=\n### |\Z)'
    match = re.search(pattern, content, re.DOTALL)

    if not match:
        return False

    # åœ¨æ¡ç›®æœ«å°¾æ·»åŠ ä¿¡æ¯
    old_content = match.group(0)
    new_content = old_content.rstrip() + f"\n\n**è¡¥å……** ({datetime.now().strftime('%Y-%m-%d')}):\n{additional_info}\n"

    # æ›¿æ¢
    updated_content = content.replace(old_content, new_content)

    with open(self.project_why_file, 'w', encoding='utf-8') as f:
        f.write(updated_content)

    return True
```

**å¢å¼ºæ ¼å¼ç¤ºä¾‹**:

```markdown
### ä¸ºä»€ä¹ˆé€‰æ‹© Markdown ä½œä¸ºçŠ¶æ€å­˜å‚¨ï¼Ÿ

**æ—¶é—´**: 2026-02-25

**åŸå› **: Markdown äººç±»å¯è¯»ã€Git å‹å¥½ã€è·¨ä¼šè¯æŒä¹…åŒ–

**è¡¥å……** (2026-02-26):
ç»è¿‡ä¸€å‘¨ä½¿ç”¨ï¼Œå‘ç° Markdown çš„å¦ä¸€ä¸ªä¼˜åŠ¿ï¼š
æ”¯æŒåœ¨ IDE ä¸­ç›´æ¥é¢„è§ˆå’Œç¼–è¾‘ï¼Œæ— éœ€é¢å¤–å·¥å…·
```

### 3.7 Why é—®é¢˜éªŒè¯

**ä»£ç ä½ç½®**: `why_first_engine.py:186-206`

```python
def validate_why_answers(self, research_content: str) -> Dict[str, bool]:
    """
    éªŒè¯ research.md ä¸­æ˜¯å¦å›ç­”äº† Why é—®é¢˜

    Args:
        research_content: research.md å†…å®¹

    Returns:
        éªŒè¯ç»“æœå­—å…¸
    """
    required_sections = [
        'ä¸ºä»€ä¹ˆéœ€è¦',
        'ä¸ºä»€ä¹ˆé€‰æ‹©',
        'ä¸ºä»€ä¹ˆä¸'
    ]

    results = {}
    for section in required_sections:
        results[section] = section in research_content

    return results
```

**éªŒè¯é€»è¾‘**:

- æ£€æŸ¥ research.md ä¸­æ˜¯å¦åŒ…å«å¿…è¦çš„å…³é”®è¯
- è¿”å›å„å…³é”®è¯çš„å­˜åœ¨çŠ¶æ€

---

## 4. è®¾è®¡ vs å®ç°å¯¹æ¯”

### 4.1 å®Œæˆåº¦åˆ†æ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     è®¾è®¡ vs å®ç°å¯¹æ¯”                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  æ ¸å¿ƒåŠŸèƒ½                                                            â”‚
â”‚  â”œâ”€â”€ Why é—®é¢˜ç”Ÿæˆ        âœ… å·²å®ç°ï¼ˆå›ºå®š 5 ä¸ªé—®é¢˜ï¼‰                  â”‚
â”‚  â”œâ”€â”€ çŸ¥è¯†åº“æ·»åŠ            âœ… å·²å®ç°                                  â”‚
â”‚  â”œâ”€â”€ çŸ¥è¯†åº“æœç´¢           âœ… å·²å®ç°                                  â”‚
â”‚  â”œâ”€â”€ ç›¸ä¼¼åº¦æ£€æµ‹           âœ… å·²å®ç°                                  â”‚
â”‚  â”œâ”€â”€ çŸ¥è¯†å¢å¼º             âœ… å·²å®ç°                                  â”‚
â”‚  â”œâ”€â”€ çŸ¥è¯†åˆå¹¶å»ºè®®         âœ… å·²å®ç°                                  â”‚
â”‚  â””â”€â”€ Why ç­”æ¡ˆéªŒè¯         âœ… å·²å®ç°                                  â”‚
â”‚                                                                      â”‚
â”‚  è®¾è®¡æ–‡æ¡£è¦æ±‚                                                        â”‚
â”‚  â”œâ”€â”€ é’ˆå¯¹æ€§é—®é¢˜ç”Ÿæˆ      âš ï¸ æœªå®ç°ï¼ˆå½“å‰æ˜¯å›ºå®šé—®é¢˜ï¼‰                 â”‚
â”‚  â”œâ”€â”€ ä»£ç æ‰«æé›†æˆ        âŒ æœªå®ç°                                  â”‚
â”‚  â”œâ”€â”€ å†å² Why åŠ è½½       âš ï¸ éƒ¨åˆ†å®ç°ï¼ˆsearch_knowledge å­˜åœ¨ï¼‰       â”‚
â”‚  â””â”€â”€ æ™ºèƒ½é—®é¢˜æ•°é‡         âš ï¸ æœªå®ç°ï¼ˆè®¾è®¡è¦æ±‚ 5-12 ä¸ªï¼‰              â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 å·®å¼‚åˆ†æ

#### 4.2.1 Why é—®é¢˜ç”Ÿæˆ

**è®¾è®¡è¦æ±‚** (`03_System_Architecture.md:764-781`):

```python
def generate_why_questions(requirement, project_why_md):
    # 1. æå–éœ€æ±‚å…³é”®è¯
    keywords = extract_keywords(requirement)

    # 2. æ‰«æå—å½±å“èŒƒå›´(åªçœ‹ç›¸å…³æ¨¡å—)
    affected_modules = scan_affected_modules(keywords)

    # 3. ä» project-why.md åŠ è½½ç›¸å…³å†å²
    historical_why = load_relevant_why(project_why_md, affected_modules)

    # 4. ç”Ÿæˆ 5-12 ä¸ªé’ˆå¯¹æ€§é—®é¢˜
    questions = []
    for module in affected_modules:
        questions.extend(generate_module_questions(module, historical_why))

    return questions[:12]  # æœ€å¤š 12 ä¸ª
```

**å®é™…å®ç°** (`why_first_engine.py:27-46`):

```python
def generate_why_questions(self, task_name: str, description: str) -> List[str]:
    questions = [
        f"ä¸ºä»€ä¹ˆéœ€è¦ {task_name}ï¼Ÿ",
        f"ä¸ºä»€ä¹ˆç°åœ¨åš {task_name}ï¼Ÿ",
        f"ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ç§æ–¹å¼å®ç° {task_name}ï¼Ÿ",
        f"ä¸ºä»€ä¹ˆä¸ç”¨å…¶ä»–æ–¹æ¡ˆï¼Ÿ",
        f"{task_name} çš„æ ¸å¿ƒä»·å€¼æ˜¯ä»€ä¹ˆï¼Ÿ"
    ]
    return questions
```

**å·®å¼‚è¯´æ˜**:

| ç»´åº¦ | è®¾è®¡è¦æ±‚ | å®é™…å®ç° | å·®è· |
|------|----------|----------|------|
| **å…³é”®è¯æå–** | éœ€è¦å®ç° | æœªå®ç° | ç¼ºå°‘ NLP èƒ½åŠ› |
| **ä»£ç æ‰«æ** | éœ€è¦å®ç° | æœªå®ç° | ç¼ºå°‘ä»£ç åˆ†æ |
| **å†å²åŠ è½½** | è‡ªåŠ¨å…³è” | éœ€æ‰‹åŠ¨è°ƒç”¨ | ç¼ºå°‘æ™ºèƒ½å…³è” |
| **é—®é¢˜æ•°é‡** | 5-12 ä¸ª | å›ºå®š 5 ä¸ª | ç¼ºå°‘åŠ¨æ€ç”Ÿæˆ |
| **é’ˆå¯¹æ€§** | åŸºäºæ¨¡å— | é€šç”¨æ¨¡æ¿ | ç¼ºå°‘ä¸Šä¸‹æ–‡æ„ŸçŸ¥ |

#### 4.2.2 å»ºè®®å¢å¼ºå®ç°

```python
def generate_why_questions_enhanced(self, task_name: str, description: str) -> List[str]:
    """
    å¢å¼ºç‰ˆ Why é—®é¢˜ç”Ÿæˆï¼ˆå»ºè®®å®ç°ï¼‰
    """
    # 1. åŸºç¡€é—®é¢˜
    base_questions = [
        f"ä¸ºä»€ä¹ˆéœ€è¦ {task_name}ï¼Ÿ",
        f"ä¸ºä»€ä¹ˆç°åœ¨åš {task_name}ï¼Ÿ",
        f"{task_name} çš„æ ¸å¿ƒä»·å€¼æ˜¯ä»€ä¹ˆï¼Ÿ"
    ]

    # 2. ä»æè¿°æå–å…³é”®è¯
    keywords = self._extract_keywords(description)

    # 3. ä» project-why.md åŠ è½½ç›¸å…³å†å²
    historical = []
    for keyword in keywords:
        historical.extend(self.search_knowledge(keyword))

    # 4. åŸºäºå†å²ç”Ÿæˆé’ˆå¯¹æ€§é—®é¢˜
    contextual_questions = []
    for item in historical[:3]:
        contextual_questions.append(
            f"ä¸å†å²å†³ç­– '{item['title']}' ç›¸æ¯”ï¼Œ{task_name} æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ"
        )

    # 5. åˆå¹¶å¹¶å»é‡
    all_questions = base_questions + contextual_questions
    return all_questions[:12]

def _extract_keywords(self, text: str) -> List[str]:
    """æå–å…³é”®è¯ï¼ˆç®€å•å®ç°ï¼‰"""
    # åœç”¨è¯åˆ—è¡¨
    stop_words = {'çš„', 'æ˜¯', 'åœ¨', 'å’Œ', 'äº†', 'æœ‰', 'ä¸', 'è¿™', 'æˆ‘', 'è¦'}

    # ç®€å•åˆ†è¯ï¼ˆæŒ‰ç©ºæ ¼å’Œæ ‡ç‚¹ï¼‰
    words = re.findall(r'[\w\u4e00-\u9fff]+', text.lower())

    # è¿‡æ»¤åœç”¨è¯å¹¶è¿”å›
    return [w for w in words if w not in stop_words and len(w) > 1]
```

---

## 5. ä½¿ç”¨æµç¨‹å›¾

### 5.1 Why-First å®Œæ•´æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Why-First å®Œæ•´æµç¨‹                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  ç”¨æˆ·æ‰§è¡Œ /nomos:start <ä»»åŠ¡å>                                      â”‚
â”‚         â”‚                                                            â”‚
â”‚         â–¼                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Step 1: åˆå§‹åŒ– Why-First å¼•æ“                                   â”‚â”‚
â”‚  â”‚                                                                 â”‚â”‚
â”‚  â”‚ why_engine = WhyFirstEngine()                                  â”‚â”‚
â”‚  â”‚ questions = why_engine.generate_why_questions(task, desc)      â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚         â”‚                                                            â”‚
â”‚         â–¼                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Step 2: ä» project-why.md åŠ è½½ç›¸å…³å†å²                          â”‚â”‚
â”‚  â”‚                                                                 â”‚â”‚
â”‚  â”‚ historical = why_engine.search_knowledge(task_name)            â”‚â”‚
â”‚  â”‚ recent = why_engine.get_recent_knowledge(limit=5)              â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚         â”‚                                                            â”‚
â”‚         â–¼                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Step 3: åœ¨ research.md ä¸­å›ç­” Why é—®é¢˜                          â”‚â”‚
â”‚  â”‚                                                                 â”‚â”‚
â”‚  â”‚ ## 4. Why Questions                                             â”‚â”‚
â”‚  â”‚                                                                 â”‚â”‚
â”‚  â”‚ ### ä¸ºä»€ä¹ˆéœ€è¦ {ä»»åŠ¡å}ï¼Ÿ                                       â”‚â”‚
â”‚  â”‚ [Agent å›ç­”...]                                                 â”‚â”‚
â”‚  â”‚                                                                 â”‚â”‚
â”‚  â”‚ ### ä¸ºä»€ä¹ˆç°åœ¨åš {ä»»åŠ¡å}ï¼Ÿ                                     â”‚â”‚
â”‚  â”‚ [Agent å›ç­”...]                                                 â”‚â”‚
â”‚  â”‚ ...                                                             â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚         â”‚                                                            â”‚
â”‚         â–¼                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Step 4: æ²‰æ·€é‡è¦çŸ¥è¯†åˆ° project-why.md                           â”‚â”‚
â”‚  â”‚                                                                 â”‚â”‚
â”‚  â”‚ # æ£€æµ‹æ˜¯å¦å·²å­˜åœ¨ç›¸ä¼¼çŸ¥è¯†                                        â”‚â”‚
â”‚  â”‚ similar = why_engine.detect_similar_knowledge(new_knowledge)   â”‚â”‚
â”‚  â”‚                                                                 â”‚â”‚
â”‚  â”‚ if similar and similar[0]['similarity'] > 0.8:                 â”‚â”‚
â”‚  â”‚     # å¢å¼ºç°æœ‰æ¡ç›®                                              â”‚â”‚
â”‚  â”‚     why_engine.enhance_knowledge(                               â”‚â”‚
â”‚  â”‚         title=similar[0]['title'],                              â”‚â”‚
â”‚  â”‚         additional_info=new_knowledge                           â”‚â”‚
â”‚  â”‚     )                                                           â”‚â”‚
â”‚  â”‚ else:                                                           â”‚â”‚
â”‚  â”‚     # æ·»åŠ æ–°æ¡ç›®                                                â”‚â”‚
â”‚  â”‚     why_engine.add_knowledge(                                   â”‚â”‚
â”‚  â”‚         category="æ¶æ„å†³ç­–",                                     â”‚â”‚
â”‚  â”‚         title=f"{ä»»åŠ¡å} çš„æ ¸å¿ƒå†³ç­–",                            â”‚â”‚
â”‚  â”‚         content=new_knowledge                                    â”‚â”‚
â”‚  â”‚     )                                                           â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚         â”‚                                                            â”‚
â”‚         â–¼                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Step 5: è¿›å…¥ Research é˜¶æ®µ                                      â”‚â”‚
â”‚  â”‚                                                                 â”‚â”‚
â”‚  â”‚ ç»§ç»­è°ƒç ”ç›¸å…³ä»£ç ã€è¯†åˆ« Protected Interfaces ç­‰                   â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 çŸ¥è¯†åº“æ›´æ–°æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      çŸ¥è¯†åº“æ›´æ–°æµç¨‹                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  Agent å‡†å¤‡æ›´æ–° project-why.md                                       â”‚
â”‚         â”‚                                                            â”‚
â”‚         â–¼                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Step 1: ç›¸ä¼¼åº¦æ£€æµ‹                                              â”‚â”‚
â”‚  â”‚                                                                 â”‚â”‚
â”‚  â”‚ similar_items = detect_similar_knowledge(new_content, 0.7)     â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚         â”‚                                                            â”‚
â”‚         â”œâ”€â”€ æ— ç›¸ä¼¼æ¡ç›®                                               â”‚
â”‚         â”‚                                                            â”‚
â”‚         â–¼                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Step 2a: ç›´æ¥æ·»åŠ æ–°æ¡ç›®                                         â”‚â”‚
â”‚  â”‚                                                                 â”‚â”‚
â”‚  â”‚ add_knowledge(category, title, content)                         â”‚â”‚
â”‚  â”‚ âœ… å®Œæˆ                                                         â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                      â”‚
â”‚         â”œâ”€â”€ æœ‰ç›¸ä¼¼æ¡ç›®                                               â”‚
â”‚         â”‚                                                            â”‚
â”‚         â–¼                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Step 2b: æ ¹æ®ç›¸ä¼¼åº¦å†³å®šæ“ä½œ                                     â”‚â”‚
â”‚  â”‚                                                                 â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
â”‚  â”‚ â”‚ ç›¸ä¼¼åº¦ > 0.8                                                â”‚ â”‚â”‚
â”‚  â”‚ â”‚ â†’ å¢å¼ºç°æœ‰æ¡ç›®                                              â”‚ â”‚â”‚
â”‚  â”‚ â”‚ â†’ enhance_knowledge(title, additional_info)                 â”‚ â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
â”‚  â”‚                                                                 â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
â”‚  â”‚ â”‚ ç›¸ä¼¼åº¦ 0.6-0.8                                               â”‚ â”‚â”‚
â”‚  â”‚ â”‚ â†’ å»ºè®®åˆå¹¶                                                  â”‚ â”‚â”‚
â”‚  â”‚ â”‚ â†’ suggest_merge(item1, item2)                               â”‚ â”‚â”‚
â”‚  â”‚ â”‚ â†’ ç”¨æˆ·ç¡®è®¤åæ‰§è¡Œåˆå¹¶                                        â”‚ â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
â”‚  â”‚                                                                 â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
â”‚  â”‚ â”‚ ç›¸ä¼¼åº¦ < 0.6                                                 â”‚ â”‚â”‚
â”‚  â”‚ â”‚ â†’ åˆ›å»ºæ–°æ¡ç›®                                                â”‚ â”‚â”‚
â”‚  â”‚ â”‚ â†’ add_knowledge(category, title, content)                   â”‚ â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. ä½¿ç”¨ç¤ºä¾‹

### 6.1 å¯åŠ¨ Why-First æµç¨‹

```python
import sys
sys.path.insert(0, '.claude/hooks')
from lib.why_first_engine import WhyFirstEngine

# åˆå§‹åŒ–å¼•æ“
why_engine = WhyFirstEngine()

# ç”Ÿæˆ Why é—®é¢˜
questions = why_engine.generate_why_questions("user-login", "å®ç°ç”¨æˆ·ç™»å½•è®¤è¯åŠŸèƒ½")

print("Why Questions:")
for i, q in enumerate(questions, 1):
    print(f"  {i}. {q}")
```

**è¾“å‡º**:
```
Why Questions:
  1. ä¸ºä»€ä¹ˆéœ€è¦ user-loginï¼Ÿ
  2. ä¸ºä»€ä¹ˆç°åœ¨åš user-loginï¼Ÿ
  3. ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ç§æ–¹å¼å®ç° user-loginï¼Ÿ
  4. ä¸ºä»€ä¹ˆä¸ç”¨å…¶ä»–æ–¹æ¡ˆï¼Ÿ
  5. user-login çš„æ ¸å¿ƒä»·å€¼æ˜¯ä»€ä¹ˆï¼Ÿ
```

### 6.2 æ·»åŠ çŸ¥è¯†æ¡ç›®

```python
# æ·»åŠ æ¶æ„å†³ç­–
success = why_engine.add_knowledge(
    category="æ¶æ„å†³ç­–",
    title="ä¸ºä»€ä¹ˆé€‰æ‹© JWT è€Œé Session",
    content="""
**åŸå› **: éœ€è¦æ”¯æŒåˆ†å¸ƒå¼éƒ¨ç½²å’Œæ— çŠ¶æ€è®¤è¯

**å¤‡é€‰æ–¹æ¡ˆ**:
- Session: éœ€è¦å…±äº«å­˜å‚¨ï¼Œå¢åŠ å¤æ‚åº¦
- JWT: æ— çŠ¶æ€ï¼Œæ˜“äºæ‰©å±•

**å†³ç­–**: é€‰æ‹© JWT

**ç›¸å…³ä»£ç **: src/auth/jwt_service.py
"""
)

if success:
    print("âœ… çŸ¥è¯†å·²æ·»åŠ åˆ° project-why.md")
else:
    print("âŒ æ·»åŠ å¤±è´¥")
```

### 6.3 æ£€æµ‹ç›¸ä¼¼çŸ¥è¯†

```python
# å‡†å¤‡æ·»åŠ çš„æ–°çŸ¥è¯†
new_knowledge = "ç”¨æˆ·è®¤è¯åº”è¯¥ä½¿ç”¨ JWT Token è¿›è¡Œæ— çŠ¶æ€éªŒè¯..."

# æ£€æµ‹ç›¸ä¼¼æ¡ç›®
similar_items = why_engine.detect_similar_knowledge(new_knowledge, threshold=0.7)

if similar_items:
    print(f"ğŸ” å‘ç° {len(similar_items)} ä¸ªç›¸ä¼¼æ¡ç›®:\n")
    for item in similar_items:
        print(f"  - {item['title']} (ç›¸ä¼¼åº¦: {item['similarity']:.2%})")
        print(f"    {item['content'][:100]}...")
        print()

    # æ ¹æ®ç›¸ä¼¼åº¦å†³å®šæ“ä½œ
    top_similar = similar_items[0]
    if top_similar['similarity'] > 0.8:
        print("ğŸ’¡ å»ºè®®: å¢å¼ºç°æœ‰æ¡ç›®")
    elif top_similar['similarity'] > 0.6:
        print("ğŸ’¡ å»ºè®®: è€ƒè™‘åˆå¹¶")
    else:
        print("ğŸ’¡ å»ºè®®: åˆ›å»ºæ–°æ¡ç›®")
else:
    print("âœ… æœªå‘ç°ç›¸ä¼¼æ¡ç›®ï¼Œå¯ä»¥ç›´æ¥æ·»åŠ ")
```

### 6.4 å¢å¼ºç°æœ‰çŸ¥è¯†

```python
# å¢å¼ºç°æœ‰æ¡ç›®
success = why_engine.enhance_knowledge(
    title="ä¸ºä»€ä¹ˆé€‰æ‹© JWT è€Œé Session",
    additional_info="""
è¡¥å……ï¼šè€ƒè™‘åˆ°ç§»åŠ¨ç«¯ API è°ƒç”¨åœºæ™¯ï¼ŒJWT æ›´é€‚åˆæ— çŠ¶æ€æ¶æ„ã€‚
æ­¤å¤–ï¼ŒJWT æ”¯æŒè‡ªå®šä¹‰ Claimsï¼Œå¯ä»¥åœ¨ Token ä¸­æºå¸¦ç”¨æˆ·è§’è‰²ä¿¡æ¯ã€‚
"""
)

if success:
    print("âœ… çŸ¥è¯†å·²å¢å¼º")
else:
    print("âŒ æœªæ‰¾åˆ°è¯¥æ¡ç›®")
```

### 6.5 æœç´¢çŸ¥è¯†

```python
# æœç´¢è®¤è¯ç›¸å…³çŸ¥è¯†
results = why_engine.search_knowledge("è®¤è¯")

print("æœç´¢ç»“æœ:")
for item in results:
    print(f"  - {item['title']}")
    print(f"    {item['content'][:80]}...")
    print()
```

### 6.6 è·å–æœ€è¿‘çŸ¥è¯†

```python
# è·å–æœ€è¿‘ 5 æ¡çŸ¥è¯†
recent = why_engine.get_recent_knowledge(limit=5)

print("æœ€è¿‘çš„çŸ¥è¯†æ¡ç›®:")
for item in recent:
    print(f"  - {item['title']} ({item['timestamp']})")
    print(f"    {item['content'][:80]}...")
    print()
```

---

## 7. æ‰©å±•æŒ‡å—

### 7.1 æ·»åŠ æ–°çš„æ€è€ƒç»´åº¦

**åœºæ™¯**: æƒ³è¦æ·»åŠ "å®‰å…¨"ç»´åº¦çš„ Why é—®é¢˜

**æ­¥éª¤ 1**: ä¿®æ”¹ `generate_why_questions` æ–¹æ³•

```python
def generate_why_questions(self, task_name: str, description: str,
                           dimensions: Optional[List[str]] = None) -> List[str]:
    """
    ç”Ÿæˆ Why é—®é¢˜ï¼ˆæ”¯æŒè‡ªå®šä¹‰ç»´åº¦ï¼‰

    Args:
        task_name: ä»»åŠ¡åç§°
        description: ä»»åŠ¡æè¿°
        dimensions: æ€è€ƒç»´åº¦åˆ—è¡¨ï¼Œé»˜è®¤ä¸º ['core', 'timing', 'approach', 'value']
    """
    if dimensions is None:
        dimensions = ['core', 'timing', 'approach', 'value']

    dimension_questions = {
        'core': [
            f"ä¸ºä»€ä¹ˆéœ€è¦ {task_name}ï¼Ÿ",
            f"{task_name} çš„æ ¸å¿ƒä»·å€¼æ˜¯ä»€ä¹ˆï¼Ÿ"
        ],
        'timing': [
            f"ä¸ºä»€ä¹ˆç°åœ¨åš {task_name}ï¼Ÿ",
            f"ä¸åš {task_name} ä¼šæœ‰ä»€ä¹ˆåæœï¼Ÿ"
        ],
        'approach': [
            f"ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ç§æ–¹å¼å®ç° {task_name}ï¼Ÿ",
            f"ä¸ºä»€ä¹ˆä¸ç”¨å…¶ä»–æ–¹æ¡ˆï¼Ÿ"
        ],
        'security': [
            f"{task_name} æœ‰ä»€ä¹ˆå®‰å…¨é£é™©ï¼Ÿ",
            f"å¦‚ä½•ç¡®ä¿ {task_name} çš„å®‰å…¨æ€§ï¼Ÿ"
        ],
        'performance': [
            f"{task_name} å¯¹æ€§èƒ½æœ‰ä»€ä¹ˆå½±å“ï¼Ÿ",
            f"å¦‚ä½•ä¼˜åŒ– {task_name} çš„æ€§èƒ½ï¼Ÿ"
        ],
        'value': [
            f"{task_name} ç»™ç”¨æˆ·å¸¦æ¥ä»€ä¹ˆä»·å€¼ï¼Ÿ",
            f"å¦‚ä½•è¡¡é‡ {task_name} çš„æˆåŠŸï¼Ÿ"
        ]
    }

    questions = []
    for dim in dimensions:
        if dim in dimension_questions:
            questions.extend(dimension_questions[dim])

    return questions
```

**æ­¥éª¤ 2**: ä½¿ç”¨æ–°ç»´åº¦

```python
# æ·»åŠ å®‰å…¨ç»´åº¦
questions = why_engine.generate_why_questions(
    "user-login",
    "å®ç°ç”¨æˆ·ç™»å½•è®¤è¯åŠŸèƒ½",
    dimensions=['core', 'security', 'performance']
)
```

### 7.2 æ·»åŠ æ–°çš„çŸ¥è¯†åˆ†ç±»

**åœºæ™¯**: æƒ³è¦æ·»åŠ "æ€§èƒ½ä¼˜åŒ–"åˆ†ç±»

**æ­¥éª¤ 1**: ä¿®æ”¹ `category_map`

```python
# åœ¨ add_knowledge æ–¹æ³•ä¸­
category_map = {
    'æ ¸å¿ƒç†å¿µ': '## æ ¸å¿ƒç†å¿µ',
    'æ¶æ„å†³ç­–': '## æ¶æ„å†³ç­–',
    'ç»éªŒæ•™è®­': '## ç»éªŒæ•™è®­',
    'å¸¸è§é—®é¢˜': '## å¸¸è§é—®é¢˜',
    'æ€§èƒ½ä¼˜åŒ–': '## æ€§èƒ½ä¼˜åŒ–',  # æ–°å¢
    'å®‰å…¨å®è·µ': '## å®‰å…¨å®è·µ'   # æ–°å¢
}
```

**æ­¥éª¤ 2**: æ›´æ–° project-why.md æ¨¡æ¿

```markdown
## æ€§èƒ½ä¼˜åŒ–

### ä¸ºä»€ä¹ˆä½¿ç”¨ Redis ç¼“å­˜ï¼Ÿ

**æ—¶é—´**: 2026-02-26

**åŸå› **: å‡å°‘æ•°æ®åº“æŸ¥è¯¢å‹åŠ›ï¼Œæå‡å“åº”é€Ÿåº¦

**æ•ˆæœ**: æ¥å£å“åº”æ—¶é—´ä» 200ms é™è‡³ 20ms

## å®‰å…¨å®è·µ

### ä¸ºä»€ä¹ˆå¯¹æ‰€æœ‰ç”¨æˆ·è¾“å…¥è¿›è¡Œè½¬ä¹‰ï¼Ÿ

**æ—¶é—´**: 2026-02-26

**åŸå› **: é˜²æ­¢ XSS æ”»å‡»

**ç›¸å…³ä»£ç **: src/utils/sanitize.py
```

### 7.3 å®ç°æ™ºèƒ½é—®é¢˜ç”Ÿæˆ

**åœºæ™¯**: åŸºäºä»£ç æ‰«æç”Ÿæˆé’ˆå¯¹æ€§é—®é¢˜

```python
def generate_contextual_questions(self, task_name: str, affected_files: List[str]) -> List[str]:
    """
    åŸºäºå—å½±å“æ–‡ä»¶ç”Ÿæˆé’ˆå¯¹æ€§é—®é¢˜

    Args:
        task_name: ä»»åŠ¡åç§°
        affected_files: å—å½±å“çš„æ–‡ä»¶åˆ—è¡¨

    Returns:
        é’ˆå¯¹æ€§ Why é—®é¢˜åˆ—è¡¨
    """
    questions = []

    for file_path in affected_files:
        # è¯»å–æ–‡ä»¶
        try:
            with open(file_path, 'r', encoding='utf-8') as f:
                content = f.read()
        except:
            continue

        # æ£€æµ‹å…³é”®æ¨¡å¼
        if 'TODO' in content:
            questions.append(f"æ–‡ä»¶ {file_path} ä¸­æœ‰ TODOï¼Œæ˜¯å¦éœ€è¦åœ¨æ­¤ä»»åŠ¡ä¸­å¤„ç†ï¼Ÿ")

        if 'deprecated' in content.lower():
            questions.append(f"æ–‡ä»¶ {file_path} ä¸­æœ‰ deprecated æ ‡è®°ï¼Œå¦‚ä½•å¤„ç†ï¼Ÿ")

        if 'import' in content and 'auth' in content.lower():
            questions.append(f"{task_name} æ˜¯å¦ä¼šå½±å“ç°æœ‰çš„è®¤è¯é€»è¾‘ï¼Ÿ")

        # ä» project-why.md åŠ è½½ç›¸å…³å†å²
        related = self.search_knowledge(file_path)
        if related:
            questions.append(
                f"å†å²å†³ç­– '{related[0]['title']}' ä¸æ­¤ä»»åŠ¡ç›¸å…³ï¼Œæ˜¯å¦éœ€è¦éµå¾ªï¼Ÿ"
            )

    return questions[:5]  # æœ€å¤š 5 ä¸ªé’ˆå¯¹æ€§é—®é¢˜
```

### 7.4 é›†æˆ AI æ¨¡å‹å¢å¼º

**åœºæ™¯**: ä½¿ç”¨ AI æ¨¡å‹ç”Ÿæˆæ›´æ™ºèƒ½çš„é—®é¢˜

```python
def generate_ai_questions(self, task_name: str, description: str,
                          code_context: str) -> List[str]:
    """
    ä½¿ç”¨ AI æ¨¡å‹ç”Ÿæˆæ™ºèƒ½ Why é—®é¢˜

    Args:
        task_name: ä»»åŠ¡åç§°
        description: ä»»åŠ¡æè¿°
        code_context: ç›¸å…³ä»£ç ä¸Šä¸‹æ–‡

    Returns:
        AI ç”Ÿæˆçš„ Why é—®é¢˜åˆ—è¡¨
    """
    # æ„å»º prompt
    prompt = f"""
ä»»åŠ¡: {task_name}
æè¿°: {description}

ç›¸å…³ä»£ç ä¸Šä¸‹æ–‡:
```
{code_context[:2000]}
```

è¯·ç”Ÿæˆ 5-8 ä¸ªæ·±åº¦æ€è€ƒé—®é¢˜ï¼Œå¸®åŠ©å¼€å‘è€…ç†è§£è¿™ä¸ªä»»åŠ¡çš„æœ¬è´¨ã€‚
é—®é¢˜åº”è¯¥æ¶µç›–:
1. æ ¸å¿ƒåŠ¨æœº
2. æŠ€æœ¯é€‰æ‹©
3. æ½œåœ¨é£é™©
4. ä¾èµ–å…³ç³»
5. å¯æ‰©å±•æ€§

æ ¼å¼è¦æ±‚:
- æ¯è¡Œä¸€ä¸ªé—®é¢˜
- é—®é¢˜ä»¥"ä¸ºä»€ä¹ˆ"æˆ–"å¦‚ä½•"å¼€å¤´
- é¿å…è¿‡äºå®½æ³›çš„é—®é¢˜
"""

    # è°ƒç”¨ AI æ¨¡å‹ï¼ˆä¼ªä»£ç ï¼‰
    # response = call_ai_model(prompt)
    # questions = parse_questions(response)

    # è¿™é‡Œè¿”å›æ¨¡æ‹Ÿç»“æœ
    return [
        f"ä¸ºä»€ä¹ˆ {task_name} éœ€è¦ä¿®æ”¹è¿™äº›ç‰¹å®šæ–‡ä»¶ï¼Ÿ",
        f"{task_name} å¯¹ç°æœ‰ç³»ç»Ÿæœ‰ä»€ä¹ˆæ½œåœ¨å½±å“ï¼Ÿ",
        f"å¦‚ä½•ç¡®ä¿ {task_name} ä¸ä¼šç ´åç°æœ‰åŠŸèƒ½ï¼Ÿ",
        f"{task_name} æ˜¯å¦éœ€è¦è€ƒè™‘å‘åå…¼å®¹ï¼Ÿ",
        f"{task_name} çš„æµ‹è¯•ç­–ç•¥æ˜¯ä»€ä¹ˆï¼Ÿ"
    ]
```

---

## 8. ä¸å…¶ä»–æ¨¡å—çš„åä½œ

### 8.1 ä¸ Phase Gates çš„åä½œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Why-First ä¸ Phase Gates åä½œ                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  /nomos:start                                                        â”‚
â”‚         â”‚                                                            â”‚
â”‚         â–¼                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Research é˜¶æ®µ                                                   â”‚â”‚
â”‚  â”‚                                                                 â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
â”‚  â”‚ â”‚ Why-First å­é˜¶æ®µ                                             â”‚ â”‚â”‚
â”‚  â”‚ â”‚ - generate_why_questions()                                  â”‚ â”‚â”‚
â”‚  â”‚ â”‚ - å›ç­” Why é—®é¢˜                                              â”‚ â”‚â”‚
â”‚  â”‚ â”‚ - add_knowledge() / enhance_knowledge()                     â”‚ â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
â”‚  â”‚                         â”‚                                       â”‚â”‚
â”‚  â”‚                         â–¼                                       â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
â”‚  â”‚ â”‚ ä»£ç è°ƒç ”å­é˜¶æ®µ                                               â”‚ â”‚â”‚
â”‚  â”‚ â”‚ - æ‰«æç›¸å…³ä»£ç                                                â”‚ â”‚â”‚
â”‚  â”‚ â”‚ - è¯†åˆ« Protected Interfaces                                  â”‚ â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚         â”‚                                                            â”‚
â”‚         â–¼                                                            â”‚
â”‚  PhaseManager.complete_phase("research", approved_by="human")       â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 ä¸ Revert Manager çš„åä½œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Why-First ä¸ Revert Manager åä½œ                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  Revert è§¦å‘                                                        â”‚
â”‚         â”‚                                                            â”‚
â”‚         â–¼                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Revert Manager æ‰§è¡Œ                                             â”‚â”‚
â”‚  â”‚ - git revert HEAD --no-edit                                     â”‚â”‚
â”‚  â”‚ - è®°å½•åˆ° code_review.md                                         â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚         â”‚                                                            â”‚
â”‚         â–¼                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Why-First è®°å½•æ•™è®­                                              â”‚â”‚
â”‚  â”‚                                                                 â”‚â”‚
â”‚  â”‚ why_engine.add_knowledge(                                       â”‚â”‚
â”‚  â”‚     category="ç»éªŒæ•™è®­",                                         â”‚â”‚
â”‚  â”‚     title=f"å¤±è´¥æ•™è®­: {revert_reason}",                         â”‚â”‚
â”‚  â”‚     content=lesson_content                                       â”‚â”‚
â”‚  â”‚ )                                                               â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚         â”‚                                                            â”‚
â”‚         â–¼                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ å›åˆ° Plan é˜¶æ®µ                                                  â”‚â”‚
â”‚  â”‚ - è¯»å– project-why.md ä¸­çš„æ•™è®­                                  â”‚â”‚
â”‚  â”‚ - é‡æ–°è®¾è®¡æ–¹æ¡ˆ                                                  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.3 ä¸ SessionStart Hook çš„åä½œ

**å½“å‰å®ç°** (`nomos-session-start.sh`):

```bash
# SessionStart Hook: æ˜¾ç¤ºå½“å‰ä»»åŠ¡æç¤º + æ³¨å…¥ N0mosAi è§„èŒƒ
# ...
echo "â•‘  æµç¨‹è§„èŒƒ: Why-First â†’ Research â†’ Plan â†’ Execute â†’ Review         â•‘"
# ...
```

**å»ºè®®å¢å¼º**: åœ¨ä¼šè¯å¯åŠ¨æ—¶åŠ è½½ç›¸å…³ Why çŸ¥è¯†

```bash
#!/bin/bash
# å¢å¼ºç‰ˆ SessionStart Hook

# ... ç°æœ‰ä»£ç  ...

# åŠ è½½ç›¸å…³ Why çŸ¥è¯†
if [ -f "$PROJECT_ROOT/project-why.md" ]; then
    if [ -f "$CURRENT_TASK_FILE" ]; then
        CURRENT_TASK=$(cat "$CURRENT_TASK_FILE")
        # æå–ä»»åŠ¡å…³é”®è¯
        TASK_NAME=$(basename "$CURRENT_TASK" | sed 's/t[0-9]*-[0-9-]*-//')

        # æ˜¾ç¤ºç›¸å…³ Why çŸ¥è¯†ï¼ˆç®€åŒ–ç‰ˆï¼‰
        echo ""
        echo "ğŸ“š ç›¸å…³çŸ¥è¯†:"
        grep -A 3 "### .*$TASK_NAME" "$PROJECT_ROOT/project-why.md" 2>/dev/null | head -10
    fi
fi
```

---

## 9. æ€»ç»“

### 9.1 æ ¸å¿ƒä»·å€¼

Why-First å¼•æ“æ˜¯ N0mosAi ç³»ç»Ÿçš„"æ·±åº¦æ€è€ƒ"æ¨¡å—ï¼Œé€šè¿‡ä»¥ä¸‹æ–¹å¼æå‡ AI ç¼–ç è´¨é‡ï¼š

1. **å¼ºåˆ¶æ·±åº¦æ€è€ƒ**: é€šè¿‡ Why é—®é¢˜è¿«ä½¿ AI åœ¨åŠ¨æ‰‹å‰æ€è€ƒ
2. **çŸ¥è¯†æ²‰æ·€**: æ¯æ¬¡ä»»åŠ¡çš„å†³ç­–å’Œæ•™è®­éƒ½æ²‰æ·€åˆ° project-why.md
3. **é¿å…é‡å¤é”™è¯¯**: å†å²æ•™è®­è‡ªåŠ¨åŠ è½½åˆ°ä¸Šä¸‹æ–‡
4. **æ™ºèƒ½ç»´æŠ¤**: ç›¸ä¼¼æ£€æµ‹å’ŒçŸ¥è¯†åˆå¹¶ä¿æŒçŸ¥è¯†åº“æ•´æ´

### 9.2 å½“å‰å®ç°å®Œæˆåº¦

| åŠŸèƒ½ | å®Œæˆåº¦ | è¯´æ˜ |
|------|--------|------|
| Why é—®é¢˜ç”Ÿæˆ | 80% | åŸºç¡€åŠŸèƒ½å®Œæˆï¼Œç¼ºå°‘é’ˆå¯¹æ€§ç”Ÿæˆ |
| çŸ¥è¯†åº“ç®¡ç† | 100% | å®Œæ•´å®ç°å¢åˆ æ”¹æŸ¥ |
| ç›¸ä¼¼åº¦æ£€æµ‹ | 100% | ä½¿ç”¨ SequenceMatcher |
| çŸ¥è¯†å¢å¼º | 100% | æ”¯æŒè¿½åŠ è¡¥å……ä¿¡æ¯ |
| çŸ¥è¯†åˆå¹¶ | 90% | å»ºè®®åŠŸèƒ½å®Œæˆï¼Œè‡ªåŠ¨åˆå¹¶å¾…å®ç° |
| Why ç­”æ¡ˆéªŒè¯ | 100% | å…³é”®è¯æ£€æµ‹å®Œæˆ |

### 9.3 åç»­ä¼˜åŒ–æ–¹å‘

1. **æ™ºèƒ½é—®é¢˜ç”Ÿæˆ**: é›†æˆä»£ç æ‰«æå’Œ AI æ¨¡å‹ç”Ÿæˆé’ˆå¯¹æ€§é—®é¢˜
2. **å†å²å…³è”**: è‡ªåŠ¨ä» project-why.md åŠ è½½ç›¸å…³çš„å†å²å†³ç­–
3. **çŸ¥è¯†å›¾è°±**: æ„å»ºçŸ¥è¯†æ¡ç›®ä¹‹é—´çš„å…³è”å…³ç³»
4. **å›¢é˜Ÿåä½œ**: æ”¯æŒå¤šäººå…±äº«å’Œå†²çªåˆå¹¶

---

## é™„å½•

### A. æ–‡ä»¶è·¯å¾„ç´¢å¼•

| æ–‡ä»¶ | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| WhyFirstEngine | `.claude/hooks/lib/why_first_engine.py` | æ ¸å¿ƒ Why-First å¼•æ“ |
| å¯åŠ¨æµç¨‹ | `.claude/skills/nomos/prompts/start.md` | ä»»åŠ¡å¯åŠ¨æµç¨‹ï¼ˆåŒ…å« Why-Firstï¼‰ |
| çŸ¥è¯†ç»´æŠ¤ | `.claude/skills/nomos/prompts/update-why.md` | project-why.md ç»´æŠ¤ prompt |
| çŸ¥è¯†åº“ | `project-why.md` | é¡¹ç›®çŸ¥è¯†åº“æ–‡ä»¶ |
| æ¶æ„æ–‡æ¡£ | `doc-arch/agent-nomos-flow/03_System_Architecture.md` | ç³»ç»Ÿæ¶æ„è®¾è®¡ |

### B. å…³é”®ä»£ç è¡Œå·ç´¢å¼•

| åŠŸèƒ½ | æ–‡ä»¶ | è¡Œå· |
|------|------|------|
| WhyFirstEngine ç±»å®šä¹‰ | `why_first_engine.py` | 14-25 |
| Why é—®é¢˜ç”Ÿæˆ | `why_first_engine.py` | 27-46 |
| æ·»åŠ çŸ¥è¯† | `why_first_engine.py` | 48-113 |
| æœç´¢çŸ¥è¯† | `why_first_engine.py` | 115-145 |
| è·å–æœ€è¿‘çŸ¥è¯† | `why_first_engine.py` | 147-184 |
| Why ç­”æ¡ˆéªŒè¯ | `why_first_engine.py` | 186-206 |
| ç›¸ä¼¼åº¦æ£€æµ‹ | `why_first_engine.py` | 208-246 |
| ç›¸ä¼¼åº¦è®¡ç®— | `why_first_engine.py` | 248-259 |
| åˆå¹¶å»ºè®® | `why_first_engine.py` | 261-276 |
| çŸ¥è¯†å¢å¼º | `why_first_engine.py` | 278-312 |

### C. API é€ŸæŸ¥

| æ–¹æ³• | å‚æ•° | è¿”å›å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `generate_why_questions(task_name, description)` | ä»»åŠ¡å, æè¿° | List[str] | ç”Ÿæˆ Why é—®é¢˜ |
| `add_knowledge(category, title, content)` | åˆ†ç±», æ ‡é¢˜, å†…å®¹ | bool | æ·»åŠ çŸ¥è¯†æ¡ç›® |
| `search_knowledge(keyword)` | å…³é”®è¯ | List[Dict] | æœç´¢çŸ¥è¯†åº“ |
| `get_recent_knowledge(limit)` | æ•°é‡é™åˆ¶ | List[Dict] | è·å–æœ€è¿‘æ¡ç›® |
| `detect_similar_knowledge(content, threshold)` | å†…å®¹, é˜ˆå€¼ | List[Dict] | æ£€æµ‹ç›¸ä¼¼æ¡ç›® |
| `enhance_knowledge(title, additional_info)` | æ ‡é¢˜, è¡¥å……ä¿¡æ¯ | bool | å¢å¼ºç°æœ‰æ¡ç›® |
| `suggest_merge(item1, item2)` | ä¸¤ä¸ªæ¡ç›® | Dict | å»ºè®®åˆå¹¶ |
| `validate_why_answers(research_content)` | research å†…å®¹ | Dict[str, bool] | éªŒè¯ Why ç­”æ¡ˆ |

---

*æœ¬æ–‡æ¡£ç”± Claude Opus 4.6 ç”Ÿæˆ*
*ç”Ÿæˆæ—¶é—´: 2026-02-27*
*æ¥æº: N0mosAi ç³»ç»Ÿæ¶æ„ä¸ä»£ç åˆ†æ*
