# System Architecture Document (ç³»ç»Ÿæ¶æ„æ–‡æ¡£)

**Document Version:** 1.0
**Last Updated:** 2026-02-24
**Status:** DRAFT

---

## 1. ç³»ç»Ÿæ•´ä½“æ¶æ„

### 1.1 æ¶æ„æ¦‚è§ˆ

Nomos ç³»ç»Ÿé‡‡ç”¨åˆ†å±‚æ¶æ„,é€šè¿‡ Claude Code Hooks æœºåˆ¶å®ç°åˆšæ€§è´¨é‡ç®¡æ§ã€‚ç³»ç»Ÿæ ¸å¿ƒç”±ä»¥ä¸‹å‡ ä¸ªå±‚æ¬¡ç»„æˆ:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç”¨æˆ·äº¤äº’å±‚                              â”‚
â”‚  (Claude Code CLI / Task Viewer HTML ç•Œé¢)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SKILL ç¼–æ’å±‚                            â”‚
â”‚  (/nomos ä¸» SKILL + å­ SKILL)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Hooks é—¨æ§å±‚                            â”‚
â”‚  (PreToolUse / PostToolUse / Stop / SessionStart)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      è§„åˆ™å¼•æ“å±‚                              â”‚
â”‚  (AgentLinterEngine + ä¸‰å±‚è§„åˆ™ä½“ç³»)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      çŠ¶æ€æŒä¹…åŒ–å±‚                            â”‚
â”‚  (Task æ–‡ä»¶å¤¹ + project-why.md + .claude/)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 æ ¸å¿ƒè®¾è®¡åŸåˆ™

1. **åˆšæ€§ä¼˜å…ˆ**: é€šè¿‡ Hooks ç‰©ç†é—¨æ§,ç¡®ä¿è§„åˆ™å¼ºåˆ¶æ‰§è¡Œ
2. **æ–‡æ¡£é©±åŠ¨**: æ‰€æœ‰çŠ¶æ€æŒä¹…åŒ–åœ¨ Markdown æ–‡ä»¶ä¸­,æ”¯æŒè·¨ä¼šè¯æ¢å¤
3. **ä»»åŠ¡éš”ç¦»**: æ¯ä¸ªä»»åŠ¡ç‹¬ç«‹æ–‡ä»¶å¤¹,é¿å…ä¸Šä¸‹æ–‡æ±¡æŸ“
4. **Why-First**: å¼ºåˆ¶æ·±åº¦æ€è€ƒ"ä¸ºä»€ä¹ˆ",é¿å…"æƒ³å½“ç„¶"
5. **æ ‡æ³¨å¾ªç¯**: åœ¨æ–‡æ¡£ä¸­ç›´æ¥æ‰¹æ³¨,å‰ç½® code review
6. **å¯æ’æ‹”æ‰©å±•**: BaseRule æ¥å£æ”¯æŒè‡ªå®šä¹‰è§„åˆ™
7. **äººæœºåˆ†å·¥**: äººç±»è´Ÿè´£"ä¸ºä»€ä¹ˆ",Agent è´Ÿè´£"æ€ä¹ˆåš"

---

## 2. Task Viewer HTML ç•Œé¢æ¶æ„

### 2.1 æ•´ä½“æ¶æ„

Task Viewer é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„,Python åç«¯æä¾› HTTP æœåŠ¡å’Œæ–‡ä»¶æ“ä½œ,HTML/CSS/JS å‰ç«¯æä¾›æ¸²æŸ“å’Œäº¤äº’ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æµè§ˆå™¨å‰ç«¯                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  HTML ç»“æ„å±‚                                        â”‚  â”‚
â”‚  â”‚  - å¯¼èˆªæ  (ä»»åŠ¡ä¿¡æ¯ã€å¿«æ·æ“ä½œ)                      â”‚  â”‚
â”‚  â”‚  - å†…å®¹åŒº (Markdown æ¸²æŸ“ã€Mermaid å›¾è¡¨)             â”‚  â”‚
â”‚  â”‚  - é™„ç€å¼æ ‡æ³¨æ ‡è®°ç‚¹ (é™„ç€åœ¨ç›¸å…³è¡Œæ—è¾¹)              â”‚  â”‚
â”‚  â”‚  - æ‚¬æµ®ç¼–è¾‘æ¡† (ç‚¹å‡»æ ‡è®°ç‚¹å¼¹å‡º)                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  CSS æ ·å¼å±‚                                         â”‚  â”‚
â”‚  â”‚  - å“åº”å¼å¸ƒå±€                                       â”‚  â”‚
â”‚  â”‚  - ä»£ç é«˜äº®ä¸»é¢˜                                     â”‚  â”‚
â”‚  â”‚  - æ ‡è®°ç‚¹æ ·å¼ (å°å›¾æ ‡ã€çŠ¶æ€é¢œè‰²)                    â”‚  â”‚
â”‚  â”‚  - æ‚¬æµ®ç¼–è¾‘æ¡†æ ·å¼ (å®šä½ã€é˜´å½±ã€åŠ¨ç”»)                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  JavaScript é€»è¾‘å±‚                                  â”‚  â”‚
â”‚  â”‚  - Markdown æ¸²æŸ“ (marked.js)                       â”‚  â”‚
â”‚  â”‚  - Mermaid æ¸²æŸ“ (mermaid.js)                       â”‚  â”‚
â”‚  â”‚  - æ ‡æ³¨æ³¨å…¥ (æ ¹æ®è¡Œå·æ³¨å…¥æ ‡è®°ç‚¹)                    â”‚  â”‚
â”‚  â”‚  - æ‚¬æµ®ç¼–è¾‘æ¡†äº¤äº’ (æ˜¾ç¤º/éšè—/ä¿å­˜/åˆ é™¤)             â”‚  â”‚
â”‚  â”‚  - WebSocket é€šä¿¡ (å®æ—¶åŒæ­¥)                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†• HTTP/WebSocket
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Python åç«¯æœåŠ¡å™¨                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  HTTP æœåŠ¡å±‚                                        â”‚  â”‚
â”‚  â”‚  - é™æ€æ–‡ä»¶æœåŠ¡ (.task-viewer.html)                â”‚  â”‚
â”‚  â”‚  - API ç«¯ç‚¹ (è¯»å–/ä¿å­˜ plan.md)                    â”‚  â”‚
â”‚  â”‚  - WebSocket æœåŠ¡ (æµè§ˆå™¨å…³é—­é€šçŸ¥)                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ç«¯å£ç®¡ç†å±‚                                         â”‚  â”‚
â”‚  â”‚  - åŠ¨æ€ç«¯å£åˆ†é… (ä» 8765 å¼€å§‹)                     â”‚  â”‚
â”‚  â”‚  - ç«¯å£å†²çªæ£€æµ‹                                     â”‚  â”‚
â”‚  â”‚  - å¤šå®ä¾‹ç®¡ç†                                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  è‡ªåŠ¨å…³é—­å±‚                                         â”‚  â”‚
â”‚  â”‚  - è¶…æ—¶æ£€æµ‹ (30 åˆ†é’Ÿæ— æ´»åŠ¨)                        â”‚  â”‚
â”‚  â”‚  - æµè§ˆå™¨å…³é—­ç›‘å¬                                   â”‚  â”‚
â”‚  â”‚  - ä¼˜é›…å…³é—­ (ä¿å­˜çŠ¶æ€)                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†• æ–‡ä»¶ç³»ç»Ÿ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä»»åŠ¡æ–‡ä»¶ç³»ç»Ÿ                           â”‚
â”‚  tasks/t1-YYYY-MM-DD-feature/                            â”‚
â”‚  â”œâ”€â”€ .task-viewer.html (ç•Œé¢æ–‡ä»¶)                        â”‚
â”‚  â”œâ”€â”€ plan.md (è®¡åˆ’æ–‡æ¡£)                                  â”‚
â”‚  â”œâ”€â”€ research.md (è°ƒç ”æ–‡æ¡£)                              â”‚
â”‚  â””â”€â”€ code_review.md (å®¡æŸ¥æ–‡æ¡£)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 å‰ç«¯æŠ€æœ¯æ ˆ

**æ ¸å¿ƒæŠ€æœ¯**:
- **HTML5**: è¯­ä¹‰åŒ–æ ‡ç­¾,æ”¯æŒ ARIA æ— éšœç¢
- **CSS3**: Flexbox/Grid å¸ƒå±€,CSS Variables ä¸»é¢˜
- **Pure JavaScript**: æ— æ¡†æ¶ä¾èµ–,è½»é‡é«˜æ•ˆ

**ç¬¬ä¸‰æ–¹åº“ (CDN å¼•å…¥)**:
- **marked.js** (v11.0+): Markdown è§£æå’Œæ¸²æŸ“
  - CDN: `https://cdn.jsdelivr.net/npm/marked@11/marked.min.js`
  - åŠŸèƒ½: å°† Markdown è½¬æ¢ä¸º HTML
  - é…ç½®: å¯ç”¨ GFM(GitHub Flavored Markdown)ã€ä»£ç é«˜äº®

- **mermaid.js** (v10.0+): å›¾è¡¨æ¸²æŸ“
  - CDN: `https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js`
  - åŠŸèƒ½: æ¸²æŸ“æµç¨‹å›¾ã€æ—¶åºå›¾ã€æ¶æ„å›¾
  - é…ç½®: ä¸»é¢˜ã€å­—ä½“å¤§å°ã€å®‰å…¨æ¨¡å¼

### 2.3 åç«¯æŠ€æœ¯æ ˆ

**æ ¸å¿ƒæŠ€æœ¯**:
- **Python 3.9+**: åç«¯æœåŠ¡å™¨è¯­è¨€
- **http.server**: å†…ç½® HTTP æœåŠ¡å™¨æ¨¡å—
- **WebSocket**: æµè§ˆå™¨å…³é—­é€šçŸ¥

**å…³é”®æ¨¡å—**:
- **ç«¯å£ç®¡ç†**: åŠ¨æ€åˆ†é…ç«¯å£(8765 èµ·å§‹)
- **è‡ªåŠ¨å…³é—­**: 30 åˆ†é’Ÿè¶…æ—¶ + æµè§ˆå™¨å…³é—­ç›‘å¬
- **æ–‡ä»¶æ“ä½œ**: è¯»å–/ä¿å­˜ plan.mdã€research.md ç­‰

### 2.4 Short ID æ˜ å°„ç³»ç»Ÿ

**è®¾è®¡ç›®æ ‡**: è®©ç”¨æˆ·å¯ä»¥é€šè¿‡ç®€çŸ­ ID(t1, t2, t3...)å¿«é€Ÿå¼•ç”¨ä»»åŠ¡,åŒæ—¶åœ¨ç›®å½•åä¸­å¯è§ã€‚

**å®ç°æ–¹æ¡ˆ**:
```
tasks/
â”œâ”€â”€ t1-2026-02-23-login-feature/
â”œâ”€â”€ t2-2026-02-24-payment-refactor/
â””â”€â”€ t3-2026-02-24-api-optimization/
```

**æ˜ å°„æ–‡ä»¶**: `tasks/short-id-mapping.json`
```json
{
  "t1": "t1-2026-02-23-login-feature",
  "t2": "t2-2026-02-24-payment-refactor",
  "t3": "t3-2026-02-24-api-optimization"
}
```

### 2.5 é™„ç€å¼æ ‡æ³¨ç³»ç»Ÿ

**è®¾è®¡ç†å¿µ**: æ ‡æ³¨ä¸æ˜¯ç‹¬ç«‹åŒºåŸŸ,è€Œæ˜¯é™„ç€åœ¨ç›¸å…³å†…å®¹æ—è¾¹çš„æ ‡è®°ç‚¹,æ”¯æŒå³é”®åˆ›å»ºæ ‡æ³¨ã€å·¦é”®æŸ¥çœ‹å†å²,å®ç°æŒä¹…åŒ–çš„æ ‡æ³¨å¾ªç¯ã€‚

#### 2.5.1 äº¤äº’è®¾è®¡

**åŒå‡»äº¤äº’æ¨¡å¼**:

| æ“ä½œ | è¡Œä¸º | åœºæ™¯ |
|------|------|------|
| **å³é”®ç‚¹å‡»è¡Œ** | é«˜äº®è¯¥è¡Œ + æ‰“å¼€æ–°å»ºæ ‡æ³¨æ¡† | åˆ›å»ºæ–°æ ‡æ³¨ |
| **å·¦é”®ç‚¹å‡»æ ‡è®°ç‚¹** | æ‰“å¼€è¯¥æ ‡æ³¨çš„å†å²/è¿½é—®/çŠ¶æ€ | æŸ¥çœ‹å·²å­˜åœ¨æ ‡æ³¨ |
| **æ‚¬åœæ ‡è®°ç‚¹** | æ˜¾ç¤ºæ ‡æ³¨æ‘˜è¦é¢„è§ˆ | å¿«é€Ÿæµè§ˆ |

**è§†è§‰è®¾è®¡**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ## 4. Implementation Phases                                      â”‚
â”‚                                                                   â”‚
â”‚  ### Phase 1: ç”¨æˆ·è®¤è¯                                            â”‚
â”‚  ç›®æ ‡: å®ç°æ‰‹æœºå·+éªŒè¯ç ç™»å½•                         ğŸ“â“ â† æ ‡è®°ç‚¹ â”‚
â”‚                                                      â†‘            â”‚
â”‚                                              å·¦é”®ç‚¹å‡»æ‰“å¼€å†å²      â”‚
â”‚  #### Phase Gates (é˜¶æ®µé—¨æ§)                                      â”‚
â”‚  - [ ] Gate 1.1: æ•°æ®åº“è¡¨è®¾è®¡                      ğŸ“            â”‚
â”‚  - [ ] Gate 1.2: API æ¥å£å®ç°                                     â”‚
â”‚                                                                   â”‚
â”‚  å³é”®ç‚¹å‡»ä»»æ„è¡Œ â†’ é«˜äº®è¯¥è¡Œ + æ‰“å¼€æ–°å»ºæ ‡æ³¨æ¡†                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ ‡è®°ç‚¹çŠ¶æ€å›¾æ ‡:
ğŸ“  - æœ‰æ ‡æ³¨ï¼ˆå¾…å¤„ç†/å·²å¤„ç†ï¼‰
ğŸ“â“ - AIæœ‰è¿½é—®/ç–‘é—®ï¼ˆéœ€ç”¨æˆ·æ¾„æ¸…ï¼‰
ğŸ”´  - CRITICAL ä¸¥é‡ç¨‹åº¦
ğŸŸ   - MAJOR ä¸¥é‡ç¨‹åº¦
ğŸŸ¢  - å·²å¤„ç† (addressed)
```

**å·¦é”®ç‚¹å‡»æ ‡è®°ç‚¹ - æŸ¥çœ‹æ ‡æ³¨å†å²**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ### Phase 1: ç”¨æˆ·è®¤è¯                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  ç›®æ ‡: å®ç°æ‰‹æœºå·+éªŒè¯ç ç™»å½•        ğŸ“ â”€â”€â”€â”€â”¤ RC-1 å†å²è®°å½• [X]  â”‚ â”‚
â”‚                                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚                                          â”‚ ğŸ“‹ æ ‡æ³¨å†å²         â”‚ â”‚
â”‚                                          â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚                                          â”‚ â”‚ ğŸ‘¤ @developer   â”‚ â”‚ â”‚
â”‚                                          â”‚ â”‚ 02-24 10:30    â”‚ â”‚ â”‚
â”‚                                          â”‚ â”‚ [MAJOR]        â”‚ â”‚ â”‚
â”‚                                          â”‚ â”‚ éœ€è¦è¡¥å……å¾®ä¿¡ç™»å½•â”‚ â”‚ â”‚
â”‚                                          â”‚ â”‚ çš„è¾¹ç•Œæ¡ä»¶...  â”‚ â”‚ â”‚
â”‚                                          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚                                          â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚                                          â”‚ â”‚ ğŸ¤– @agent å›å¤  â”‚ â”‚ â”‚
â”‚                                          â”‚ â”‚ 02-24 10:45    â”‚ â”‚ â”‚
â”‚                                          â”‚ â”‚ å·²åœ¨ Phase     â”‚ â”‚ â”‚
â”‚                                          â”‚ â”‚ Gates è¡¥å……...  â”‚ â”‚ â”‚
â”‚                                          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚                                          â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚                                          â”‚ â”‚ â“ AI è¿½é—®      â”‚ â”‚ â”‚
â”‚                                          â”‚ â”‚ 02-24 10:46    â”‚ â”‚ â”‚
â”‚                                          â”‚ â”‚ è¯·ç¡®è®¤ï¼šå¾®ä¿¡   â”‚ â”‚ â”‚
â”‚                                          â”‚ â”‚ æœåŠ¡ä¸å¯ç”¨æ—¶   â”‚ â”‚ â”‚
â”‚                                          â”‚ â”‚ æ˜¯å¦éœ€è¦é™çº§ï¼Ÿ â”‚ â”‚ â”‚
â”‚                                          â”‚ â”‚ [å›å¤è¿½é—®]     â”‚ â”‚ â”‚
â”‚                                          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚                                          â”‚                    â”‚ â”‚
â”‚                                          â”‚ çŠ¶æ€: ğŸŸ  å¾…ç¡®è®¤    â”‚ â”‚
â”‚                                          â”‚ [è¿½åŠ æ ‡æ³¨] [å…³é—­]  â”‚ â”‚
â”‚                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å³é”®ç‚¹å‡»è¡Œ - æ–°å»ºæ ‡æ³¨**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ### Phase 1: ç”¨æˆ·è®¤è¯ â† â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• é«˜äº®é€‰ä¸­        â”‚
â”‚                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚                                          â”‚ æ–°å»ºæ ‡æ³¨      [X]   â”‚ â”‚
â”‚                                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚                                          â”‚ è¡Œå·: 45           â”‚ â”‚
â”‚                                          â”‚ ä¸¥é‡ç¨‹åº¦:          â”‚ â”‚
â”‚                                          â”‚ â—‹CRITICAL â—‹MAJOR   â”‚ â”‚
â”‚                                          â”‚ â—‹MINOR   â—‹SUGGEST  â”‚ â”‚
â”‚                                          â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚                                          â”‚ â”‚è¾“å…¥æ ‡æ³¨å†…å®¹... â”‚ â”‚ â”‚
â”‚                                          â”‚ â”‚                â”‚ â”‚ â”‚
â”‚                                          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚                                          â”‚                    â”‚ â”‚
â”‚                                          â”‚ [ä¿å­˜] [å–æ¶ˆ]      â”‚ â”‚
â”‚                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.5.2 æ ‡æ³¨æ•°æ®ç»“æ„

**Review Comments æ ¼å¼ï¼ˆæŒä¹…åŒ–å­˜å‚¨ï¼‰**:

```markdown
## 8. Review Comments

### RC-1: è¡¥å……å¾®ä¿¡ç™»å½•è¾¹ç•Œæ¡ä»¶
> ä½ç½®: 47
> åˆ›å»ºæ—¶é—´: 2026-02-24 10:30
> æœ€åæ›´æ–°: 2026-02-24 11:15
> ä¸¥é‡ç¨‹åº¦: [MAJOR]
> çŠ¶æ€: pending_ai_question  â† ç‰¹æ®ŠçŠ¶æ€ï¼šAIæœ‰è¿½é—®

#### æ ‡æ³¨å†å²

**[2026-02-24 10:30] ğŸ‘¤ @developer**
> éœ€è¦è¡¥å……å¾®ä¿¡ç™»å½•çš„è¾¹ç•Œæ¡ä»¶ï¼Œå¦‚ç”¨æˆ·å–æ¶ˆæˆæƒã€ç½‘ç»œè¶…æ—¶ç­‰åœºæ™¯

**[2026-02-24 10:45] ğŸ¤– @agent**
> å·²åœ¨ Phase Gates ä¸­è¡¥å…… Gate 1.4ï¼Œå¤„ç†ä»¥ä¸‹è¾¹ç•Œæ¡ä»¶ï¼š
> - ç”¨æˆ·å–æ¶ˆæˆæƒ â†’ è¿”å›é”™è¯¯ç  1001
> - ç½‘ç»œè¶…æ—¶ â†’ é‡è¯• 3 æ¬¡åè¿”å›é”™è¯¯ç  1002
> - æˆæƒè¿‡æœŸ â†’ å¼•å¯¼ç”¨æˆ·é‡æ–°æˆæƒ

**[2026-02-24 10:46] â“ @agent è¿½é—®**
> è¯·ç¡®è®¤ï¼šå¾®ä¿¡æœåŠ¡ä¸å¯ç”¨æ—¶æ˜¯å¦éœ€è¦é™çº§å¤„ç†ï¼Ÿå¦‚æœéœ€è¦ï¼Œé™çº§æ–¹æ¡ˆæ˜¯ä»€ä¹ˆï¼Ÿ

**[2026-02-24 11:15] ğŸ‘¤ @developer**
> æ˜¯çš„ï¼Œéœ€è¦é™çº§ã€‚é™çº§æ–¹æ¡ˆï¼šæ˜¾ç¤º"å¾®ä¿¡æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œè¯·ä½¿ç”¨æ‰‹æœºå·ç™»å½•"

---

### RC-2: æ•°æ®åº“è¡¨è®¾è®¡å»ºè®®
> ä½ç½®: 52
> åˆ›å»ºæ—¶é—´: 2026-02-24 10:35
> æœ€åæ›´æ–°: 2026-02-24 10:50
> ä¸¥é‡ç¨‹åº¦: [MINOR]
> çŠ¶æ€: addressed

#### æ ‡æ³¨å†å²

**[2026-02-24 10:35] ğŸ‘¤ @developer**
> å»ºè®®åœ¨ users è¡¨å¢åŠ  last_login_at å­—æ®µ

**[2026-02-24 10:50] ğŸ¤– @agent**
> å·²æ·»åŠ  last_login_at å­—æ®µåˆ° Gate 1.1 çš„è¡¨è®¾è®¡è¯´æ˜ä¸­
```

#### 2.5.3 æ ‡æ³¨çŠ¶æ€ä½“ç³»

| çŠ¶æ€ | å«ä¹‰ | æ ‡è®°ç‚¹å›¾æ ‡ | é˜»å¡ |
|------|------|-----------|------|
| `pending` | å¾…å¤„ç† | ğŸ“ğŸŸ  | âœ… é˜»å¡ï¼ˆCRITICAL/MAJORï¼‰ |
| `pending_ai_question` | AIæœ‰è¿½é—®ï¼Œå¾…ç”¨æˆ·å›å¤ | ğŸ“â“ | âœ… é˜»å¡ |
| `pending_user_clarify` | AIæœ‰ç–‘é—®ï¼Œå¾…ç”¨æˆ·æ¾„æ¸… | ğŸ“â“ | âœ… é˜»å¡ |
| `addressed` | å·²å¤„ç† | ğŸ“ğŸŸ¢ | âŒ ä¸é˜»å¡ |
| `wont_fix` | ä¸ä¿®å¤ï¼ˆäººç±»ç¡®è®¤å¿½ç•¥ï¼‰ | ğŸ“âšª | âŒ ä¸é˜»å¡ |

**çŠ¶æ€æµè½¬**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       æ ‡æ³¨çŠ¶æ€æµè½¬å›¾                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  [ç”¨æˆ·åˆ›å»ºæ ‡æ³¨]                                                       â”‚
â”‚       â”‚                                                              â”‚
â”‚       â–¼                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                         â”‚
â”‚  â”‚ pending â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                   â”‚                    â”‚
â”‚       â”‚                                        â”‚                    â”‚
â”‚       â”‚ Agent è¯»å–å¹¶å¤„ç†                        â”‚ Agent ä¸ç†è§£ï¼Œ    â”‚
â”‚       â”‚                                        â”‚ ä¸»åŠ¨æé—®          â”‚
â”‚       â–¼                                        â”‚                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚                    â”‚
â”‚  â”‚ Agent å›å¤/ä¿®æ”¹     â”‚                       â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚                    â”‚
â”‚             â”‚                                  â”‚                    â”‚
â”‚             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚                    â”‚
â”‚             â”‚                    â”‚             â”‚                    â”‚
â”‚             â–¼                    â–¼             â”‚                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                    â”‚
â”‚  â”‚ pending_         â”‚  â”‚ pending_user_     â”‚  â”‚                    â”‚
â”‚  â”‚ ai_question      â”‚  â”‚ clarify           â”‚  â”‚                    â”‚
â”‚  â”‚ (AIè¿½é—®ç”¨æˆ·)     â”‚  â”‚ (AIæœ‰ç–‘é—®)        â”‚  â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                    â”‚
â”‚           â”‚                      â”‚            â”‚                    â”‚
â”‚           â”‚ ç”¨æˆ·å›å¤              â”‚ ç”¨æˆ·æ¾„æ¸…   â”‚                    â”‚
â”‚           â”‚                      â”‚            â”‚                    â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                      â”‚                                              â”‚
â”‚                      â–¼                                              â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                      â”‚
â”‚              â”‚ ç”¨æˆ·ç¡®è®¤é€šè¿‡   â”‚                                      â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚
â”‚                      â”‚                                              â”‚
â”‚                      â–¼                                              â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                      â”‚
â”‚              â”‚  addressed    â”‚                                      â”‚
â”‚              â”‚  (å·²å¤„ç†)     â”‚                                      â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚
â”‚                                                                      â”‚
â”‚  ç‰¹æ®Šè·¯å¾„:                                                           â”‚
â”‚  pending â”€â”€[ç”¨æˆ·ç¡®è®¤å¿½ç•¥]â”€â”€â–º wont_fix                               â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.5.4 Markdown ç‰¹æ®Šæ ¼å¼æ ‡æ³¨

**é—®é¢˜**: Markdown ç‰¹æ®Šæ ¼å¼ï¼ˆä»£ç å—ã€Mermaidã€è¡¨æ ¼ç­‰ï¼‰æ¸²æŸ“åç»“æ„å˜åŒ–ï¼Œéš¾ä»¥ç”¨æ™®é€šè¡Œå·å®šä½ã€‚

| ç‰¹æ®Šæ ¼å¼ | æ¸²æŸ“å | æ ‡æ³¨éš¾ç‚¹ |
|---------|--------|---------|
| **ä»£ç å—** `<pre><code>` | è¯­æ³•é«˜äº®çš„ä»£ç  | è¡Œå·å¯¹åº”ä»£ç å—å†…éƒ¨ |
| **Mermaid** | æµç¨‹å›¾/æ¶æ„å›¾ | å›¾å½¢æ— æ³•å®šä½åˆ°æºç è¡Œ |
| **è¡¨æ ¼** | è¡¨æ ¼ | å•å…ƒæ ¼è·¨å¤šè¡Œ |
| **åˆ—è¡¨** | æœ‰åº/æ— åºåˆ—è¡¨ | åµŒå¥—ç»“æ„ |

**è§£å†³æ–¹æ¡ˆ: åŒè§†å›¾ + å—çº§æ ‡æ³¨æ··åˆ**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ··åˆæ ‡æ³¨æ–¹æ¡ˆ                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  1. é»˜è®¤æ¸²æŸ“è§†å›¾                                                     â”‚
â”‚     - æ™®é€šæ–‡æœ¬: è¡Œçº§æ ‡æ³¨ï¼ˆå³é”®ä»»æ„è¡Œï¼‰                               â”‚
â”‚     - ä»£ç å—: å—çº§æ ‡æ³¨ï¼ˆç‚¹å‡»ä»£ç å—å³ä¸Šè§’ ğŸ“ï¼‰                        â”‚
â”‚     - Mermaid: å—çº§æ ‡æ³¨ï¼ˆç‚¹å‡»å›¾è¡¨ä¸Šæ–¹ ğŸ“ï¼‰                           â”‚
â”‚     - è¡¨æ ¼: è¡Œçº§æ ‡æ³¨ï¼ˆè¡¨æ ¼æ¯è¡Œå¯æ ‡æ³¨ï¼‰                               â”‚
â”‚                                                                      â”‚
â”‚  2. æºç è§†å›¾åˆ‡æ¢                                                     â”‚
â”‚     - ç‚¹å‡» [æºç ] æŒ‰é’® â†’ æ˜¾ç¤ºåŸå§‹ Markdown                          â”‚
â”‚     - å¯ç²¾ç¡®æ ‡æ³¨ä»»æ„ä½ç½®                                             â”‚
â”‚     - æ ‡æ³¨è‡ªåŠ¨è½¬æ¢ä¸ºå¯¹åº”çš„æ¸²æŸ“è§†å›¾ä½ç½®                               â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è§†è§‰è®¾è®¡**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [æ¸²æŸ“] [æºç ]                              â† è§†å›¾åˆ‡æ¢æŒ‰é’®            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  ### Phase 1: ç”¨æˆ·è®¤è¯                                               â”‚
â”‚                                                                      â”‚
â”‚  ```python                                    ğŸ“ â† ä»£ç å—æ ‡æ³¨ç‚¹       â”‚
â”‚  def login(user):                                                    â”‚
â”‚      # éªŒè¯ç”¨æˆ·ä¿¡æ¯                                                  â”‚
â”‚      if not user:                  â† æºç è§†å›¾å¯æ ‡æ³¨æ­¤è¡Œ              â”‚
â”‚          return None                                                 â”‚
â”‚      return generate_token(user)                                     â”‚
â”‚  ```                                                                 â”‚
â”‚                                                                      â”‚
â”‚  ```mermaid                                   ğŸ“ â† Mermaid æ ‡æ³¨ç‚¹     â”‚
â”‚  graph LR                                                            â”‚
â”‚      A[ç”¨æˆ·è¯·æ±‚] --> B{éªŒè¯}                                         â”‚
â”‚      B -->|æˆåŠŸ| C[è¿”å›Token]                                        â”‚
â”‚      B -->|å¤±è´¥| D[è¿”å›é”™è¯¯]                                         â”‚
â”‚  ```                                                                 â”‚
â”‚                                                                      â”‚
â”‚  | å­—æ®µ | ç±»å‹ | è¯´æ˜ |                                              â”‚
â”‚  |------|------|------| â† ğŸ“ è¡¨æ ¼è¡Œæ ‡æ³¨ç‚¹                           â”‚
â”‚  | id | int | ä¸»é”® |                                                 â”‚
â”‚  | name | str | åç§° |                                               â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æºç è§†å›¾**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [æ¸²æŸ“] [æºç ] âœ“                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚   45 â”‚ ### Phase 1: ç”¨æˆ·è®¤è¯                                         â”‚
â”‚   46 â”‚                                                               â”‚
â”‚   47 â”‚ ```python                                                     â”‚
â”‚   48 â”‚ def login(user):                                              â”‚
â”‚   49 â”‚     # éªŒè¯ç”¨æˆ·ä¿¡æ¯                          ğŸ“ â† å³é”®æ ‡æ³¨æ­¤è¡Œ  â”‚
â”‚   50 â”‚     if not user:                                              â”‚
â”‚   51 â”‚         return None                                           â”‚
â”‚   52 â”‚     return generate_token(user)                               â”‚
â”‚   53 â”‚ ```                                                           â”‚
â”‚   54 â”‚                                                               â”‚
â”‚   55 â”‚ ```mermaid                                                    â”‚
â”‚   56 â”‚ graph LR                                    ğŸ“ â† å³é”®æ ‡æ³¨æ­¤å—  â”‚
â”‚   57 â”‚     A[ç”¨æˆ·è¯·æ±‚] --> B{éªŒè¯}                                   â”‚
â”‚   58 â”‚     B -->|æˆåŠŸ| C[è¿”å›Token]                                  â”‚
â”‚   59 â”‚     B -->|å¤±è´¥| D[è¿”å›é”™è¯¯]                                   â”‚
â”‚   60 â”‚ ```                                                           â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ‡æ³¨å®šä½æ•°æ®ç»“æ„**:

```javascript
// æ™®é€šæ–‡æœ¬ - è¡Œçº§å®šä½
{
  "id": "RC-1",
  "location": {
    "type": "line",
    "line": 47
  }
}

// ä»£ç å— - å—å†…è¡Œçº§å®šä½
{
  "id": "RC-2",
  "location": {
    "type": "code_block",
    "block_index": 1,        // ç¬¬å‡ ä¸ªä»£ç å—
    "inner_line": 3,         // ä»£ç å—å†…ç¬¬å‡ è¡Œ
    "source_line": 50        // æºç è¡Œå·ï¼ˆå…œåº•ï¼‰
  }
}

// Mermaid - å—çº§å®šä½
{
  "id": "RC-3",
  "location": {
    "type": "mermaid_block",
    "block_index": 1,
    "source_line_start": 55,
    "source_line_end": 60
  }
}

// è¡¨æ ¼ - è¡Œçº§å®šä½
{
  "id": "RC-4",
  "location": {
    "type": "table_row",
    "table_index": 1,
    "row": 2,
    "source_line": 65
  }
}
```

**æ ‡æ³¨æ ¼å¼ï¼ˆMD å­˜å‚¨ï¼‰**:

```markdown
### RC-1: ä»£ç å—æ ‡æ³¨ç¤ºä¾‹
> ä½ç½®: code:1:3 (æºç :50)      â† ä»£ç å— 1 ç¬¬ 3 è¡Œï¼Œæºç ç¬¬ 50 è¡Œå…œåº•
> åˆ›å»ºæ—¶é—´: 2026-02-25 10:30
> ä¸¥é‡ç¨‹åº¦: [MAJOR]
> çŠ¶æ€: pending
> å†…å®¹: è¿™é‡Œåº”è¯¥å¤„ç†ç©ºç”¨æˆ·åçš„æƒ…å†µï¼Œå¢åŠ å‚æ•°æ ¡éªŒ

### RC-2: Mermaid å›¾æ ‡æ³¨ç¤ºä¾‹
> ä½ç½®: mermaid:1 (æºç :55-60)  â† Mermaid å— 1ï¼Œæºç ç¬¬ 55-60 è¡Œ
> åˆ›å»ºæ—¶é—´: 2026-02-25 10:35
> ä¸¥é‡ç¨‹åº¦: [SUGGEST]
> çŠ¶æ€: pending
> å†…å®¹: å»ºè®®åœ¨ç™»å½•æµç¨‹ä¸­å¢åŠ éªŒè¯ç èŠ‚ç‚¹

### RC-3: è¡¨æ ¼è¡Œæ ‡æ³¨ç¤ºä¾‹
> ä½ç½®: table:1:row:2 (æºç :65) â† è¡¨æ ¼ 1 ç¬¬ 2 è¡Œ
> åˆ›å»ºæ—¶é—´: 2026-02-25 10:40
> ä¸¥é‡ç¨‹åº¦: [MINOR]
> çŠ¶æ€: pending
> å†…å®¹: name å­—æ®µåº”è¯¥å¢åŠ å”¯ä¸€çº¦æŸè¯´æ˜
```

**äº¤äº’è§„åˆ™**:

| åœºæ™¯ | æ¸²æŸ“è§†å›¾è¡Œä¸º | æºç è§†å›¾è¡Œä¸º |
|------|-------------|-------------|
| æ™®é€šæ–‡æœ¬ | å³é”®ä»»æ„è¡Œæ ‡æ³¨ | å³é”®ä»»æ„è¡Œæ ‡æ³¨ |
| ä»£ç å— | ç‚¹å‡»å³ä¸Šè§’ ğŸ“ æ ‡æ³¨æ•´ä¸ªå— | å¯æ ‡æ³¨ä»£ç å—å†…ä»»æ„è¡Œ |
| Mermaid | ç‚¹å‡»ä¸Šæ–¹ ğŸ“ æ ‡æ³¨æ•´ä¸ªå›¾ | å¯æ ‡æ³¨ Mermaid æºç ä»»æ„è¡Œ |
| è¡¨æ ¼ | å³é”®è¡¨æ ¼è¡Œæ ‡æ³¨ | å³é”®æºç è¡Œæ ‡æ³¨ |
| åˆ—è¡¨ | å³é”®åˆ—è¡¨é¡¹æ ‡æ³¨ | å³é”®æºç è¡Œæ ‡æ³¨ |

**è§†å›¾åˆ‡æ¢æ—¶æ ‡æ³¨ç‚¹å¤„ç†**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    è§†å›¾åˆ‡æ¢æ ‡æ³¨ç‚¹æ˜ å°„                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  æ¸²æŸ“è§†å›¾ â†’ æºç è§†å›¾:                                                â”‚
â”‚  - è¡Œçº§æ ‡æ³¨ â†’ æ˜ å°„åˆ°å¯¹åº”æºç è¡Œ                                       â”‚
â”‚  - å—çº§æ ‡æ³¨ â†’ å±•å¼€ä¸ºæºç è¡ŒèŒƒå›´ï¼Œæ ‡è®°ç‚¹æ˜¾ç¤ºåœ¨å—é¦–è¡Œ                   â”‚
â”‚                                                                      â”‚
â”‚  æºç è§†å›¾ â†’ æ¸²æŸ“è§†å›¾:                                                â”‚
â”‚  - æ™®é€šæ–‡æœ¬è¡Œ â†’ æ˜ å°„åˆ°æ¸²æŸ“åå¯¹åº”ä½ç½®                                 â”‚
â”‚  - ä»£ç å—å†…è¡Œ â†’ æ˜ å°„åˆ°ä»£ç å—æ ‡è®°ç‚¹ï¼ˆç‚¹å‡»å¯æŸ¥çœ‹å…·ä½“è¡Œï¼‰               â”‚
â”‚  - Mermaid å†…è¡Œ â†’ æ˜ å°„åˆ° Mermaid å—æ ‡è®°ç‚¹                            â”‚
â”‚                                                                      â”‚
â”‚  å®šä½å¤±è´¥å¤„ç†:                                                       â”‚
â”‚  - å¦‚æœè¡Œå·æ¼‚ç§»å¯¼è‡´å®šä½å¤±è´¥ â†’ ä½¿ç”¨ source_line å…œåº•                  â”‚
â”‚  - å¦‚æœä»å¤±è´¥ â†’ æ ‡è®°ç‚¹æ˜¾ç¤ºåœ¨æ–‡æ¡£æœ«å°¾ï¼Œæç¤º"ä½ç½®å·²å˜åŒ–"              â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.5.5 å†…å®¹åŠ¨æ€åˆ·æ–°

**è®¾è®¡ç›®æ ‡**: Agent ä¿®æ”¹æ–‡æ¡£åï¼ŒTask Viewer è‡ªåŠ¨åˆ·æ–°ï¼Œæ— éœ€é‡æ–°æ‰“å¼€ã€‚

**å®ç°æ–¹æ¡ˆ**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å†…å®¹åŠ¨æ€åˆ·æ–°æœºåˆ¶                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  æ–¹æ¡ˆ: è½®è¯¢ + WebSocket æ··åˆ                                         â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Task Viewer Frontend                                           â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ 1. WebSocket è¿æ¥ (å®æ—¶æ¨é€)                                    â”‚ â”‚
â”‚  â”‚    - è¿æ¥: ws://localhost:8765/ws                              â”‚ â”‚
â”‚  â”‚    - æ¥æ”¶: { "type": "file_changed", "file": "plan.md" }       â”‚ â”‚
â”‚  â”‚    - è§¦å‘: è‡ªåŠ¨åˆ·æ–°å†…å®¹åŒº                                       â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ 2. è½®è¯¢å…œåº• (æ¯ 5 ç§’)                                           â”‚ â”‚
â”‚  â”‚    - GET /api/file/plan.md/mtime                               â”‚ â”‚
â”‚  â”‚    - æ¯”è¾ƒä¿®æ”¹æ—¶é—´ï¼Œå˜åŒ–åˆ™åˆ·æ–°                                   â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ 3. åˆ·æ–°ç­–ç•¥                                                     â”‚ â”‚
â”‚  â”‚    - ä¿ç•™å½“å‰æ‰“å¼€çš„æ ‡æ³¨æ¡†çŠ¶æ€                                   â”‚ â”‚
â”‚  â”‚    - åªæ›´æ–° Markdown å†…å®¹åŒº                                     â”‚ â”‚
â”‚  â”‚    - æ ‡è®°ç‚¹ä½ç½®è‡ªåŠ¨é‡æ–°è®¡ç®—                                     â”‚ â”‚
â”‚  â”‚    - æ˜¾ç¤º"å†…å®¹å·²æ›´æ–°"æç¤ºæ¡                                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â”‚  åˆ·æ–°æç¤º UI:                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ”” æ–‡æ¡£å·²ç”± Agent æ›´æ–°ï¼Œç‚¹å‡»æŸ¥çœ‹å˜æ›´ [æŸ¥çœ‹] [å¿½ç•¥]              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â”‚  Agent ç«¯é€šçŸ¥ (å¯é€‰):                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ # Agent ä¿®æ”¹æ–‡æ¡£åï¼Œé€šè¿‡ Hook é€šçŸ¥ Task Viewer                  â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ PostToolUse Hook:                                               â”‚ â”‚
â”‚  â”‚   if file in [research.md, plan.md, code_review.md]:           â”‚ â”‚
â”‚  â”‚       notify_task_viewer(file)  # å‘é€ WebSocket é€šçŸ¥          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.5.6 æ ‡è®°ç‚¹æ ·å¼

```css
/* æ ‡è®°ç‚¹åŸºç¡€æ ·å¼ */
.annotation-marker {
  display: inline-block;
  width: 18px;
  height: 18px;
  margin-left: 4px;
  cursor: pointer;
  vertical-align: middle;
  border-radius: 50%;
  transition: all 0.2s;
}

/* çŠ¶æ€æ ·å¼ */
.annotation-marker[data-status="pending"] {
  background: #f59e0b;  /* æ©™è‰² - å¾…å¤„ç† */
  color: white;
}

.annotation-marker[data-status="pending_ai_question"],
.annotation-marker[data-status="pending_user_clarify"] {
  background: #8b5cf6;  /* ç´«è‰² - AIè¿½é—®/ç–‘é—® */
  color: white;
  animation: pulse 2s infinite;  /* é—ªçƒåŠ¨ç”»ï¼Œå¸å¼•æ³¨æ„ */
}

.annotation-marker[data-status="addressed"] {
  background: #10b981;  /* ç»¿è‰² - å·²å¤„ç† */
  color: white;
}

.annotation-marker[data-status="wont_fix"] {
  background: #9ca3af;  /* ç°è‰² - ä¸ä¿®å¤ */
  color: white;
}

/* ä¸¥é‡ç¨‹åº¦è§’æ ‡ */
.annotation-marker[data-severity="critical"]::after {
  content: "ğŸ”´";
  position: absolute;
  top: -4px;
  right: -4px;
  font-size: 10px;
}

.annotation-marker[data-severity="major"]::after {
  content: "ğŸŸ ";
  position: absolute;
  top: -4px;
  right: -4px;
  font-size: 10px;
}

/* AIè¿½é—®é—ªçƒåŠ¨ç”» */
@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.6; }
}

/* é«˜äº®é€‰ä¸­è¡Œï¼ˆå³é”®ï¼‰ */
.line-highlight {
  background: linear-gradient(90deg, #fef3c7 0%, transparent 100%);
  border-left: 3px solid #f59e0b;
  padding-left: 8px;
  margin-left: -11px;
}

/* æ‚¬æµ®ç¼–è¾‘æ¡† */
.annotation-popup {
  position: fixed;
  width: 400px;
  max-height: 500px;
  overflow-y: auto;
  background: white;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.15);
  z-index: 1000;
}

/* å†å²è®°å½•æ—¶é—´çº¿æ ·å¼ */
.history-item {
  padding: 12px;
  border-left: 3px solid #e5e7eb;
  margin-left: 8px;
}

.history-item.user {
  border-left-color: #3b82f6;  /* è“è‰² - ç”¨æˆ· */
}

.history-item.agent {
  border-left-color: #10b981;  /* ç»¿è‰² - Agent */
}

.history-item.ai-question {
  border-left-color: #8b5cf6;  /* ç´«è‰² - AIè¿½é—® */
  background: #f5f3ff;
}
```

#### 2.5.7 å…³é”®è®¾è®¡å†³ç­–

| å†³ç­–ç‚¹ | é€‰æ‹© | ç†ç”± |
|--------|------|------|
| å³é”®åˆ›å»ºæ ‡æ³¨ | è¡Œçº§å³é”®èœå• | ç¬¦åˆç”¨æˆ·ä¹ æƒ¯ï¼Œç²¾ç¡®å®šä½ |
| å·¦é”®æŸ¥çœ‹å†å² | ç‚¹å‡»æ ‡è®°ç‚¹å±•å¼€ | åŒºåˆ†åˆ›å»ºå’ŒæŸ¥çœ‹ä¸¤ç§æ“ä½œ |
| æ ‡æ³¨å†å²æŒä¹…åŒ– | MD æ–‡ä»¶å†…å­˜å‚¨ | ç‰ˆæœ¬æ§åˆ¶å‹å¥½ï¼Œè·¨ä¼šè¯ä¿æŒ |
| AIè¿½é—®çŠ¶æ€ | ç‹¬ç«‹çŠ¶æ€ + é—ªçƒåŠ¨ç”» | å¸å¼•ç”¨æˆ·æ³¨æ„ï¼Œç¡®ä¿ä¸é—æ¼ |
| å†…å®¹åˆ·æ–° | WebSocket + è½®è¯¢æ··åˆ | å®æ—¶æ€§ + å¯é æ€§å…¼é¡¾ |
| åˆ·æ–°æ—¶ä¿ç•™çŠ¶æ€ | ä¿ç•™æ‰“å¼€çš„æ ‡æ³¨æ¡† | é¿å…ç”¨æˆ·æ“ä½œè¢«æ‰“æ–­ |

---

## 3. æ ¸å¿ƒç»„ä»¶è®¾è®¡

### 3.1 Why-First å¼•æ“

**ç›®çš„**: å¼ºåˆ¶ AI åœ¨è°ƒç ”é˜¶æ®µæ·±åº¦æ€è€ƒ"ä¸ºä»€ä¹ˆ",é¿å…"æƒ³å½“ç„¶"å’Œå¹»è§‰ã€‚

**èŒè´£**:
- è§£æå½“å‰éœ€æ±‚,æå–å…³é”®è¯
- æ‰«æå—å½±å“çš„ä»£ç /æ¨¡å—èŒƒå›´(targeted scan)
- ä» project-why.md åŠ è½½ç›¸å…³å†å² Why
- ç”Ÿæˆ 5-12 ä¸ªé’ˆå¯¹æ€§ Why é—®é¢˜
- ç­‰å¾…ç”¨æˆ·å›ç­”å¹¶æ ‡æ³¨ âœ… Addressed
- åŒæ­¥æ›´æ–° project-why.md

**æ¥å£**:
| æ¥å£ | ç±»å‹ | æè¿° |
|------|------|------|
| `/nomos:start` | SKILL Command | å¯åŠ¨ Why-First æµç¨‹ |
| `generate_why_questions()` | Internal API | ç”Ÿæˆ Why é—®é¢˜åˆ—è¡¨ |
| `update_project_why()` | Internal API | æ›´æ–° project-why.md |

**ä¾èµ–**:
- project-why.md(çŸ¥è¯†åº“)
- research.md(å½“å‰ä»»åŠ¡è°ƒç ”)
- Grep/Read å·¥å…·(ä»£ç æ‰«æ)

**å…³é”®ç®—æ³•**:
```python
def generate_why_questions(requirement, project_why_md):
    # 1. æå–éœ€æ±‚å…³é”®è¯
    keywords = extract_keywords(requirement)

    # 2. æ‰«æå—å½±å“èŒƒå›´(åªçœ‹ç›¸å…³æ¨¡å—)
    affected_modules = scan_affected_modules(keywords)

    # 3. ä» project-why.md åŠ è½½ç›¸å…³å†å²
    historical_why = load_relevant_why(project_why_md, affected_modules)

    # 4. ç”Ÿæˆ 5-12 ä¸ªé’ˆå¯¹æ€§é—®é¢˜
    questions = []
    for module in affected_modules:
        questions.extend(generate_module_questions(module, historical_why))

    return questions[:12]  # æœ€å¤š 12 ä¸ª
```

### 3.2 Hooks é—¨æ§ç³»ç»Ÿ

**ç›®çš„**: é€šè¿‡ç‰©ç†é—¨æ§ç¡®ä¿è§„åˆ™å¼ºåˆ¶æ‰§è¡Œ,AI æ— æ³•è·³æ­¥ã€‚

**èŒè´£**:
- æ‹¦æˆªæ‰€æœ‰å·¥å…·è°ƒç”¨(PreToolUse)
- æ£€æŸ¥ä»»åŠ¡å®ŒæˆçŠ¶æ€(Stop)
- ä¼šè¯å¯åŠ¨æ—¶åŠ è½½ä¸Šä¸‹æ–‡(SessionStart)
- ç”¨æˆ·è¾“å…¥æ—¶æ£€æµ‹ä»»åŠ¡æ¢å¤(UserPromptSubmit)

**Hooks ç±»å‹**:

| Hook ç±»å‹ | è§¦å‘æ—¶æœº | ä¸»è¦èŒè´£ |
|----------|---------|---------|
| **PreToolUse** | å·¥å…·è°ƒç”¨å‰ | è¿è¡Œ AgentLinterEngine(ä¸‰å±‚è§„åˆ™)ã€æ£€æŸ¥ i18nã€éªŒè¯ plan.md çŠ¶æ€ |
| **PostToolUse** | å·¥å…·è°ƒç”¨å | æ›´æ–° Mermaid å›¾è¡¨ã€è®°å½•æ“ä½œæ—¥å¿— |
| **Stop** | ä»»åŠ¡ç»“æŸå‰ | æ£€æŸ¥æ‰€æœ‰ Phase Gates å·²å‹¾é€‰ã€Review Comments å·² Addressed |
| **SessionStart** | ä¼šè¯å¯åŠ¨æ—¶ | åŠ è½½ project-why.mdã€æ³¨å…¥å½“å‰ task ä¸Šä¸‹æ–‡ |
| **UserPromptSubmit** | ç”¨æˆ·è¾“å…¥å | æ£€æµ‹ä»»åŠ¡æ¢å¤å‘½ä»¤ã€è§£æ short ID |

**é…ç½®ç¤ºä¾‹**:
```yaml
# .claude/hooks/config.yml
hooks:
  PreToolUse:
    - matcher: "Write|Edit"
      command: ".claude/hooks/nomos-pretooluse.sh"
    - type: prompt
      promptFile: ".claude/hooks/i18n-prompt.md"

  Stop:
    - command: ".claude/hooks/check-gates-addressed.sh"

  SessionStart:
    - command: ".claude/hooks/load-project-why.sh"
```

### 3.3 AgentLinterEngine(è§„åˆ™å¼•æ“)

**ç›®çš„**: ä¸‰å±‚è§„åˆ™ä½“ç³»,ä»è¯­æ³•åˆ°ä¸šåŠ¡å…¨è¦†ç›–ã€‚

**ä¸‰å±‚è§„åˆ™**:

**ç¬¬ä¸€å±‚: è¯­æ³•/ç±»å‹è§„åˆ™**(é™æ€åˆ†æ)
- ESLintã€Pylintã€TypeScript ç¼–è¯‘å™¨
- ä»£ç æ ¼å¼åŒ–(Prettierã€Black)
- å¯¼å…¥æ£€æŸ¥ã€æœªä½¿ç”¨å˜é‡

**ç¬¬äºŒå±‚: å®‰å…¨/æ¶æ„è§„åˆ™**(æ¡†æ¶çº§)
- SQL æ³¨å…¥æ£€æµ‹
- XSS é˜²æŠ¤æ£€æŸ¥
- Protected Interfaces ä¿æŠ¤
- å¾ªç¯ä¾èµ–æ£€æµ‹

**ç¬¬ä¸‰å±‚: ä¸šåŠ¡è§„åˆ™**(é¡¹ç›®ç‰¹å®š)
- i18n å¼ºåˆ¶ä½¿ç”¨ customT()
- trace_id å¿…é¡»ä¼ é€’
- ç‰¹å®šæ¨¡å—çš„å‘½åçº¦å®š
- plan.md ä¸­å®šä¹‰çš„åŠ¨æ€è§„åˆ™

**æ¥å£**:
```python
class BaseRule:
    def check(self, code, context) -> RuleResult:
        pass

class AgentLinterEngine:
    def run_all_rules(self, code, layer) -> List[RuleResult]:
        # æŒ‰å±‚çº§è¿è¡Œè§„åˆ™
        pass
```

### 3.4 Task çŠ¶æ€ç®¡ç†å™¨

**ç›®çš„**: ç®¡ç†ä»»åŠ¡ç”Ÿå‘½å‘¨æœŸå’ŒçŠ¶æ€æŒä¹…åŒ–ã€‚

**èŒè´£**:
- åˆ›å»º/åˆ‡æ¢ä»»åŠ¡æ–‡ä»¶å¤¹
- ç»´æŠ¤ short ID æ˜ å°„
- ä¿å­˜/æ¢å¤ä»»åŠ¡ä¸Šä¸‹æ–‡
- ç®¡ç†ä»»åŠ¡å¿«ç…§(å¹¶è¡Œä»»åŠ¡åˆ‡æ¢)

**çŠ¶æ€æ–‡ä»¶**:
```
tasks/t1-2026-02-23-feature/
â”œâ”€â”€ research.md          # è°ƒç ”æ–‡æ¡£
â”œâ”€â”€ plan.md              # è®¡åˆ’æ–‡æ¡£
â”œâ”€â”€ code_review.md       # å®¡æŸ¥æ–‡æ¡£
â”œâ”€â”€ .task-viewer.html    # æŸ¥çœ‹å™¨ç•Œé¢
â”œâ”€â”€ snapshot.md          # ä¸Šä¸‹æ–‡å¿«ç…§(åˆ‡æ¢ä»»åŠ¡æ—¶)
â””â”€â”€ plan-diagram.mmd     # Mermaid æµç¨‹å›¾
```

### 3.5 Validator Subagent

**ç›®çš„**: åŒé‡éªŒè¯,ä¸“é—¨æŒ‘åˆºå’Œå‘ç°å¹»è§‰ã€‚

**èŒè´£**:
- åªè¯»æ¨¡å¼éªŒè¯ research.md å’Œ plan.md
- æ£€æŸ¥æ˜¯å¦ä¸ Protected Interfaces å†²çª
- å‘ç°æœªæåŠçš„ä¸šåŠ¡çº¦æŸ
- ç”Ÿæˆé¢å¤–é—®é¢˜åˆ—è¡¨

**è§¦å‘æ—¶æœº**:
- research.md ç”Ÿæˆåè‡ªåŠ¨ spawn
- plan.md ç”Ÿæˆåè‡ªåŠ¨ spawn
- äººç±»æ‰‹åŠ¨è§¦å‘ `/nomos:validate`

### 3.6 Git é›†æˆç®¡ç†å™¨

**ç›®çš„**: è‡ªåŠ¨åŒ– Git æ“ä½œ,é›¶æ‰‹åŠ¨å‘½ä»¤ã€‚

**èŒè´£**:
- è‡ªåŠ¨åˆ›å»º feature åˆ†æ”¯
- æ™ºèƒ½ commit æ¶ˆæ¯ç”Ÿæˆ
- PR æè¿°è‡ªåŠ¨ç”Ÿæˆ
- ä¸€é”®æäº¤ PR
- Commit ç²’åº¦ç®¡ç†

**å·¥ä½œæµç¨‹**:
```mermaid
sequenceDiagram
    participant User
    participant SKILL
    participant Git
    participant GitHub

    User->>SKILL: /nomos:start æ–°åŠŸèƒ½
    SKILL->>Git: git checkout -b feat/2026-02-23-feature
    SKILL->>Git: git push -u origin feat/...
    Note over SKILL: æ‰§è¡Œ Why-First + å¼€å‘æµç¨‹
    SKILL->>Git: git add . && git commit
    SKILL->>GitHub: gh pr create --title "..." --body "..."
    GitHub-->>User: PR åˆ›å»ºæˆåŠŸ
```

#### 3.6.1 Commit ç²’åº¦ç­–ç•¥

**è®¾è®¡èƒŒæ™¯**: ç”±äº Revert æœ‰å¤šä¸ªç²’åº¦ï¼ˆå• commit / å¤š commit / æ–‡ä»¶çº§ï¼‰ï¼Œcommit ç²’åº¦ç›´æ¥å½±å“ revert çš„ä»£ä»·ã€‚

**æ ¸å¿ƒåŸåˆ™**: ä»¥ Phase Gate ä¸º Commit è¾¹ç•Œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Commit ç²’åº¦ä¸ Revert ä»£ä»·                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  ç²—ç²’åº¦ Commit (æ•´ä¸ª Phase å®Œæˆå commit ä¸€æ¬¡):                  â”‚
â”‚  Phase 1 å®Œæˆ â”€â”€â–º commit â”€â”€â–º å‘ç°ä¸¥é‡é—®é¢˜ â”€â”€â–º revert            â”‚
â”‚  ç»“æœ: æ•´ä¸ª Phase 1 çš„å·¥ä½œå…¨éƒ¨ä¸¢å¤± âŒ ä»£ä»·é«˜                     â”‚
â”‚                                                                  â”‚
â”‚  ç»†ç²’åº¦ Commit (æ¯ä¸ª Gate å®Œæˆå commit):                        â”‚
â”‚  Gate 1.1 â”€â”€â–º commit                                             â”‚
â”‚  Gate 1.2 â”€â”€â–º commit                                             â”‚
â”‚  Gate 1.3 â”€â”€â–º commit â”€â”€â–º å‘ç°é—®é¢˜ â”€â”€â–º revert (åªå›æ»š 1.3)       â”‚
â”‚  ç»“æœ: åªä¸¢å¤± Gate 1.3ï¼Œ1.1 å’Œ 1.2 ä¿ç•™ âœ… ä»£ä»·ä½                â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ¨èç­–ç•¥**:

| Commit æ—¶æœº | å¯¹åº”å†…å®¹ | ç¤ºä¾‹ |
|-------------|----------|------|
| Gate å®Œæˆå | ä¸€ä¸ªé€»è¾‘å•å…ƒ | `feat: implement user model` |
| æµ‹è¯•ç¼–å†™å | æµ‹è¯•éª¨æ¶/ç”¨ä¾‹ | `test: add login tests` |
| é‡æ„å®Œæˆå | å•ä¸ªé‡æ„æ“ä½œ | `refactor: extract auth logic` |

**æ¯ä¸ª Commit åº”è¯¥**:
- æ˜¯ä¸€ä¸ªå¯ç¼–è¯‘/å¯è¿è¡Œçš„å•å…ƒï¼ˆä¸æäº¤åŠæˆå“ï¼‰
- æœ‰æ˜ç¡®çš„è¾¹ç•Œï¼ˆå¯¹åº” plan.md ä¸­çš„ä¸€ä¸ª Gateï¼‰
- èƒ½å¤Ÿç‹¬ç«‹å›æ»šï¼ˆä¸å½±å“å…¶ä»– commitï¼‰

#### 3.6.2 Commit Message è§„èŒƒ

**æ ¼å¼**: `<type>(<scope>): <description> [#gate]`

| ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `feat` | æ–°åŠŸèƒ½ | `feat(auth): add phone login #gate-1.1` |
| `fix` | Bug ä¿®å¤ | `fix(auth): handle empty phone number` |
| `test` | æµ‹è¯• | `test(auth): add login success cases #gate-1.3` |
| `refactor` | é‡æ„ | `refactor(auth): extract token validation` |
| `docs` | æ–‡æ¡£ | `docs(auth): update API description` |
| `chore` | æ‚é¡¹ | `chore: update dependencies` |

**ä¸ plan.md çš„å¯¹åº”å…³ç³»**:

```markdown
# plan.md
## Phase 1: ç”¨æˆ·è®¤è¯

### Phase Gates
- [ ] Gate 1.1: æ•°æ®åº“è¡¨è®¾è®¡
- [ ] Gate 1.2: API æ¥å£å®ç°
- [ ] Gate 1.3: æµ‹è¯•ç”¨ä¾‹ç¼–å†™

# Git Log
feat(db): add users table for phone login #gate-1.1
feat(api): implement POST /auth/login #gate-1.2
test(auth): add phone login test cases #gate-1.3
```

**å¥½å¤„**:
- commit å†å²ä¸ plan.md ä¸€ä¸€å¯¹åº”ï¼Œæ˜“äºè¿½æº¯
- code review æ—¶å¯ä»¥æŒ‰ gate ç²’åº¦æŸ¥çœ‹
- revert æ—¶èƒ½ç²¾ç¡®å®šä½åˆ°é—®é¢˜ gate

#### 3.6.3 Commit ç²’åº¦ Hook æ£€æŸ¥ï¼ˆå¯é€‰ï¼‰

**ç›®çš„**: åœ¨ Stop Hook ä¸­æ£€æŸ¥æ˜¯å¦æŒ‰ Gate ç²’åº¦ commitï¼Œæé†’ Agent éµå¾ªç­–ç•¥ã€‚

**æ£€æŸ¥é€»è¾‘**:

```python
# .claude/hooks/check_commit_granularity.py

import subprocess
import re

def check_commit_granularity(plan_md_path: str) -> dict:
    """
    æ£€æŸ¥ commit ç²’åº¦æ˜¯å¦ç¬¦åˆ Gate è¾¹ç•Œç­–ç•¥

    Returns:
        {
            "passed": bool,
            "warnings": list,
            "suggestions": list
        }
    """
    result = {"passed": True, "warnings": [], "suggestions": []}

    # 1. è·å–æœ¬æ¬¡ä»»åŠ¡åˆ†æ”¯çš„ commit æ•°é‡
    commits = subprocess.run(
        ["git", "rev-list", "--count", "HEAD", "^main"],
        capture_output=True, text=True
    )
    commit_count = int(commits.stdout.strip())

    # 2. è¯»å– plan.md ä¸­çš„ Gate æ•°é‡
    with open(plan_md_path, 'r') as f:
        plan_content = f.read()

    gate_count = len(re.findall(r'- \[ \] Gate \d+\.\d+:', plan_content))

    # 3. æ£€æŸ¥ commit æ•°é‡ä¸ Gate æ•°é‡çš„æ¯”ä¾‹
    if gate_count > 0:
        ratio = commit_count / gate_count

        if ratio < 0.5:
            result["warnings"].append(
                f"Commit ç²’åº¦è¿‡ç²—: {commit_count} ä¸ª commit å¯¹åº” {gate_count} ä¸ª Gateã€‚"
                f"å»ºè®®æ¯ä¸ª Gate å®Œæˆå commit ä¸€æ¬¡ï¼Œä»¥ä¾¿ç²¾ç¡® revertã€‚"
            )
            result["suggestions"].append(
                "è€ƒè™‘å°†å½“å‰å·¥ä½œæ‹†åˆ†ä¸ºå¤šä¸ª commitï¼Œæ¯ä¸ªå¯¹åº”ä¸€ä¸ª Gateã€‚"
            )

    # 4. æ£€æŸ¥ commit message æ˜¯å¦åŒ…å« gate æ ‡è®°
    recent_commits = subprocess.run(
        ["git", "log", "--oneline", "-5"],
        capture_output=True, text=True
    )

    for line in recent_commits.stdout.strip().split('\n'):
        if '#gate' not in line.lower():
            result["warnings"].append(
                f"Commit ç¼ºå°‘ gate æ ‡è®°: {line}"
            )

    return result

# Hook å…¥å£
if __name__ == "__main__":
    import sys
    import json

    data = json.loads(sys.stdin.read())
    plan_path = data.get("plan_path", "plan.md")

    check_result = check_commit_granularity(plan_path)

    if check_result["warnings"]:
        print("âš ï¸ Commit ç²’åº¦æ£€æŸ¥:", file=sys.stderr)
        for warning in check_result["warnings"]:
            print(f"  - {warning}", file=sys.stderr)
        print("\nå»ºè®®:", file=sys.stderr)
        for suggestion in check_result["suggestions"]:
            print(f"  - {suggestion}", file=sys.stderr)
        # ä¸é˜»å¡ï¼Œåªæ˜¯è­¦å‘Š
        sys.exit(0)
```

**é…ç½®æ–¹å¼** (åœ¨ .claude/settings.json ä¸­):

```json
{
  "hooks": {
    "Stop": [
      {
        "matcher": ".*",
        "hooks": ["check_commit_granularity"],
        "config": {
          "enforce": false,  // true = é˜»å¡, false = è­¦å‘Š
          "min_commit_per_gate": 0.5
        }
      }
    ]
  }
}
```

**æ£€æŸ¥æ—¶æœº**:
- Stop Hook: ä»»åŠ¡ç»“æŸå‰æ£€æŸ¥
- `/nomos:validate`: æ‰‹åŠ¨è§¦å‘æ£€æŸ¥

**å¤„ç†æ–¹å¼**:
- è­¦å‘Šæ¨¡å¼ï¼ˆé»˜è®¤ï¼‰: è¾“å‡ºè­¦å‘Šä¿¡æ¯ï¼Œä¸é˜»å¡
- å¼ºåˆ¶æ¨¡å¼ï¼ˆå¯é€‰ï¼‰: å¦‚æœç²’åº¦è¿‡ç²—ï¼Œé˜»å¡å¹¶è¦æ±‚æ‹†åˆ† commit

#### 3.6.4 åˆ†æ”¯ç®¡ç†ç­–ç•¥

**ç›®çš„**: æ–°ä»»åŠ¡è‡ªåŠ¨åˆ›å»ºç‹¬ç«‹åˆ†æ”¯ï¼Œæ”¯æŒå¤šä»»åŠ¡å¹¶è¡Œå¼€å‘ã€‚

**åˆ†æ”¯åˆ›å»ºæ—¶æœº**:

| è§¦å‘å‘½ä»¤ | æ—¶æœº | è¡Œä¸º |
|---------|------|------|
| `/nomos:start` | å¯åŠ¨å®Œæ•´æµç¨‹ | è‡ªåŠ¨åˆ›å»ºåˆ†æ”¯ + åˆ›å»º task æ–‡ä»¶å¤¹ |
| `/nomos:new-task` | ä»…åˆ›å»ºä»»åŠ¡ | è‡ªåŠ¨åˆ›å»ºåˆ†æ”¯ + åˆ›å»º task æ–‡ä»¶å¤¹ |

**åˆ†æ”¯å‘½åè§„èŒƒ**:

```
æ ¼å¼: {type}/{date}-{task-name}

ç¤ºä¾‹:
feat/2026-02-25-user-login        # æ–°åŠŸèƒ½
fix/2026-02-25-auth-bug           # Bug ä¿®å¤
refactor/2026-02-25-auth-module   # é‡æ„
test/2026-02-25-login-coverage    # æµ‹è¯•è¡¥å……
docs/2026-02-25-api-documentation # æ–‡æ¡£
```

**åˆ†æ”¯ç±»å‹**:

| ç±»å‹ | å‰ç¼€ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| **feat** | `feat/` | æ–°åŠŸèƒ½å¼€å‘ | æ–°å¢ç”¨æˆ·ç™»å½•åŠŸèƒ½ |
| **fix** | `fix/` | Bug ä¿®å¤ | ä¿®å¤ç™»å½•éªŒè¯é—®é¢˜ |
| **refactor** | `refactor/` | ä»£ç é‡æ„ | é‡æ„è®¤è¯æ¨¡å— |
| **test** | `test/` | æµ‹è¯•ç›¸å…³ | è¡¥å……æµ‹è¯•è¦†ç›–ç‡ |
| **docs** | `docs/` | æ–‡æ¡£æ›´æ–° | æ›´æ–° API æ–‡æ¡£ |

**åˆ†æ”¯åˆ›å»ºæµç¨‹**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      åˆ†æ”¯åˆ›å»ºæµç¨‹                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  Step 1: ç”¨æˆ·å¯åŠ¨ä»»åŠ¡                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ /nomos:start ç”¨æˆ·ç™»å½•åŠŸèƒ½                                  â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ ç³»ç»Ÿè§£æ:                                                       â”‚ â”‚
â”‚  â”‚ - ä»»åŠ¡ç±»å‹: feat (æ–°åŠŸèƒ½)                                       â”‚ â”‚
â”‚  â”‚ - ä»»åŠ¡åç§°: user-login                                          â”‚ â”‚
â”‚  â”‚ - æ—¥æœŸ: 2026-02-25                                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 2: ç”Ÿæˆåˆ†æ”¯åç§°                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ branch_name = "feat/2026-02-25-user-login"                      â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ æ£€æŸ¥:                                                           â”‚ â”‚
â”‚  â”‚ - åˆ†æ”¯æ˜¯å¦å·²å­˜åœ¨ï¼Ÿ â†’ å­˜åœ¨åˆ™è¿½åŠ åºå· (-1, -2)                    â”‚ â”‚
â”‚  â”‚ - å½“å‰æ˜¯å¦æœ‰æœªæäº¤çš„æ›´æ”¹ï¼Ÿ â†’ æç¤ºç”¨æˆ·å…ˆå¤„ç†                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 3: æ‰§è¡Œ Git å‘½ä»¤                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ git checkout main                      # ç¡®ä¿åœ¨ main åˆ†æ”¯       â”‚ â”‚
â”‚  â”‚ git pull origin main                   # æ‹‰å–æœ€æ–°ä»£ç            â”‚ â”‚
â”‚  â”‚ git checkout -b feat/2026-02-25-user-login                      â”‚ â”‚
â”‚  â”‚ git push -u origin feat/2026-02-25-user-login                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 4: åˆ›å»º Task æ–‡ä»¶å¤¹                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ mkdir -p tasks/t1-2026-02-25-user-login                         â”‚ â”‚
â”‚  â”‚ touch tasks/t1-2026-02-25-user-login/research.md                â”‚ â”‚
â”‚  â”‚ touch tasks/t1-2026-02-25-user-login/plan.md                    â”‚ â”‚
â”‚  â”‚ touch tasks/t1-2026-02-25-user-login/code_review.md             â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ echo "t1-2026-02-25-user-login" > .claude/current-task.txt      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¤šä»»åŠ¡åˆ†æ”¯åˆ‡æ¢**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å¤šä»»åŠ¡åˆ†æ”¯åˆ‡æ¢                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  å½“å‰çŠ¶æ€:                                                           â”‚
â”‚  â”œâ”€â”€ åˆ†æ”¯: feat/2026-02-25-user-login                               â”‚
â”‚  â”œâ”€â”€ ä»»åŠ¡: t1-2026-02-25-user-login                                 â”‚
â”‚  â””â”€â”€ çŠ¶æ€: Plan é˜¶æ®µ                                                â”‚
â”‚                                                                      â”‚
â”‚  ç”¨æˆ·æ‰§è¡Œ: /nomos:switch-task t2                               â”‚
â”‚                                                                      â”‚
â”‚  ç³»ç»Ÿæ“ä½œ:                                                           â”‚
â”‚  1. ä¿å­˜å½“å‰ä»»åŠ¡çŠ¶æ€åˆ° tasks/t1-xxx/snapshot.md                     â”‚
â”‚  2. git stashï¼ˆå¦‚æœ‰æœªæäº¤æ›´æ”¹ï¼‰                                     â”‚
â”‚  3. git checkout feat/2026-02-24-payment-refactor                   â”‚
â”‚  4. æ›´æ–° .claude/current-task.txt                                   â”‚
â”‚  5. åŠ è½½ t2 ä»»åŠ¡ä¸Šä¸‹æ–‡                                              â”‚
â”‚                                                                      â”‚
â”‚  åˆ‡æ¢åçŠ¶æ€:                                                         â”‚
â”‚  â”œâ”€â”€ åˆ†æ”¯: feat/2026-02-24-payment-refactor                         â”‚
â”‚  â”œâ”€â”€ ä»»åŠ¡: t2-2026-02-24-payment-refactor                           â”‚
â”‚  â””â”€â”€ çŠ¶æ€: Execute é˜¶æ®µ                                             â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.6.5 Gate Commit è§„èŒƒ

**ç›®çš„**: æ¯ä¸ª Gate å®Œæˆåè‡ªåŠ¨ commitï¼Œç¡®ä¿ç²’åº¦åˆé€‚ã€æ¶ˆæ¯è§„èŒƒã€‚

**Commit è§¦å‘æ—¶æœº**:

| æ—¶æœº | è§¦å‘æ–¹å¼ | è¯´æ˜ |
|------|---------|------|
| **Gate å®Œæˆå** | è‡ªåŠ¨/æ‰‹åŠ¨ | Agent å®Œæˆä¸€ä¸ª Gate åè‡ªåŠ¨æˆ–æ‰‹åŠ¨ commit |
| **Phase å®Œæˆå** | è‡ªåŠ¨ | ä¸€ä¸ª Phase æ‰€æœ‰ Gate å®Œæˆåè‡ªåŠ¨ commit |
| **æµ‹è¯•é€šè¿‡å** | è‡ªåŠ¨ | æµ‹è¯•ç”¨ä¾‹ç¼–å†™å¹¶é€šè¿‡å commit |

**è‡ªåŠ¨ Commit æµç¨‹**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Gate è‡ªåŠ¨ Commit æµç¨‹                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  Step 1: Gate å®Œæˆæ£€æµ‹                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ PostToolUse Hook æ£€æµ‹:                                          â”‚ â”‚
â”‚  â”‚ - plan.md ä¸­æŸä¸ª Gate è¢«å‹¾é€‰ [x]                                â”‚ â”‚
â”‚  â”‚ - å¯¹åº”çš„ä»£ç /æµ‹è¯•å·²å†™å…¥                                         â”‚ â”‚
â”‚  â”‚ - Linter æ£€æŸ¥é€šè¿‡                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 2: ç”Ÿæˆ Commit Message                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ # æ ¹æ® Gate ä¿¡æ¯è‡ªåŠ¨ç”Ÿæˆ                                        â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ Gate: "Gate 1.2: API æ¥å£å®ç°"                                  â”‚ â”‚
â”‚  â”‚ Phase: "Phase 1: ç”¨æˆ·è®¤è¯"                                      â”‚ â”‚
â”‚  â”‚ å˜æ›´æ–‡ä»¶: src/auth/api.py, src/auth/api_test.py                â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ ç”Ÿæˆ:                                                           â”‚ â”‚
â”‚  â”‚ feat(auth): implement POST /auth/login API #gate-1.2           â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ Body (è‡ªåŠ¨ç”Ÿæˆ):                                                â”‚ â”‚
â”‚  â”‚ - å®ç° /auth/login æ¥å£                                         â”‚ â”‚
â”‚  â”‚ - æ”¯æŒæ‰‹æœºå·+éªŒè¯ç ç™»å½•                                         â”‚ â”‚
â”‚  â”‚ - æ·»åŠ æ¥å£æµ‹è¯•ç”¨ä¾‹                                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 3: æ‰§è¡Œ Commit                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ git add src/auth/api.py src/auth/api_test.py                   â”‚ â”‚
â”‚  â”‚ git commit -m "feat(auth): implement POST /auth/login API #gate-1.2
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ - å®ç° /auth/login æ¥å£                                         â”‚ â”‚
â”‚  â”‚ - æ”¯æŒæ‰‹æœºå·+éªŒè¯ç ç™»å½•                                         â”‚ â”‚
â”‚  â”‚ - æ·»åŠ æ¥å£æµ‹è¯•ç”¨ä¾‹"                                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 4: æ¨é€ï¼ˆå¯é€‰ï¼‰                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ git push origin feat/2026-02-25-user-login                      â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ é…ç½®: auto_push = true (é»˜è®¤) / false (æ‰‹åŠ¨æ¨é€)                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Commit Message ç”Ÿæˆè§„åˆ™**:

```python
def generate_commit_message(gate_info, changed_files):
    """
    æ ¹æ® Gate ä¿¡æ¯è‡ªåŠ¨ç”Ÿæˆ commit message

    Args:
        gate_info: {
            "gate_id": "1.2",
            "gate_name": "API æ¥å£å®ç°",
            "phase_name": "ç”¨æˆ·è®¤è¯",
            "phase_scope": "auth"
        }
        changed_files: ["src/auth/api.py", "src/auth/api_test.py"]

    Returns:
        commit_message: å®Œæ•´çš„ commit message
    """

    # 1. ç¡®å®šç±»å‹
    commit_type = determine_commit_type(gate_info, changed_files)
    # feat: æ–°åŠŸèƒ½å®ç°
    # test: æµ‹è¯•ç”¨ä¾‹
    # fix: Bug ä¿®å¤
    # refactor: é‡æ„

    # 2. ç”Ÿæˆæ ‡é¢˜
    # æ ¼å¼: <type>(<scope>): <description> #gate-X.Y
    title = f"{commit_type}({gate_info['phase_scope']}): {gate_info['gate_name'].lower()} #gate-{gate_info['gate_id']}"

    # 3. ç”Ÿæˆ Body
    body_lines = analyze_changes(changed_files)
    # åˆ†æå˜æ›´æ–‡ä»¶ï¼Œç”Ÿæˆå˜æ›´è¯´æ˜åˆ—è¡¨

    return f"{title}\n\n" + "\n".join(f"- {line}" for line in body_lines)
```

**Commit Message ç¤ºä¾‹**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Gate 1.1: æ•°æ®åº“è¡¨è®¾è®¡                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  feat(db): create users table for phone login #gate-1.1            â”‚
â”‚                                                                      â”‚
â”‚  - åˆ›å»º users è¡¨ï¼ŒåŒ…å« id, phone, created_at å­—æ®µ                   â”‚
â”‚  - æ·»åŠ  phone å­—æ®µå”¯ä¸€ç´¢å¼•                                          â”‚
â”‚  - åˆ›å»º Alembic è¿ç§»è„šæœ¬                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Gate 1.2: API æ¥å£å®ç°                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  feat(auth): implement POST /auth/login API #gate-1.2              â”‚
â”‚                                                                      â”‚
â”‚  - å®ç° /auth/login æ¥å£                                            â”‚
â”‚  - æ”¯æŒæ‰‹æœºå·+éªŒè¯ç ç™»å½•                                            â”‚
â”‚  - è¿”å› JWT token                                                   â”‚
â”‚  - æ·»åŠ è¯·æ±‚å‚æ•°æ ¡éªŒ                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Gate 1.3: æµ‹è¯•ç”¨ä¾‹ç¼–å†™                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  test(auth): add login api test cases #gate-1.3                    â”‚
â”‚                                                                      â”‚
â”‚  - æµ‹è¯•æ‰‹æœºå·ç™»å½•æˆåŠŸåœºæ™¯                                           â”‚
â”‚  - æµ‹è¯•éªŒè¯ç é”™è¯¯åœºæ™¯                                               â”‚
â”‚  - æµ‹è¯•ç”¨æˆ·ä¸å­˜åœ¨åœºæ™¯                                               â”‚
â”‚  - æµ‹è¯•å‚æ•°æ ¡éªŒå¤±è´¥åœºæ™¯                                             â”‚
â”‚  - è¦†ç›–ç‡: 95%                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Commit ä¸ plan.md å¯¹åº”å…³ç³»**:

```
plan.md                              Git Log
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
## Phase 1: ç”¨æˆ·è®¤è¯
### Phase Gates
- [x] Gate 1.1: æ•°æ®åº“è¡¨è®¾è®¡    â†’  feat(db): create users table #gate-1.1
- [x] Gate 1.2: API æ¥å£å®ç°    â†’  feat(auth): implement login API #gate-1.2
- [x] Gate 1.3: æµ‹è¯•ç”¨ä¾‹ç¼–å†™    â†’  test(auth): add login tests #gate-1.3

## Phase 2: å¾®ä¿¡ç™»å½•
### Phase Gates
- [x] Gate 2.1: å¾®ä¿¡ OAuth æ¥å…¥ â†’  feat(auth): add wechat oauth #gate-2.1
- [x] Gate 2.2: å¾®ä¿¡å›è°ƒå¤„ç†    â†’  feat(auth): handle wechat callback #gate-2.2
- [ ] Gate 2.3: æµ‹è¯•ç”¨ä¾‹ç¼–å†™    â†’  (å¾…å®Œæˆ)
```

#### 3.6.6 PR è‡ªåŠ¨ç”Ÿæˆ

**ç›®çš„**: ä»»åŠ¡å®Œæˆåè‡ªåŠ¨ç”Ÿæˆ PR æè¿°ï¼Œä¸€é”®æäº¤ã€‚

**PR è§¦å‘æ—¶æœº**:

| è§¦å‘æ–¹å¼ | è¯´æ˜ |
|---------|------|
| **è‡ªåŠ¨è§¦å‘** | æ‰€æœ‰ Phase Gates å®Œæˆ + code_review.md é€šè¿‡å |
| **æ‰‹åŠ¨è§¦å‘** | `/nomos:pr` å‘½ä»¤ |

**PR æè¿°ç”Ÿæˆè§„åˆ™**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PR æè¿°æ¨¡æ¿                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  ## Summary                                                          â”‚
â”‚  {ä» plan.md çš„ Goal èŠ‚æå–}                                        â”‚
â”‚                                                                      â”‚
â”‚  ## Changes                                                          â”‚
â”‚  {ä» plan.md çš„ Phase Gates æå–ï¼Œåˆ—å‡ºå·²å®Œæˆçš„ Gate}                â”‚
â”‚                                                                      â”‚
â”‚  ## Test Plan                                                        â”‚
â”‚  {ä» code_review.md çš„ Test Results æå–}                           â”‚
â”‚                                                                      â”‚
â”‚  ## Checklist                                                        â”‚
â”‚  - [x] Linter æ£€æŸ¥é€šè¿‡                                              â”‚
â”‚  - [x] æµ‹è¯•è¦†ç›–ç‡ > 80%                                             â”‚
â”‚  - [x] Review Comments å…¨éƒ¨ Addressed                               â”‚
â”‚                                                                      â”‚
â”‚  ---                                                                 â”‚
â”‚  ğŸ¤– Generated with [Claude Code](https://claude.com/code)           â”‚
â”‚  Task: {task_id}                                                    â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**PR æè¿°ç¤ºä¾‹**:

````markdown
## Summary

å®ç°ç”¨æˆ·ç™»å½•åŠŸèƒ½ï¼Œæ”¯æŒæ‰‹æœºå·+éªŒè¯ç ç™»å½•å’Œå¾®ä¿¡ä¸€é”®ç™»å½•ã€‚

## Changes

### Phase 1: ç”¨æˆ·è®¤è¯
- [x] Gate 1.1: æ•°æ®åº“è¡¨è®¾è®¡ - åˆ›å»º users è¡¨
- [x] Gate 1.2: API æ¥å£å®ç° - POST /auth/login
- [x] Gate 1.3: æµ‹è¯•ç”¨ä¾‹ç¼–å†™ - è¦†ç›–ç‡ 95%

### Phase 2: å¾®ä¿¡ç™»å½•
- [x] Gate 2.1: å¾®ä¿¡ OAuth æ¥å…¥
- [x] Gate 2.2: å¾®ä¿¡å›è°ƒå¤„ç†
- [x] Gate 2.3: æµ‹è¯•ç”¨ä¾‹ç¼–å†™ - è¦†ç›–ç‡ 92%

## Test Plan

| æµ‹è¯•ç±»å‹ | è¦†ç›–ç‡ | çŠ¶æ€ |
|---------|--------|------|
| å•å…ƒæµ‹è¯• | 94% | âœ… é€šè¿‡ |
| é›†æˆæµ‹è¯• | 88% | âœ… é€šè¿‡ |
| E2E æµ‹è¯• | - | â³ å¾…è¡¥å…… |

å…³é”®æµ‹è¯•ç”¨ä¾‹:
- `test_phone_login_success`: æ‰‹æœºå·ç™»å½•æˆåŠŸ
- `test_phone_login_invalid_code`: éªŒè¯ç é”™è¯¯
- `test_wechat_login_success`: å¾®ä¿¡ç™»å½•æˆåŠŸ
- `test_wechat_login_cancelled`: ç”¨æˆ·å–æ¶ˆæˆæƒ

## Checklist
- [x] Linter æ£€æŸ¥é€šè¿‡ (0 errors, 0 warnings)
- [x] æµ‹è¯•è¦†ç›–ç‡ > 80% (å®é™…: 94%)
- [x] Review Comments å…¨éƒ¨ Addressed (3/3)
- [x] æ—  CRITICAL/MAJOR é—ç•™é—®é¢˜

---
ğŸ¤– Generated with [Claude Code](https://claude.com/code)
Task: t1-2026-02-25-user-login
````

**PR åˆ›å»ºæµç¨‹**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PR åˆ›å»ºæµç¨‹                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  Step 1: æ£€æŸ¥å®Œæˆæ¡ä»¶                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ âœ… æ‰€æœ‰ Phase Gates å·²å‹¾é€‰                                      â”‚ â”‚
â”‚  â”‚ âœ… æ‰€æœ‰ CRITICAL/MAJOR Review Comments å·² Addressed            â”‚ â”‚
â”‚  â”‚ âœ… Linter æ£€æŸ¥é€šè¿‡                                              â”‚ â”‚
â”‚  â”‚ âœ… æµ‹è¯•è¦†ç›–ç‡è¾¾æ ‡ (>80%)                                        â”‚ â”‚
â”‚  â”‚ âœ… æ— æœªæäº¤çš„æ›´æ”¹                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 2: ç”Ÿæˆ PR æè¿°                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ # ä»å„æ–‡ä»¶æå–å†…å®¹                                              â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ plan.md:                                                        â”‚ â”‚
â”‚  â”‚   - Goal â†’ Summary                                              â”‚ â”‚
â”‚  â”‚   - Phase Gates â†’ Changes                                       â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ code_review.md:                                                 â”‚ â”‚
â”‚  â”‚   - Test Results â†’ Test Plan                                    â”‚ â”‚
â”‚  â”‚   - Linter Results â†’ Checklist                                  â”‚ â”‚
â”‚  â”‚   - Review Comments â†’ Checklist                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 3: ç”Ÿæˆ PR æ ‡é¢˜                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ # æ ¼å¼: {type}: {description}                                  â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ ä»åˆ†æ”¯åæå–: feat/2026-02-25-user-login                        â”‚ â”‚
â”‚  â”‚ ç”Ÿæˆæ ‡é¢˜: feat: ç”¨æˆ·ç™»å½•åŠŸèƒ½                                    â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ æˆ–ä» plan.md Goal æå–                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 4: æ‰§è¡Œ gh å‘½ä»¤                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ gh pr create \                                                  â”‚ â”‚
â”‚  â”‚   --title "feat: ç”¨æˆ·ç™»å½•åŠŸèƒ½" \                                â”‚ â”‚
â”‚  â”‚   --body-file /tmp/pr-body.md \                                â”‚ â”‚
â”‚  â”‚   --base main \                                                 â”‚ â”‚
â”‚  â”‚   --head feat/2026-02-25-user-login                             â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ è¾“å‡º: https://github.com/xxx/xxx/pull/123                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 5: æ›´æ–°ä»»åŠ¡çŠ¶æ€                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ # æ›´æ–° plan.md                                                  â”‚ â”‚
â”‚  â”‚ status: completed                                               â”‚ â”‚
â”‚  â”‚ pr_url: https://github.com/xxx/xxx/pull/123                    â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ # æç¤ºç”¨æˆ·                                                      â”‚ â”‚
â”‚  â”‚ âœ… PR å·²åˆ›å»º: https://github.com/xxx/xxx/pull/123              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**PR é…ç½®é€‰é¡¹**:

```json
{
  "git": {
    "auto_commit_on_gate": true,      // Gate å®Œæˆåè‡ªåŠ¨ commit
    "auto_push_on_commit": true,      // Commit åè‡ªåŠ¨ push
    "auto_pr_on_complete": false,     // ä»»åŠ¡å®Œæˆåè‡ªåŠ¨åˆ›å»º PRï¼ˆå»ºè®®æ‰‹åŠ¨ï¼‰
    "pr_template": "default",         // PR æ¨¡æ¿: default / custom
    "min_test_coverage": 80,          // æœ€ä½æµ‹è¯•è¦†ç›–ç‡è¦æ±‚
    "require_all_gates": true         // æ˜¯å¦è¦æ±‚æ‰€æœ‰ Gate å®Œæˆ
  }
}
```

**æ‰‹åŠ¨åˆ›å»º PR**:

```bash
# ç”¨æˆ·æ‰‹åŠ¨è§¦å‘
/nomos:pr

# æˆ–æŒ‡å®šå‚æ•°
/nomos:pr --draft    # åˆ›å»ºè‰ç¨¿ PR
/nomos:pr --force    # å¼ºåˆ¶åˆ›å»ºï¼ˆå¿½ç•¥æ£€æŸ¥ï¼‰
```

### 3.7 Mermaid å›¾è¡¨ç”Ÿæˆå™¨

**ç›®çš„**: è‡ªåŠ¨ç”Ÿæˆå’Œæ›´æ–°æµç¨‹å›¾,æä¾›å¯è§†åŒ–å¤§å±€è§‚ã€‚

**èŒè´£**:
- ä» plan.md è‡ªåŠ¨ç”Ÿæˆ Mermaid æµç¨‹å›¾
- äººç±»æ‰¹æ³¨åé«˜äº®å˜æ›´(çº¢è‰²/ç»¿è‰²)
- é€šè¿‡ Task Viewer è‡ªåŠ¨æ¸²æŸ“
- é›†æˆåˆ° Task Viewer

**ç”Ÿæˆæ—¶æœº**:
- plan.md é¦–æ¬¡ç”Ÿæˆå
- æ¯æ¬¡äººç±»æ‰¹æ³¨å¹¶ä¿å­˜å
- æ‰‹åŠ¨è§¦å‘ `/nomos:update-diagram`

### 3.8 Test-First å¼ºåˆ¶å™¨

**ç›®çš„**: TDD åˆšæ€§åŒ–,å…ˆå†™æµ‹è¯•å†å†™å®ç°ã€‚

**èŒè´£**:
- ä» plan.md éªŒæ”¶æ ‡å‡†ç”Ÿæˆæµ‹è¯•éª¨æ¶
- PreToolUse æ‹¦æˆª:ä¸å…è®¸å†™å®ç°ä»£ç ,é™¤éæµ‹è¯•æ–‡ä»¶å­˜åœ¨
- è‡ªåŠ¨è¿è¡Œæµ‹è¯•å¹¶æ˜¾ç¤ºè¦†ç›–ç‡
- code_review.md ä¸­æ˜¾ç¤ºè¦†ç›–ç‡å˜åŒ–

**æµ‹è¯•éª¨æ¶ç¤ºä¾‹**:
```python
# tests/test_login.py (è‡ªåŠ¨ç”Ÿæˆ)
def test_phone_login_success():
    """éªŒæ”¶æ ‡å‡†: æ‰‹æœºå·+éªŒè¯ç ç™»å½•æˆåŠŸ"""
    # TODO: å®ç°æµ‹è¯•
    pass

def test_wechat_login_success():
    """éªŒæ”¶æ ‡å‡†: å¾®ä¿¡ä¸€é”®ç™»å½•æˆåŠŸ"""
    # TODO: å®ç°æµ‹è¯•
    pass
```

### 3.9 Revert Manager

**ç›®çš„**: æœæ–­å›æ»šé”™è¯¯ä»£ç ,ä¸å…¶æ‰“è¡¥ä¸ä¿®å¤ä¸å¦‚æœæ–­å›æ»šé‡æ–°è®¾è®¡ã€‚

**èŒè´£**:
- æ£€æµ‹ Revert è§¦å‘æ¡ä»¶
- æ‰§è¡Œ Git Revert æ“ä½œ
- è®°å½• Revert åŸå› å’Œç»“æœ
- æ›´æ–°ä»»åŠ¡çŠ¶æ€,å›åˆ° Plan é˜¶æ®µ

#### 3.9.1 Revert è§¦å‘æ¡ä»¶

| è§¦å‘æ¥æº | æ¡ä»¶ | ä¸¥é‡ç¨‹åº¦ | å¤„ç†æ–¹å¼ |
|----------|------|----------|----------|
| L3 ä¸šåŠ¡è§„åˆ™ | Protected Interface è¢«ä¿®æ”¹ | critical | è‡ªåŠ¨ revert |
| L3 ä¸šåŠ¡è§„åˆ™ | åˆ†å±‚æ¶æ„è¢«ç ´å | critical | è‡ªåŠ¨ revert |
| L4 å®‰å…¨æ£€æŸ¥ | SQL æ³¨å…¥ / XSS / ç¡¬ç¼–ç å¯†é’¥ | critical | è‡ªåŠ¨ revert |
| Validator Subagent | å‘ç°æ¶æ„å†²çª | high | è¯¢é—®äººç±»ç¡®è®¤ |
| Validator Subagent | å¾ªç¯ä¾èµ–å¼•å…¥ | high | è¯¢é—®äººç±»ç¡®è®¤ |
| äººç±» Review æ‰¹æ³¨ | åŒ…å« `[REVERT]` æ ‡è®° | - | è‡ªåŠ¨ revert |
| äººç±» Review æ‰¹æ³¨ | "æ–¹å‘é”™è¯¯" ç­‰å¦å®šæ‰¹æ³¨ | - | è¯¢é—®äººç±»ç¡®è®¤ |
| æµ‹è¯•ç»“æœ | æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•å¤±è´¥ > 30% | high | è‡ªåŠ¨ revert |
| æµ‹è¯•ç»“æœ | å›å½’æµ‹è¯•å¤±è´¥ > 20% | medium | è¯¢é—®äººç±»ç¡®è®¤ |

#### 3.9.2 Revert æ‰§è¡Œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Revert æ‰§è¡Œæµç¨‹                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Step 1: æ£€æµ‹è§¦å‘                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ PostToolUse Hook / Stop Hook / Validator Subagent          â”‚ â”‚
â”‚  â”‚ æ£€æµ‹åˆ°ä¸¥é‡é—®é¢˜ â†’ æ ‡è®° revert_pending = true                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚  Step 2: è¯„ä¼°ä¸¥é‡ç¨‹åº¦                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ severity = critical â†’ è‡ªåŠ¨ revert (æ— éœ€ç¡®è®¤)                â”‚ â”‚
â”‚  â”‚ severity = high/medium â†’ Prompt Handler è¯¢é—®äººç±»           â”‚ â”‚
â”‚  â”‚ severity = low â†’ ä»…è®°å½•è­¦å‘Š,ä¸ revert                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚  Step 3: æ‰§è¡Œ Git Revert                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ # æ–¹æ¡ˆ A: å• commit revert                                  â”‚ â”‚
â”‚  â”‚ git revert HEAD --no-edit                                   â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚ # æ–¹æ¡ˆ B: å¤š commit revert (å›åˆ°æŒ‡å®šç‚¹)                      â”‚ â”‚
â”‚  â”‚ git reset --hard <last-good-commit>                         â”‚ â”‚
â”‚  â”‚ git push --force-with-lease origin <branch>                 â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚ # æ–¹æ¡ˆ C: æ–‡ä»¶çº§ revert (åªå›æ»šç‰¹å®šæ–‡ä»¶)                      â”‚ â”‚
â”‚  â”‚ git checkout <last-good-commit> -- <file-path>              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚  Step 4: æ›´æ–°çŠ¶æ€æ–‡ä»¶                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ code_review.md:                                             â”‚ â”‚
â”‚  â”‚   - ç¬¬ 6 èŠ‚æ·»åŠ  Revert è®°å½•                                  â”‚ â”‚
â”‚  â”‚   - æ›´æ–°æ–‡ä»¶å˜æ›´çŠ¶æ€                                         â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚ plan.md:                                                    â”‚ â”‚
â”‚  â”‚   - çŠ¶æ€æ”¹ä¸º needs_replan                                   â”‚ â”‚
â”‚  â”‚   - æ·»åŠ  Review Comment è¯´æ˜åŸå›                              â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚ progress.md:                                                â”‚ â”‚
â”‚  â”‚   - Error Log æ·»åŠ  revert è®°å½•                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚  Step 5: é€šçŸ¥ä¸æ¢å¤                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ - ç”Ÿæˆ Revert Report (è¾“å‡ºåˆ° CLI)                           â”‚ â”‚
â”‚  â”‚ - Agent å›åˆ° Plan é˜¶æ®µé‡æ–°è®¾è®¡                               â”‚ â”‚
â”‚  â”‚ - ä¿ç•™ research.md (è°ƒç ”ç»“æœä»ç„¶æœ‰æ•ˆ)                        â”‚ â”‚
â”‚  â”‚ - åŒæ­¥æ•™è®­åˆ° project-why.md                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.9.3 Revert åçŠ¶æ€å˜åŒ–

| ç»„ä»¶ | Revert å‰ | Revert å |
|------|-----------|-----------|
| Git | æœ‰é”™è¯¯ commit | å›åˆ°ä¸Šä¸€ä¸ªå¥åº· commit |
| plan.md | executing | needs_replan |
| code_review.md | in_review | åŒ…å« Revert è®°å½• |
| research.md | approved | approved (ä¸å˜) |
| ä»£ç æ–‡ä»¶ | æœ‰é—®é¢˜ä»£ç  | å›æ»šåˆ°å¥åº·çŠ¶æ€ |
| æµ‹è¯•æ–‡ä»¶ | å¯èƒ½æœ‰é—®é¢˜ | å›æ»šåˆ°å¥åº·çŠ¶æ€ |

#### 3.9.4 Revert è®°å½•æ ¼å¼

æ‰€æœ‰ Revert æ“ä½œéƒ½è®°å½•åœ¨ `code_review.md` çš„ç¬¬ 6 èŠ‚:

```markdown
## 6. Revert è®°å½•

### 6.1 Revert #1
- **Revert ID**: REV-2026-02-24-001
- **Revert æ—¶é—´**: 2026-02-24 14:32:15
- **è§¦å‘æ¥æº**: Validator Subagent
- **è§¦å‘åŸå› **: Protected Interface `AuthService.login()` ç­¾åè¢«ä¿®æ”¹
- **ä¸¥é‡ç¨‹åº¦**: critical
- **Revert ç±»å‹**: commit (å• commit revert)
- **Revert èŒƒå›´**:
  - commit: a1b2c3d
  - files: src/auth/service.py, src/auth/service_test.py
- **Git å‘½ä»¤**: `git revert a1b2c3d --no-edit`
- **æ‰§è¡Œç»“æœ**: success
- **å½“å‰ HEAD**: a0b1c2d (å›æ»šå)
- **åç»­å¤„ç†**:
  - [x] plan.md çŠ¶æ€æ›´æ–°ä¸º needs_replan
  - [x] ç”Ÿæˆ Revert Report
  - [ ] ç­‰å¾…äººç±»ç¡®è®¤æ–°æ–¹æ¡ˆ
- **æ•™è®­/æ”¹è¿›ç‚¹**:
  - éœ€è¦åœ¨ PreToolUse ä¸­å¢åŠ  Protected Interface AST æ£€æŸ¥
  - å»ºè®®æ·»åŠ è§„åˆ™: ä¿®æ”¹ auth/ ä¸‹æ–‡ä»¶å¿…é¡»å…ˆæ›´æ–° research.md
```

#### 3.9.5 Hooks å®ç°ç¤ºä¾‹

```python
# .claude/hooks/auto_revert.py

import sys
import json
import subprocess
from datetime import datetime

def check_revert_needed(review_result: dict) -> tuple[bool, str]:
    """æ£€æŸ¥æ˜¯å¦éœ€è¦ revert,è¿”å› (need_revert, reason)"""
    # Critical çº§åˆ«è‡ªåŠ¨è§¦å‘
    if review_result.get("severity") == "critical":
        return True, review_result.get("failure_reason", "Critical error")

    # Protected Interface è¿å
    if review_result.get("protected_interface_violation"):
        return True, "Protected Interface violated"

    # äººç±»æ‰¹æ³¨æ ‡è®°
    annotation = review_result.get("human_annotation", {})
    if annotation.get("action") == "REVERT":
        return True, annotation.get("reason", "Human requested revert")

    return False, ""

def execute_revert(scope: str = "commit") -> tuple[bool, str]:
    """æ‰§è¡Œ revert æ“ä½œ,è¿”å› (success, new_head)"""
    if scope == "commit":
        result = subprocess.run(
            ["git", "revert", "HEAD", "--no-edit"],
            capture_output=True
        )
        if result.returncode == 0:
            # è·å–æ–°çš„ HEAD
            head = subprocess.run(
                ["git", "rev-parse", "--short", "HEAD"],
                capture_output=True, text=True
            )
            return True, head.stdout.strip()

    return False, ""

def record_revert(reason: str, scope: str, result: bool, new_head: str):
    """è®°å½• revert åˆ° code_review.md"""
    revert_record = f"""
### 6.X Revert #{datetime.now().strftime('%Y%m%d%H%M%S')}
- **Revert æ—¶é—´**: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}
- **è§¦å‘åŸå› **: {reason}
- **Revert èŒƒå›´**: {scope}
- **æ‰§è¡Œç»“æœ**: {"success" if result else "failed"}
- **å½“å‰ HEAD**: {new_head}
"""
    # è¿½åŠ åˆ° code_review.md
    # ...

# Hook å…¥å£
if __name__ == "__main__":
    data = json.loads(sys.stdin.read())

    need_revert, reason = check_revert_needed(data)
    if need_revert:
        success, new_head = execute_revert()
        record_revert(reason, "commit", success, new_head)

        if success:
            print(f"REVERT_SUCCESS: {reason}. Please revisit plan.md",
                  file=sys.stderr)
            sys.exit(2)  # é˜»å¡,è®© Agent å¤„ç†
```

#### 3.9.6 è®¾è®¡åŸåˆ™

1. **æœæ–­åŸåˆ™**: ä¸å…¶æ‰“è¡¥ä¸ä¿®å¤é”™è¯¯ä»£ç ,ä¸å¦‚æœæ–­å›æ»šé‡æ–°è®¾è®¡
2. **çœ Token**: Revert æ¯”å¢é‡ä¿®å¤æ›´çœ token
3. **æ•™è®­æ²‰æ·€**: æ¯æ¬¡ Revert éƒ½è¦è®°å½•æ•™è®­å¹¶åŒæ­¥åˆ° project-why.md
4. **ä¸é‡å¤çŠ¯é”™**: Agent è¯»å– Revert è®°å½•åä¸ä¼šé‡å¤ç›¸åŒé”™è¯¯
5. **ä¿ç•™è°ƒç ”**: Revert åªå›æ»šä»£ç ,research.md ä»ç„¶æœ‰æ•ˆ

### 3.10 å®¡æŸ¥ä¸æ ‡æ³¨ç³»ç»Ÿ

**ç›®çš„**: å°† Code Review å‰ç½®åˆ°å†™ä»£ç ä¹‹å‰ï¼Œé€šè¿‡æ–‡æ¡£æ ‡æ³¨å®ç°äººæœºåä½œï¼Œç¡®ä¿æ–¹å‘æ­£ç¡®åå†æ‰§è¡Œã€‚

#### 3.10.1 å®¡æŸ¥æœºåˆ¶

**å®¡æŸ¥å¯¹è±¡ä¸å†…å®¹**:

| å®¡æŸ¥å¯¹è±¡ | å®¡æŸ¥å†…å®¹ | æ‰§è¡Œè€… | å®¡æŸ¥æ–¹å¼ |
|---------|---------|--------|---------|
| **ä»£ç ** | ä¸‰å±‚ Linter è§„åˆ™ï¼ˆè¯­æ³•/å®‰å…¨/ä¸šåŠ¡ï¼‰ | AgentLinterEngine | PreToolUse Hook |
| **æ¶æ„å¥‘çº¦** | Protected Interfaces æ˜¯å¦è¢«ç ´å | Validator Subagent | AST åˆ†æ |
| **è°ƒç ”æ–‡æ¡£** | research.md çš„å®Œæ•´æ€§ã€å‡†ç¡®æ€§ | Validator Subagent + äººç±» | åªè¯»å®¡æŸ¥ + æ ‡æ³¨ |
| **è®¡åˆ’æ–‡æ¡£** | plan.md çš„å¯è¡Œæ€§ã€æ¶æ„å†²çª | Validator Subagent + äººç±» | åªè¯»å®¡æŸ¥ + æ ‡æ³¨ |
| **æµ‹è¯•è¦†ç›–** | æµ‹è¯•æ–‡ä»¶å­˜åœ¨æ€§ã€è¦†ç›–ç‡ | Test-First å¼ºåˆ¶å™¨ | æ–‡ä»¶æ£€æŸ¥ + è¿è¡Œæµ‹è¯• |

**å®¡æŸ¥é˜¶æ®µä¸è§¦å‘ç‚¹**:

```
Why-First â†’ Research â†’ [å®¡æŸ¥ç‚¹1] â†’ Plan â†’ [å®¡æŸ¥ç‚¹2] â†’ Execute â†’ [å®¡æŸ¥ç‚¹3] â†’ Complete
                         â†“                    â†“                   â†“
                  Validator Subagent   Validator Subagent    Linter + äººç±» Review
                  å®¡æŸ¥ research.md      å®¡æŸ¥ plan.md          å®¡æŸ¥ code_review.md
```

| å®¡æŸ¥ç‚¹ | è§¦å‘æ—¶æœº | å®¡æŸ¥å†…å®¹ | é˜»å¡çº§åˆ« | å¤±è´¥å¤„ç† |
|--------|---------|---------|---------|---------|
| **Research å** | research.md ç”Ÿæˆå | è°ƒç ”å®Œæ•´æ€§ã€Protected Interfaces è¯†åˆ« | è­¦å‘Š | è¡¥å……è°ƒç ”å†…å®¹ |
| **Plan å** | plan.md ç”Ÿæˆå | æ¶æ„å†²çªã€å¾ªç¯ä¾èµ–ã€å¯è¡Œæ€§ | é«˜ | å¯èƒ½è§¦å‘ revert |
| **PreToolUse** | æ¯æ¬¡å†™ä»£ç å‰ | ä¸‰å±‚ Linter è§„åˆ™ | å¼ºåˆ¶é˜»å¡ | Agent è‡ªåŠ¨ä¿®å¤ |
| **Stop** | ä»»åŠ¡ç»“æŸå‰ | Phase Gates å…¨éƒ¨å‹¾é€‰ã€Review Comments å…¨éƒ¨ Addressed | å¼ºåˆ¶é˜»å¡ | å®Œæˆæœªå®Œæˆé¡¹ |

**ä¸‰å±‚ Linter è§„åˆ™å®¡æŸ¥**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ä¸‰å±‚è§„åˆ™å®¡æŸ¥æµç¨‹                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  PreToolUse Hook è§¦å‘                                                â”‚
â”‚      â”‚                                                               â”‚
â”‚      â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ç¬¬ä¸€å±‚: è¯­æ³•/ç±»å‹è§„åˆ™ (é™æ€åˆ†æ)                                 â”‚ â”‚
â”‚  â”‚ - ESLintã€Pylintã€TypeScript ç¼–è¯‘å™¨                             â”‚ â”‚
â”‚  â”‚ - ä»£ç æ ¼å¼åŒ–(Prettierã€Black)                                   â”‚ â”‚
â”‚  â”‚ - å¯¼å…¥æ£€æŸ¥ã€æœªä½¿ç”¨å˜é‡                                          â”‚ â”‚
â”‚  â”‚ â†’ å¤±è´¥: é˜»å¡ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯è®© Agent ä¿®å¤                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚      â”‚ é€šè¿‡                                                          â”‚
â”‚      â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ç¬¬äºŒå±‚: å®‰å…¨/æ¶æ„è§„åˆ™ (æ¡†æ¶çº§)                                   â”‚ â”‚
â”‚  â”‚ - SQL æ³¨å…¥æ£€æµ‹                                                  â”‚ â”‚
â”‚  â”‚ - XSS é˜²æŠ¤æ£€æŸ¥                                                  â”‚ â”‚
â”‚  â”‚ - Protected Interfaces ä¿æŠ¤                                     â”‚ â”‚
â”‚  â”‚ - å¾ªç¯ä¾èµ–æ£€æµ‹                                                  â”‚ â”‚
â”‚  â”‚ â†’ å¤±è´¥: é˜»å¡ï¼Œcritical çº§åˆ«å¯èƒ½è§¦å‘ revert                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚      â”‚ é€šè¿‡                                                          â”‚
â”‚      â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ç¬¬ä¸‰å±‚: ä¸šåŠ¡è§„åˆ™ (é¡¹ç›®ç‰¹å®š)                                      â”‚ â”‚
â”‚  â”‚ - i18n å¼ºåˆ¶ä½¿ç”¨ customT()                                       â”‚ â”‚
â”‚  â”‚ - trace_id å¿…é¡»ä¼ é€’                                             â”‚ â”‚
â”‚  â”‚ - plan.md ä¸­å®šä¹‰çš„åŠ¨æ€è§„åˆ™                                      â”‚ â”‚
â”‚  â”‚ â†’ å¤±è´¥: é˜»å¡ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯è®© Agent ä¿®å¤                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚      â”‚ é€šè¿‡                                                          â”‚
â”‚      â–¼                                                               â”‚
â”‚  å…è®¸å†™å…¥æ–‡ä»¶                                                        â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Validator Subagent å®¡æŸ¥ Checklist**:

```markdown
# Validator Subagent å®¡æŸ¥æ¸…å•

## Research é˜¶æ®µå®¡æŸ¥
- [ ] éœ€æ±‚ç†è§£æ˜¯å¦å®Œæ•´ï¼Ÿ
- [ ] Protected Interfaces æ˜¯å¦å…¨éƒ¨è¯†åˆ«ï¼Ÿ
- [ ] å—å½±å“æ¨¡å—æ˜¯å¦é—æ¼ï¼Ÿ
- [ ] æ˜¯å¦å­˜åœ¨æœªæåŠçš„ä¸šåŠ¡çº¦æŸï¼Ÿ
- [ ] Open Questions æ˜¯å¦å……åˆ†ï¼Ÿ

## Plan é˜¶æ®µå®¡æŸ¥
- [ ] è®¾è®¡æ–¹æ¡ˆæ˜¯å¦ä¸ research.md ä¸€è‡´ï¼Ÿ
- [ ] æ˜¯å¦è¿å Protected Interfacesï¼Ÿ
- [ ] æ˜¯å¦å¼•å…¥å¾ªç¯ä¾èµ–ï¼Ÿ
- [ ] Phase Gates æ˜¯å¦å¯éªŒè¯ï¼Ÿ
- [ ] æµ‹è¯•ç­–ç•¥æ˜¯å¦å……åˆ†ï¼Ÿ
- [ ] Mermaid å›¾æ˜¯å¦å‡†ç¡®åæ˜ è®¾è®¡ï¼Ÿ

## Execute é˜¶æ®µå®¡æŸ¥
- [ ] ä»£ç æ˜¯å¦ä¸ plan.md ä¸€è‡´ï¼Ÿ
- [ ] æµ‹è¯•è¦†ç›–ç‡æ˜¯å¦è¾¾æ ‡ï¼Ÿ
- [ ] æ˜¯å¦æœ‰é—æ¼çš„è¾¹ç•Œæ¡ä»¶ï¼Ÿ
- [ ] æ˜¯å¦éœ€è¦ revertï¼Ÿ
```

#### 3.10.2 æ ‡æ³¨æœºåˆ¶

**æ ‡æ³¨æ ¼å¼è§„èŒƒ**:

```markdown
### RC-{N}: {æ ‡é¢˜}
> ä½ç½®: {è¡Œå·}                    â† è¡Œå·å®šä½ï¼ˆç”¨äº Task Viewer æ¸²æŸ“æ ‡è®°ç‚¹ï¼‰
> æ‰¹æ³¨äºº: @{username}             â† è°æ‰¹æ³¨çš„
> æ—¶é—´: {YYYY-MM-DD HH:mm}        â† ä½•æ—¶æ‰¹æ³¨
> ä¸¥é‡ç¨‹åº¦: [{CRITICAL|MAJOR|MINOR|SUGGEST}]  â† ä¸¥é‡ç¨‹åº¦
> çŠ¶æ€: [ ] pending / [x] addressed           â† å¤„ç†çŠ¶æ€
> å†…å®¹: {æ‰¹æ³¨å†…å®¹}

### å›å¤çº¿ç¨‹ (å¯é€‰)
> @agent å›å¤: {Agent çš„å›å¤æˆ–ä¿®æ”¹è¯´æ˜}
> æ—¶é—´: {YYYY-MM-DD HH:mm}
```

**ä¸¥é‡ç¨‹åº¦æ ‡è®°**:

| æ ‡è®° | å«ä¹‰ | å¤„ç†æ–¹å¼ | æ˜¯å¦é˜»å¡ |
|------|------|---------|---------|
| `[CRITICAL]` | ä¸¥é‡é—®é¢˜ï¼Œå¿…é¡»ä¿®å¤ | ç«‹å³é˜»å¡ï¼Œå¯èƒ½è§¦å‘ revert | âœ… é˜»å¡ |
| `[MAJOR]` | é‡è¦é—®é¢˜ï¼Œéœ€è¦ä¿®å¤ | é˜»å¡ï¼Œä½†å¯åå•†ä¼˜å…ˆçº§ | âœ… é˜»å¡ |
| `[MINOR]` | å°é—®é¢˜ï¼Œå»ºè®®ä¿®å¤ | ä¸é˜»å¡ï¼Œè®°å½•å¾…åŠ | âŒ ä¸é˜»å¡ |
| `[SUGGEST]` | å»ºè®®ï¼Œå¯é€‰ | ä¸é˜»å¡ï¼Œä»…ä¾›å‚è€ƒ | âŒ ä¸é˜»å¡ |
| `[REVERT]` | æ–¹å‘é”™è¯¯ï¼Œå›æ»š | è‡ªåŠ¨è§¦å‘ Revert Manager | âœ… å¼ºåˆ¶ |

**æ ‡æ³¨ç±»å‹**:

| ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| **é—®é¢˜æ¾„æ¸…** | å¯¹éœ€æ±‚ç†è§£ä¸å®Œæ•´ï¼Œéœ€è¦è¡¥å…… | "éœ€è¦è¡¥å……å¾®ä¿¡ç™»å½•çš„è¾¹ç•Œæ¡ä»¶" |
| **æ–¹å‘ä¿®æ­£** | è®¾è®¡æ–¹å‘é”™è¯¯ï¼Œéœ€è¦è°ƒæ•´ | "[MAJOR] åº”è¯¥ä½¿ç”¨äº‹ä»¶é©±åŠ¨è€Œéè½®è¯¢" |
| **ç»†èŠ‚è¡¥å……** | é—æ¼çš„è¾¹ç•Œæ¡ä»¶ã€é”™è¯¯å¤„ç† | "ç¼ºå°‘ç½‘ç»œè¶…æ—¶çš„é‡è¯•é€»è¾‘" |
| **æ¶æ„çº¦æŸ** | è¿å Protected Interfacesã€åˆ†å±‚æ¶æ„ | "[CRITICAL] ä¸èƒ½ç›´æ¥è®¿é—® DBï¼Œå¿…é¡»èµ° Repository" |
| **å›æ»šè¯·æ±‚** | æ–¹å‘é”™è¯¯ï¼Œéœ€è¦ revert | "[REVERT] æ•´ä½“æ–¹æ¡ˆä¸ç¬¦åˆé¢„æœŸï¼Œé‡æ–°è®¾è®¡" |

**æ ‡æ³¨é˜¶æ®µ**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         æ ‡æ³¨å¾ªç¯                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  Phase 1: Research é˜¶æ®µæ ‡æ³¨                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ æ–‡ä»¶: research.md                                               â”‚ â”‚
â”‚  â”‚ æ ‡æ³¨ä½ç½®: ç¬¬ 5 èŠ‚ Human Research Notes                          â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ æ ‡æ³¨å†…å®¹ï¼š                                                       â”‚ â”‚
â”‚  â”‚ - éœ€æ±‚ç†è§£æ˜¯å¦æ­£ç¡®ï¼Ÿ                                             â”‚ â”‚
â”‚  â”‚ - Protected Interfaces æ˜¯å¦é—æ¼ï¼Ÿ                               â”‚ â”‚
â”‚  â”‚ - Open Questions æ˜¯å¦éœ€è¦è¡¥å……ï¼Ÿ                                  â”‚ â”‚
â”‚  â”‚ - å—å½±å“æ¨¡å—æ˜¯å¦å®Œæ•´ï¼Ÿ                                           â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ æµç¨‹: Agent ç”Ÿæˆ â†’ äººç±»æ ‡æ³¨ â†’ Agent ä¿®æ”¹ â†’ äººç±»ç¡®è®¤ â†’ è¿›å…¥ Plan  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â†“                                       â”‚
â”‚  Phase 2: Plan é˜¶æ®µæ ‡æ³¨                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ æ–‡ä»¶: plan.md                                                   â”‚ â”‚
â”‚  â”‚ æ ‡æ³¨ä½ç½®: ç¬¬ 6 èŠ‚ Review Comments                               â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ æ ‡æ³¨å†…å®¹ï¼š                                                       â”‚ â”‚
â”‚  â”‚ - è®¾è®¡æ–¹æ¡ˆæ˜¯å¦åˆç†ï¼Ÿ                                             â”‚ â”‚
â”‚  â”‚ - Phase Gates æ˜¯å¦å®Œæ•´ï¼Ÿ                                        â”‚ â”‚
â”‚  â”‚ - æ˜¯å¦è¿åæ¶æ„çº¦æŸï¼Ÿ                                             â”‚ â”‚
â”‚  â”‚ - Mermaid å›¾æ˜¯å¦æ¸…æ™°ï¼Ÿ                                          â”‚ â”‚
â”‚  â”‚ - æµ‹è¯•ç­–ç•¥æ˜¯å¦å……åˆ†ï¼Ÿ                                             â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ æµç¨‹: Agent ç”Ÿæˆ â†’ äººç±»æ ‡æ³¨ â†’ Agent ä¿®æ”¹ â†’ äººç±»ç¡®è®¤ â†’ è¿›å…¥ Exec â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â†“                                       â”‚
â”‚  Phase 3: Execute é˜¶æ®µæ ‡æ³¨                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ æ–‡ä»¶: code_review.md                                            â”‚ â”‚
â”‚  â”‚ æ ‡æ³¨ä½ç½®: ç¬¬ 4 èŠ‚ Review Comments                               â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ æ ‡æ³¨å†…å®¹ï¼š                                                       â”‚ â”‚
â”‚  â”‚ - ä»£ç è´¨é‡æ˜¯å¦ç¬¦åˆé¢„æœŸï¼Ÿ                                         â”‚ â”‚
â”‚  â”‚ - æµ‹è¯•æ˜¯å¦å……åˆ†ï¼Ÿ                                                 â”‚ â”‚
â”‚  â”‚ - æ˜¯å¦æœ‰é—æ¼çš„è¾¹ç•Œæ¡ä»¶ï¼Ÿ                                         â”‚ â”‚
â”‚  â”‚ - æ˜¯å¦éœ€è¦ [REVERT]ï¼Ÿ                                           â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ æµç¨‹: ä»£ç ç”Ÿæˆ â†’ äººç±»æ ‡æ³¨ â†’ Agent ä¿®å¤ â†’ äººç±»ç¡®è®¤ â†’ ä»»åŠ¡å®Œæˆ    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ‡æ³¨é˜¶æ®µå¯¹ç…§è¡¨**:

| æ ‡æ³¨é˜¶æ®µ | æ ‡æ³¨æ–‡ä»¶ | æ ‡æ³¨ä½ç½® | æ ‡æ³¨ç›®çš„ | ä¸‹ä¸€é˜¶æ®µæ¡ä»¶ |
|---------|---------|---------|---------|-------------|
| **Research â†’ Plan** | research.md | ç¬¬ 5 èŠ‚ Human Research Notes | ç¡®è®¤éœ€æ±‚ç†è§£æ­£ç¡® | æ‰€æœ‰ CRITICAL/MAJOR æ ‡æ³¨ [x] addressed |
| **Plan â†’ Execute** | plan.md | ç¬¬ 6 èŠ‚ Review Comments | ç¡®è®¤è®¾è®¡æ–¹æ¡ˆåˆç† | æ‰€æœ‰ CRITICAL/MAJOR æ ‡æ³¨ [x] addressed |
| **Execute â†’ Complete** | code_review.md | ç¬¬ 4 èŠ‚ Review Comments | ç¡®è®¤ä»£ç è´¨é‡è¾¾æ ‡ | æ‰€æœ‰ CRITICAL/MAJOR æ ‡æ³¨ [x] addressed |

#### 3.10.3 å®¡æŸ¥ vs æ ‡æ³¨ çš„å…³ç³»

| ç»´åº¦ | å®¡æŸ¥ (Review) | æ ‡æ³¨ (Annotation) |
|------|---------------|-------------------|
| **æ‰§è¡Œè€…** | ç³»ç»Ÿï¼ˆLinterã€Validatorï¼‰ | äººç±» |
| **æ—¶æœº** | è‡ªåŠ¨è§¦å‘ï¼ˆPreToolUseã€Stopï¼‰ | äººç±»ä¸»åŠ¨æ‰¹æ³¨ |
| **å½¢å¼** | JSON æŠ¥å‘Šã€é˜»å¡/æ”¾è¡Œ | Review Commentsã€å¯¹è¯å¼ |
| **ç›®çš„** | åˆšæ€§çº¦æŸï¼ˆè¯­æ³•ã€å®‰å…¨ã€æ¶æ„ï¼‰ | è½¯æ€§æŒ‡å¯¼ï¼ˆæ–¹å‘ã€ç»†èŠ‚ã€åå¥½ï¼‰ |
| **å­˜å‚¨** | code_review.md ç¬¬ 1-3 èŠ‚ | å„æ–‡æ¡£çš„ Review Comments èŠ‚ |
| **å¯è§æ€§** | CLI è¾“å‡º + code_review.md | Task Viewer å¯è§†åŒ– |

#### 3.10.4 æ ‡æ³¨å¾ªç¯æ ¸å¿ƒä»·å€¼

**ä¸ºä»€ä¹ˆå«"å¾ªç¯"ï¼Ÿ**

```
Agent ç”Ÿæˆæ–‡æ¡£ â†’ äººç±»æ ‡æ³¨ â†’ Agent ä¿®æ”¹ â†’ äººç±»å†æ ‡æ³¨ â†’ ... â†’ å…¨éƒ¨ [x] Addressed â†’ ä¸‹ä¸€é˜¶æ®µ
```

**æ ¸å¿ƒä»·å€¼ç‚¹**:

| ä»·å€¼ç‚¹ | è¯´æ˜ | å¯¹æ¯”ä¼ ç»Ÿæ–¹å¼ |
|--------|------|-------------|
| **å‰ç½® Review** | åœ¨å†™ä»£ç ä¹‹å‰å°±å‘ç°é—®é¢˜ | ä¼ ç»Ÿ: å†™å®Œä»£ç å† review |
| **ä¸Šä¸‹æ–‡ä¸ä¸¢å¤±** | æ ‡æ³¨åœ¨æ–‡æ¡£é‡Œï¼Œæ°¸ä¹…ä¿å­˜ | ä¼ ç»Ÿ: èŠå¤©è®°å½•è¢«é—å¿˜ |
| **Agent è‡ªæˆ‘ä¿®å¤** | æ ‡æ³¨ç›´æ¥å–‚å› Agentï¼Œè‡ªåŠ¨ä¿®æ”¹ | ä¼ ç»Ÿ: äººå·¥æ”¹ä»£ç  |
| **æ ‡æ³¨å³æ‹¦æˆª** | æ ‡æ³¨ä¸­çš„è§„åˆ™è‡ªåŠ¨æ³¨å…¥ Linter | ä¼ ç»Ÿ: è§„åˆ™éœ€è¦å•ç‹¬é…ç½® |
| **å¯è¿½æº¯** | æ‰€æœ‰æ ‡æ³¨éƒ½æœ‰å†å²è®°å½• | ä¼ ç»Ÿ: å£å¤´æ²Ÿé€šæ— è®°å½• |

**æ ‡æ³¨å¾ªç¯ç¤ºä¾‹**:

```markdown
# plan.md æ ‡æ³¨å¾ªç¯ç¤ºä¾‹

## 6. Review Comments

### RC-1: è¡¥å……å¾®ä¿¡ç™»å½•è¾¹ç•Œæ¡ä»¶
> ä½ç½®: 47
> æ‰¹æ³¨äºº: @developer
> æ—¶é—´: 2026-02-24 10:30
> ä¸¥é‡ç¨‹åº¦: [MAJOR]
> çŠ¶æ€: [ ] pending
> å†…å®¹: éœ€è¦è¡¥å……å¾®ä¿¡ç™»å½•çš„è¾¹ç•Œæ¡ä»¶ï¼Œå¦‚ç”¨æˆ·å–æ¶ˆæˆæƒã€ç½‘ç»œè¶…æ—¶ç­‰åœºæ™¯

### RC-1 å›å¤çº¿ç¨‹
> @agent å›å¤: å·²åœ¨ Phase Gates ä¸­è¡¥å…… Gate 1.4 å¤„ç†å¾®ä¿¡æˆæƒè¾¹ç•Œæ¡ä»¶
> æ—¶é—´: 2026-02-24 10:45
> çŠ¶æ€: [x] addressed

--- Agent ä¿®æ”¹å ---

### Phase Gates
- [ ] Gate 1.1: æ•°æ®åº“è¡¨è®¾è®¡
- [ ] Gate 1.2: API æ¥å£å®ç°
- [ ] Gate 1.3: æµ‹è¯•ç”¨ä¾‹ç¼–å†™
- [ ] Gate 1.4: å¾®ä¿¡æˆæƒè¾¹ç•Œå¤„ç† (ç”¨æˆ·å–æ¶ˆã€ç½‘ç»œè¶…æ—¶ã€æˆæƒè¿‡æœŸ)  â† æ–°å¢
```

#### 3.10.5 æ ‡æ³¨ â†’ å®¡æŸ¥ â†’ Revert çš„è”åŠ¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ ‡æ³¨ â†’ å®¡æŸ¥ â†’ Revert è”åŠ¨æµç¨‹                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  Step 1: äººç±»æ ‡æ³¨                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ äººç±»åœ¨ plan.md æˆ– code_review.md ä¸­æ·»åŠ æ‰¹æ³¨:                    â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ ### RC-3: æ¶æ„è¿å                                              â”‚ â”‚
â”‚  â”‚ > ä¸¥é‡ç¨‹åº¦: [CRITICAL]                                          â”‚ â”‚
â”‚  â”‚ > å†…å®¹: ç›´æ¥è®¿é—® DB è¿ååˆ†å±‚æ¶æ„ï¼Œå¿…é¡»èµ° Repository              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 2: Validator Subagent æ£€æµ‹                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Stop Hook æˆ– /nomos:validate è§¦å‘ Validator Subagent       â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ æ£€æµ‹åˆ°:                                                         â”‚ â”‚
â”‚  â”‚ - ä¸¥é‡ç¨‹åº¦ = CRITICAL                                           â”‚ â”‚
â”‚  â”‚ - å†…å®¹åŒ…å« "è¿ååˆ†å±‚æ¶æ„"                                       â”‚ â”‚
â”‚  â”‚ - æˆ–å†…å®¹åŒ…å« [REVERT] æ ‡è®°                                      â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ â†’ æ ‡è®° revert_pending = true                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 3: Revert Manager æ‰§è¡Œ                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Revert Manager æ”¶åˆ°ä¿¡å·:                                        â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ 1. è¯„ä¼°ä¸¥é‡ç¨‹åº¦: CRITICAL â†’ è‡ªåŠ¨ revert                         â”‚ â”‚
â”‚  â”‚ 2. æ‰§è¡Œ git revert HEAD --no-edit                               â”‚ â”‚
â”‚  â”‚ 3. è®°å½•åˆ° code_review.md ç¬¬ 6 èŠ‚                                â”‚ â”‚
â”‚  â”‚ 4. æ›´æ–° plan.md çŠ¶æ€ä¸º needs_replan                             â”‚ â”‚
â”‚  â”‚ 5. åŒæ­¥æ•™è®­åˆ° project-why.md                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 4: å›åˆ° Plan é˜¶æ®µ                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Agent è¯»å–:                                                     â”‚ â”‚
â”‚  â”‚ - plan.md (çŠ¶æ€: needs_replan)                                  â”‚ â”‚
â”‚  â”‚ - code_review.md (Revert è®°å½•)                                  â”‚ â”‚
â”‚  â”‚ - project-why.md (æ•™è®­: å¿…é¡»èµ° Repository)                      â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ â†’ é‡æ–°è®¾è®¡æ–¹æ¡ˆï¼Œéµå¾ªåˆ†å±‚æ¶æ„                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è”åŠ¨è§¦å‘æ¡ä»¶**:

| è§¦å‘æ¥æº | æ¡ä»¶ | è”åŠ¨åŠ¨ä½œ |
|----------|------|---------|
| äººç±»æ ‡æ³¨ `[REVERT]` | ä»»ä½•é˜¶æ®µ | è‡ªåŠ¨ revertï¼Œæ— éœ€ç¡®è®¤ |
| äººç±»æ ‡æ³¨ `[CRITICAL]` + æ¶æ„è¿å | Plan/Execute é˜¶æ®µ | è‡ªåŠ¨ revert |
| Validator Subagent å‘ç° | Protected Interface è¢«ä¿®æ”¹ | è¯¢é—®äººç±»ç¡®è®¤å revert |
| Linter ç¬¬äºŒå±‚å¤±è´¥ | SQL æ³¨å…¥ / XSS / ç¡¬ç¼–ç å¯†é’¥ | é˜»å¡å†™å…¥ + è­¦å‘Š |
| æµ‹è¯•å¤§é¢ç§¯å¤±è´¥ | æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•å¤±è´¥ > 30% | è‡ªåŠ¨ revert |

#### 3.10.6 æ ‡æ³¨å¾ªç¯å®Œæ•´æµç¨‹

**è§¦å‘æœºåˆ¶**: é‡‡ç”¨æ‰‹åŠ¨å‘½ä»¤æ–¹å¼ï¼ˆæ–¹æ¡ˆ Aï¼‰

| è§¦å‘æ–¹å¼ | å‘½ä»¤/æ“ä½œ | è¯´æ˜ |
|---------|---------|------|
| **å¤„ç†æ ‡æ³¨** | `ç»§ç»­` æˆ– `å¤„ç†æ ‡æ³¨` | äººç±»åœ¨ CLI è¾“å…¥ï¼Œé€šçŸ¥ Agent è¯»å–å¹¶å¤„ç†æ ‡æ³¨ |
| **æ‰‹åŠ¨æ ¡éªŒ** | `/nomos:validate` | æ‰‹åŠ¨è§¦å‘ Validator Subagent å®¡æŸ¥ |
| **è‡ªåŠ¨æ ¡éªŒ** | Stop Hook | ä»»åŠ¡ç»“æŸå‰è‡ªåŠ¨æ£€æŸ¥æ ‡æ³¨çŠ¶æ€ |

**å®Œæ•´æµç¨‹å›¾**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ ‡æ³¨å¾ªç¯å®Œæ•´æµç¨‹                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  Step 1: Agent ç”Ÿæˆæ–‡æ¡£                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ /nomos:research æˆ– /nomos:plan                       â”‚ â”‚
â”‚  â”‚ Agent åœ¨ CLI ç”Ÿæˆ research.md æˆ– plan.md                       â”‚ â”‚
â”‚  â”‚ æ–‡æ¡£ä¸­è‡ªåŠ¨åŒ…å« Review Comments èŠ‚ï¼ˆåˆå§‹ä¸ºç©ºï¼‰                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 2: äººç±»æ‰“å¼€ Task Viewer                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ äººç±»æ‰§è¡Œ: /nomos:view-task                                â”‚ â”‚
â”‚  â”‚ ç³»ç»Ÿå¯åŠ¨ Python åç«¯ + æ‰“å¼€æµè§ˆå™¨                               â”‚ â”‚
â”‚  â”‚ æ˜¾ç¤º: Markdown æ¸²æŸ“ + Mermaid å›¾ + æ ‡è®°ç‚¹                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 3: äººç±»æ ‡æ³¨                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ æ–¹å¼ A: å³é”®ç‚¹å‡»ä»»æ„è¡Œ â†’ é«˜äº®è¯¥è¡Œ â†’ æ‰“å¼€æ–°å»ºæ ‡æ³¨æ¡†              â”‚ â”‚
â”‚  â”‚ æ–¹å¼ B: å·¦é”®ç‚¹å‡»æ ‡è®°ç‚¹ â†’ æŸ¥çœ‹å·²å­˜åœ¨æ ‡æ³¨ â†’ è¿½åŠ å†…å®¹              â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ å¡«å†™: æ‰¹æ³¨å†…å®¹ + ä¸¥é‡ç¨‹åº¦                                       â”‚ â”‚
â”‚  â”‚ ç‚¹å‡» [ä¿å­˜] â†’ POST /api/annotations                            â”‚ â”‚
â”‚  â”‚ åç«¯æ›´æ–° plan.md çš„ Review Comments èŠ‚                          â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ çŠ¶æ€: pendingï¼ˆå¾…å¤„ç†ï¼‰                                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 4: äººç±»é€šçŸ¥ Agent å¤„ç†æ ‡æ³¨ï¼ˆæ‰‹åŠ¨è§¦å‘ï¼‰                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ äººç±»åœ¨ CLI è¾“å…¥:                                                â”‚ â”‚
â”‚  â”‚   "ç»§ç»­" æˆ– "å¤„ç†æ ‡æ³¨" æˆ– "ç»§ç»­ä»»åŠ¡"                            â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ â†’ UserPromptSubmit Hook æ£€æµ‹åˆ°å…³é”®è¯                            â”‚ â”‚
â”‚  â”‚ â†’ æ³¨å…¥å½“å‰ä»»åŠ¡çš„ Review Comments å†…å®¹                           â”‚ â”‚
â”‚  â”‚ â†’ Agent è¯»å–æ ‡æ³¨å¹¶å¤„ç†                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 5: Agent è¯»å–æ ‡æ³¨                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Agent è¯»å– plan.md çš„ Review Comments èŠ‚                        â”‚ â”‚
â”‚  â”‚ å‘ç°: RC-1: pending, RC-2: pending                             â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ è¯šå®è¿½é—®æœºåˆ¶:                                                   â”‚ â”‚
â”‚  â”‚ - å¦‚æœç†è§£ â†’ ç›´æ¥ä¿®æ”¹æ–‡æ¡£ï¼Œè¿½åŠ å›å¤åˆ°æ ‡æ³¨å†å²                   â”‚ â”‚
â”‚  â”‚ - å¦‚æœä¸ç†è§£ â†’ åœ¨æ ‡æ³¨å†å²ä¸­è¿½åŠ  â“ æé—®                         â”‚ â”‚
â”‚  â”‚                 çŠ¶æ€æ”¹ä¸º pending_ai_question                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 6: Agent ä¿®æ”¹æ–‡æ¡£                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Agent æ ¹æ®æ ‡æ³¨ä¿®æ”¹æ–‡æ¡£å†…å®¹                                       â”‚ â”‚
â”‚  â”‚ åœ¨æ ‡æ³¨å†å²ä¸­è¿½åŠ å›å¤:                                           â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ **[2026-02-24 10:45] ğŸ¤– @agent**                               â”‚ â”‚
â”‚  â”‚ > å·²åœ¨ Phase Gates ä¸­è¡¥å…… Gate 1.4...                          â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ å¦‚æœå®Œå…¨å¤„ç†: çŠ¶æ€æ”¹ä¸º addressed                                â”‚ â”‚
â”‚  â”‚ å¦‚æœéœ€è¦ç”¨æˆ·ç¡®è®¤: çŠ¶æ€ä¿æŒ pending æˆ–æ”¹ä¸º pending_ai_question   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 7: å†…å®¹åŠ¨æ€åˆ·æ–°                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Task Viewer é€šè¿‡ WebSocket/è½®è¯¢ æ£€æµ‹åˆ°æ–‡ä»¶å˜åŒ–                  â”‚ â”‚
â”‚  â”‚ è‡ªåŠ¨åˆ·æ–°å†…å®¹åŒº:                                                 â”‚ â”‚
â”‚  â”‚ - ä¿ç•™å½“å‰æ‰“å¼€çš„æ ‡æ³¨æ¡†çŠ¶æ€                                      â”‚ â”‚
â”‚  â”‚ - æ›´æ–° Markdown å†…å®¹                                            â”‚ â”‚
â”‚  â”‚ - é‡æ–°è®¡ç®—æ ‡è®°ç‚¹ä½ç½®                                            â”‚ â”‚
â”‚  â”‚ - æ˜¾ç¤º"å†…å®¹å·²æ›´æ–°"æç¤ºæ¡                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 8: äººç±»ç¡®è®¤                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ äººç±»åœ¨ Task Viewer åˆ·æ–°é¡µé¢ï¼ˆæˆ–è‡ªåŠ¨åˆ·æ–°åï¼‰                     â”‚ â”‚
â”‚  â”‚ å·¦é”®ç‚¹å‡»æ ‡è®°ç‚¹ â†’ æŸ¥çœ‹æ ‡æ³¨å†å² â†’ æŸ¥çœ‹ Agent å›å¤                 â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ é€‰æ‹©:                                                           â”‚ â”‚
â”‚  â”‚ - ç¡®è®¤é€šè¿‡ â†’ çŠ¶æ€ä¿æŒ addressed                                â”‚ â”‚
â”‚  â”‚ - ä»æœ‰é—®é¢˜ â†’ åœ¨å†å²ä¸­è¿½åŠ æ–°æ ‡æ³¨                                 â”‚ â”‚
â”‚  â”‚ - AI æœ‰è¿½é—® â†’ åœ¨å†å²ä¸­å›å¤è¿½é—®                                  â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ å¦‚æœè¿½åŠ æ–°å†…å®¹ â†’ çŠ¶æ€å›åˆ° pending â†’ å›åˆ° Step 4                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 9: æ£€æŸ¥æ˜¯å¦å¯ä»¥è¿›å…¥ä¸‹ä¸€é˜¶æ®µ                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ è§¦å‘: Stop Hook æˆ– /nomos:validate                        â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ æ£€æŸ¥é€»è¾‘:                                                       â”‚ â”‚
â”‚  â”‚ for rc in review_comments:                                      â”‚ â”‚
â”‚  â”‚     if rc.severity in [CRITICAL, MAJOR]:                       â”‚ â”‚
â”‚  â”‚         if rc.status not in [addressed, wont_fix]:             â”‚ â”‚
â”‚  â”‚             return BLOCKED                                      â”‚ â”‚
â”‚  â”‚ return PASSED                                                   â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ ç»“æœ:                                                           â”‚ â”‚
â”‚  â”‚ - âœ… PASSED â†’ å…è®¸è¿›å…¥ä¸‹ä¸€é˜¶æ®µ                                  â”‚ â”‚
â”‚  â”‚ - âŒ BLOCKED â†’ æç¤ºè¿˜æœ‰ N ä¸ªå¾…å¤„ç†æ ‡æ³¨                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 10: å¾ªç¯æˆ–ç»“æŸ                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ å¦‚æœè¿˜æœ‰ pending / pending_ai_question / pending_user_clarify  â”‚ â”‚
â”‚  â”‚     â†’ å›åˆ° Step 4ï¼ˆäººç±»å†æ¬¡é€šçŸ¥ Agentï¼‰                         â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ å¦‚æœå…¨éƒ¨ addressed æˆ– wont_fix                                  â”‚ â”‚
â”‚  â”‚     â†’ è¿›å…¥ä¸‹ä¸€é˜¶æ®µ                                              â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ Research â†’ Plan â†’ Execute â†’ Complete                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.10.7 å¦‚ä½•çŸ¥é“æ˜¯å¦éœ€è¦ç»§ç»­æ ‡æ³¨

**çŠ¶æ€æ£€æŸ¥å‘½ä»¤**: `/nomos:validate`

**æ£€æŸ¥è¾“å‡ºç¤ºä¾‹**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ” æ ‡æ³¨çŠ¶æ€æ£€æŸ¥                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  ğŸ“‹ research.md                                                      â”‚
â”‚  â”œâ”€â”€ RC-1: [MAJOR] addressed âœ…                                     â”‚
â”‚  â””â”€â”€ RC-2: [MINOR] addressed âœ…                                     â”‚
â”‚  ç»“æœ: âœ… å¯ä»¥è¿›å…¥ Plan é˜¶æ®µ                                         â”‚
â”‚                                                                      â”‚
â”‚  ğŸ“‹ plan.md                                                          â”‚
â”‚  â”œâ”€â”€ RC-1: [MAJOR] pending_ai_question â“                           â”‚
â”‚  â”‚   â””â”€â”€ AI è¿½é—®: è¯·ç¡®è®¤å¾®ä¿¡æœåŠ¡ä¸å¯ç”¨æ—¶æ˜¯å¦éœ€è¦é™çº§ï¼Ÿ               â”‚
â”‚  â”œâ”€â”€ RC-2: [CRITICAL] pending âš ï¸                                    â”‚
â”‚  â”‚   â””â”€â”€ å†…å®¹: ç›´æ¥è®¿é—® DB è¿ååˆ†å±‚æ¶æ„                              â”‚
â”‚  â””â”€â”€ RC-3: [MINOR] addressed âœ…                                     â”‚
â”‚  ç»“æœ: âŒ è¿˜æœ‰ 2 ä¸ªå¾…å¤„ç†æ ‡æ³¨ï¼Œæ— æ³•è¿›å…¥ Execute é˜¶æ®µ                 â”‚
â”‚                                                                      â”‚
â”‚  âš ï¸ å¾…å¤„ç†æ ‡æ³¨åˆ—è¡¨:                                                  â”‚
â”‚  1. RC-1 [MAJOR] - AI æœ‰è¿½é—®ï¼Œè¯·åœ¨ Task Viewer ä¸­å›å¤               â”‚
â”‚  2. RC-2 [CRITICAL] - éœ€è¦ä¿®æ”¹æˆ–ç¡®è®¤                                â”‚
â”‚                                                                      â”‚
â”‚  ğŸ’¡ æç¤º: åœ¨ Task Viewer ä¸­æŸ¥çœ‹æ ‡æ³¨è¯¦æƒ…ï¼Œå¤„ç†åè¾“å…¥"ç»§ç»­"            â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è‡ªåŠ¨æ£€æŸ¥æ—¶æœº**:

| æ—¶æœº | è§¦å‘æ–¹å¼ | é˜»å¡çº§åˆ« |
|------|---------|---------|
| **Stop Hook** | ä»»åŠ¡ç»“æŸå‰è‡ªåŠ¨è§¦å‘ | å¼ºåˆ¶é˜»å¡ |
| **é˜¶æ®µåˆ‡æ¢** | Plan â†’ Execute å‰ | å¼ºåˆ¶é˜»å¡ |
| **æ‰‹åŠ¨è§¦å‘** | `/nomos:validate` | ä»…æç¤º |

#### 3.10.8 å¦‚ä½•ç¡®è®¤ AI ç†è§£æ­£ç¡®

**æ ‡æ³¨å†å²çº¿ç¨‹æœºåˆ¶**:

é€šè¿‡æ ‡æ³¨å†å²å¯ä»¥å®Œæ•´è¿½æº¯ AI çš„ç†è§£å’Œå¤„ç†è¿‡ç¨‹ï¼š

```markdown
### RC-1: è¡¥å……å¾®ä¿¡ç™»å½•è¾¹ç•Œæ¡ä»¶
> ä½ç½®: 47
> åˆ›å»ºæ—¶é—´: 2026-02-24 10:30
> æœ€åæ›´æ–°: 2026-02-24 11:20
> ä¸¥é‡ç¨‹åº¦: [MAJOR]
> çŠ¶æ€: addressed

#### æ ‡æ³¨å†å²

**[2026-02-24 10:30] ğŸ‘¤ @developer**
> éœ€è¦è¡¥å……å¾®ä¿¡ç™»å½•çš„è¾¹ç•Œæ¡ä»¶ï¼Œå¦‚ç”¨æˆ·å–æ¶ˆæˆæƒã€ç½‘ç»œè¶…æ—¶ç­‰åœºæ™¯

**[2026-02-24 10:45] ğŸ¤– @agent**
> å·²åœ¨ Phase Gates ä¸­è¡¥å…… Gate 1.4ï¼Œå¤„ç†ä»¥ä¸‹è¾¹ç•Œæ¡ä»¶ï¼š
> - ç”¨æˆ·å–æ¶ˆæˆæƒ â†’ è¿”å›é”™è¯¯ç  1001
> - ç½‘ç»œè¶…æ—¶ â†’ é‡è¯• 3 æ¬¡åè¿”å›é”™è¯¯ç  1002
> - æˆæƒè¿‡æœŸ â†’ å¼•å¯¼ç”¨æˆ·é‡æ–°æˆæƒ

**[2026-02-24 10:46] â“ @agent è¿½é—®**
> è¯·ç¡®è®¤ï¼šå¾®ä¿¡æœåŠ¡ä¸å¯ç”¨æ—¶æ˜¯å¦éœ€è¦é™çº§å¤„ç†ï¼Ÿ

**[2026-02-24 11:15] ğŸ‘¤ @developer**
> æ˜¯çš„ï¼Œéœ€è¦é™çº§ã€‚é™çº§æ–¹æ¡ˆï¼šæ˜¾ç¤º"å¾®ä¿¡æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œè¯·ä½¿ç”¨æ‰‹æœºå·ç™»å½•"

**[2026-02-24 11:20] ğŸ¤– @agent**
> å·²è¡¥å…… Gate 1.5ï¼šå¾®ä¿¡æœåŠ¡ä¸å¯ç”¨æ—¶çš„é™çº§å¤„ç†
> çŠ¶æ€æ›´æ–°ä¸º addressed
```

**AI ç†è§£ç¡®è®¤çš„å‡ ç§æƒ…å†µ**:

| æƒ…å†µ | æ ‡æ³¨çŠ¶æ€ | äººç±»æ“ä½œ |
|------|---------|---------|
| AI å®Œå…¨ç†è§£å¹¶å¤„ç† | `addressed` | ç¡®è®¤é€šè¿‡ï¼Œä¿æŒçŠ¶æ€ |
| AI éƒ¨åˆ†ç†è§£ï¼Œéœ€è¦è¡¥å…… | `pending` | è¿½åŠ è¯´æ˜ï¼Œç»§ç»­å¾ªç¯ |
| AI ä¸ç†è§£ï¼Œä¸»åŠ¨æé—® | `pending_ai_question` | å›å¤è¿½é—® |
| AI æœ‰ç–‘é—®ï¼Œè¯·æ±‚æ¾„æ¸… | `pending_user_clarify` | æ¾„æ¸…é—®é¢˜ |
| æ–¹å‘é”™è¯¯ | `[REVERT]` | è§¦å‘ revert |

**è¯šå®è¿½é—®æœºåˆ¶**:

å½“ Agent é‡åˆ°ä¸ç†è§£çš„æ‰¹æ³¨æ—¶ï¼Œä¼šåœ¨æ ‡æ³¨å†å²ä¸­è¿½åŠ  â“ æé—®ï¼Œè€Œä¸æ˜¯è‡ªä½œä¸»å¼ ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AI è¯šå®è¿½é—®ç¤ºä¾‹                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  **[2026-02-24 10:46] â“ @agent è¿½é—®**                              â”‚
â”‚  > æˆ‘ä¸å¤ªç†è§£"éœ€è¦è€ƒè™‘é«˜å¹¶å‘åœºæ™¯"å…·ä½“æŒ‡ä»€ä¹ˆï¼š                        â”‚
â”‚  > 1. æ˜¯æŒ‡éœ€è¦å¤„ç†å¤§é‡åŒæ—¶ç™»å½•è¯·æ±‚ï¼Ÿ                                 â”‚
â”‚  > 2. è¿˜æ˜¯æŒ‡éœ€è¦å¤„ç†å¾®ä¿¡å›è°ƒçš„å¹¶å‘ï¼Ÿ                                 â”‚
â”‚  > 3. æˆ–è€…ä¸¤è€…éƒ½éœ€è¦ï¼Ÿ                                               â”‚
â”‚  >                                                                   â”‚
â”‚  > è¯·åœ¨ Task Viewer ä¸­å›å¤æ­¤è¿½é—®ï¼Œæˆ‘ä¼šæ ¹æ®æ‚¨çš„æ¾„æ¸…ç»§ç»­å¤„ç†ã€‚         â”‚
â”‚                                                                      â”‚
â”‚  çŠ¶æ€: pending_ai_question                                           â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Task Viewer ä¸­çš„è¿½é—®æç¤º**:

å½“æœ‰ AI è¿½é—®æ—¶ï¼Œæ ‡è®°ç‚¹ä¼šæ˜¾ç¤º â“ å›¾æ ‡å¹¶é—ªçƒï¼Œæé†’ç”¨æˆ·å¤„ç†ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”” æ‚¨æœ‰ 2 æ¡ AI è¿½é—®å¾…å¤„ç†                                          â”‚
â”‚                                                                      â”‚
â”‚  ğŸ“‹ plan.md                                                          â”‚
â”‚  â”œâ”€â”€ RC-1 â“ AI è¿½é—®å¾…å›å¤                      [æŸ¥çœ‹] [å›å¤]        â”‚
â”‚  â””â”€â”€ RC-3 â“ AI è¿½é—®å¾…å›å¤                      [æŸ¥çœ‹] [å›å¤]        â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.10.7 å¾ªç¯æœºåˆ¶æ€»è§ˆ

**è®¾è®¡ç†å¿µ**: åˆšæ€§æµç¨‹ä¸æ˜¯å•å‘çš„"ä¸€æ¡é¾™"æµç¨‹ï¼Œè€Œæ˜¯åŒ…å«å¤šä¸ªå¾ªç¯æœºåˆ¶çš„å¤æ‚ç³»ç»Ÿï¼Œæ¯ä¸ªå¾ªç¯éƒ½æœ‰æ˜ç¡®çš„è§¦å‘æ¡ä»¶ã€å¤„ç†é€»è¾‘å’Œé€€å‡ºæ¡ä»¶ã€‚

**æ•´ä½“æµç¨‹å›¾ï¼ˆå«å¾ªç¯ï¼‰**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         åˆšæ€§æµç¨‹å®Œæ•´å›¾ï¼ˆå«å¾ªç¯ï¼‰                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                           â”‚
â”‚  â”‚  Why-First   â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚  â”‚  (æ€è€ƒä¸ºä»€ä¹ˆ) â”‚         Why-First å¾ªç¯             â”‚                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚                     â”‚
â”‚         â†“                                            â”‚                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     æ ‡æ³¨æœªé€šè¿‡      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                     â”‚
â”‚  â”‚   Research   â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ æ ‡æ³¨å¾ªç¯ â”‚ â”€â”˜                     â”‚
â”‚  â”‚  (è°ƒç ”åˆ†æ)   â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                         â†‘                               â”‚
â”‚         â”‚ æ ‡æ³¨é€šè¿‡                        â”‚                               â”‚
â”‚         â†“                                 â”‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     æ ‡æ³¨æœªé€šè¿‡          â”‚                               â”‚
â”‚  â”‚     Plan     â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚  â”‚  (è®¾è®¡æ–¹æ¡ˆ)   â”‚                                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                                        â”‚
â”‚         â”‚ æ ‡æ³¨é€šè¿‡                                                        â”‚
â”‚         â†“                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     Linterå¤±è´¥      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  Test-First  â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ Linterå¾ªç¯   â”‚                   â”‚
â”‚  â”‚  (å…ˆå†™æµ‹è¯•)   â”‚                    â”‚ (è‡ªæˆ‘ä¿®å¤)    â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚         â”‚ æµ‹è¯•éª¨æ¶å­˜åœ¨                                                    â”‚
â”‚         â†“                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     æµ‹è¯•å¤±è´¥       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚   Execute    â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  æµ‹è¯•å¾ªç¯     â”‚                    â”‚
â”‚  â”‚  (ç¼–å†™ä»£ç )   â”‚                   â”‚  (ä¿®å¤ä»£ç )   â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚         â”‚ æµ‹è¯•é€šè¿‡ + Linteré€šè¿‡                                           â”‚
â”‚         â†“                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     æ ‡æ³¨æœªé€šè¿‡                                          â”‚
â”‚  â”‚    Review    â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚
â”‚  â”‚  (ä»£ç å®¡æŸ¥)   â”‚                   â”‚                                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     Revertè§¦å‘    â”‚                                    â”‚
â”‚         â”‚ æ ‡æ³¨é€šè¿‡     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚         â†“              â”‚                        â”‚                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                        â”‚
â”‚  â”‚     Done     â”‚      â”‚  â”‚   Revert Manager â”‚ â”€â”´â”€â”€â†’ å›åˆ° Plan é˜¶æ®µ      â”‚
â”‚  â”‚  (ä»»åŠ¡å®Œæˆ)   â”‚      â”‚  â”‚   (æœæ–­å›æ»š)      â”‚                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                        â”‚         â†‘                                        â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€ Revert æ¡ä»¶è§¦å‘                      â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**äº”å¤§å¾ªç¯æœºåˆ¶æ±‡æ€»è¡¨**:

| å¾ªç¯ç±»å‹ | è§¦å‘é˜¶æ®µ | è§¦å‘æ¡ä»¶ | å¾ªç¯è¡Œä¸º | é€€å‡ºæ¡ä»¶ | å›åˆ°é˜¶æ®µ |
|---------|---------|---------|---------|---------|-----------|
| **Why-First å¾ªç¯** | Why-First | Agent æœ‰è¿½é—® | ç”¨æˆ·æ¾„æ¸…åç»§ç»­æé—® | ç”¨æˆ·æ¾„æ¸…å®Œæ¯• | Why-First |
| **æ ‡æ³¨å¾ªç¯** | Research/Plan/Execute | æœ‰ CRITICAL/MAJOR æ ‡æ³¨ pending | Agent ä¿®æ”¹ â†’ äººç±»ç¡®è®¤ | æ‰€æœ‰æ ‡æ³¨ addressed | å½“å‰é˜¶æ®µ |
| **Linter å¾ªç¯** | Execute | PreToolUse Linter å¤±è´¥ | é”™è¯¯å–‚å› â†’ Agent è‡ªæˆ‘ä¿®å¤ | Linter é€šè¿‡ | Execute |
| **æµ‹è¯•å¾ªç¯** | Execute | PostToolUse æµ‹è¯•å¤±è´¥ | Agent ä¿®å¤ä»£ç  | æµ‹è¯•é€šè¿‡ | Execute |
| **Revert å¾ªç¯** | Execute/Review | ä¸¥é‡é”™è¯¯/äººç±»æ ‡è®° [REVERT] | Git revert + å›æ»šçŠ¶æ€ | - | **Plan** |

**å¾ªç¯è¯¦ç»†è¯´æ˜**:

**1. Why-First å¾ªç¯** (ä»»åŠ¡å¼€å§‹å‰)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Why-First å¾ªç¯                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  ä»»åŠ¡å¼€å§‹                                                        â”‚
â”‚       â”‚                                                          â”‚
â”‚       â–¼                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 1. ä» project-why.md åŠ è½½ç›¸å…³å†å² Why                       â”‚ â”‚
â”‚  â”‚ 2. ç”Ÿæˆ 5-12 ä¸ªé’ˆå¯¹æ€§é—®é¢˜                                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚       â”‚                                                          â”‚
â”‚       â–¼                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚  â”‚ ç”¨æˆ·å›ç­”é—®é¢˜    â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚                        â”‚
â”‚           â”‚                            â”‚                        â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”                     â”‚                        â”‚
â”‚     â”‚           â”‚                     â”‚                        â”‚
â”‚   å…¨éƒ¨å›ç­”    æœ‰è¿½é—®                    â”‚                        â”‚
â”‚     â”‚           â”‚                     â”‚                        â”‚
â”‚     â–¼           â–¼                     â”‚                        â”‚
â”‚  æ›´æ–° project-why.md                  â”‚                        â”‚
â”‚     â”‚           Agent ä¸ç†è§£          â”‚                        â”‚
â”‚     â”‚           ç»§ç»­è¿½é—® â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚     â–¼                                                          â”‚
â”‚  è¿›å…¥ Research é˜¶æ®µ                                             â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**2. Linter å¾ªç¯** (Execute é˜¶æ®µ)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Linter è‡ªæˆ‘ä¿®å¤å¾ªç¯                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Agent è°ƒç”¨ Write/Edit                                          â”‚
â”‚       â”‚                                                          â”‚
â”‚       â–¼                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚  â”‚ PreToolUse Hook â”‚                                            â”‚
â”‚  â”‚   Linter æ£€æŸ¥   â”‚                                            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚           â”‚                                                      â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”                                               â”‚
â”‚     â”‚           â”‚                                               â”‚
â”‚   é€šè¿‡         å¤±è´¥                                              â”‚
â”‚     â”‚           â”‚                                               â”‚
â”‚     â–¼           â–¼                                               â”‚
â”‚  å†™å…¥æ–‡ä»¶    exit 2 é˜»å¡                                         â”‚
â”‚              + stderr é”™è¯¯æ¶ˆæ¯                                   â”‚
â”‚                 â”‚                                                â”‚
â”‚                 â–¼                                                â”‚
â”‚           é”™è¯¯å–‚å› Agent                                         â”‚
â”‚                 â”‚                                                â”‚
â”‚                 â–¼                                                â”‚
â”‚           Agent è¯»å–é”™è¯¯                                         â”‚
â”‚           Agent è‡ªæˆ‘ä¿®å¤                                         â”‚
â”‚                 â”‚                                                â”‚
â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ é‡æ–°è°ƒç”¨ Write/Edit (å¾ªç¯)          â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**3. æµ‹è¯•å¾ªç¯** (Execute é˜¶æ®µ)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æµ‹è¯•ä¿®å¤å¾ªç¯                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  ä»£ç å†™å…¥å®Œæˆ                                                    â”‚
â”‚       â”‚                                                          â”‚
â”‚       â–¼                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚  â”‚ PostToolUse Hookâ”‚                                            â”‚
â”‚  â”‚   è‡ªåŠ¨è·‘æµ‹è¯•    â”‚                                            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚           â”‚                                                      â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”                                               â”‚
â”‚     â”‚           â”‚                                               â”‚
â”‚   é€šè¿‡         å¤±è´¥                                              â”‚
â”‚     â”‚           â”‚                                               â”‚
â”‚     â–¼           â–¼                                               â”‚
â”‚  ç»§ç»­ä¸‹ä¸€     å†™å…¥ code_review.md                                â”‚
â”‚  ä¸ªä»»åŠ¡         â”‚                                                â”‚
â”‚                 â–¼                                                â”‚
â”‚           Agent è¯»å–å¤±è´¥åŸå›                                      â”‚
â”‚                 â”‚                                                â”‚
â”‚                 â–¼                                                â”‚
â”‚           Agent ä¿®å¤ä»£ç                                          â”‚
â”‚                 â”‚                                                â”‚
â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ é‡æ–°è·‘æµ‹è¯• (å¾ªç¯)                   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**4. Revert å¾ªç¯** (ä¸¥é‡é”™è¯¯æ—¶)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Revert æ‰§è¡Œæµç¨‹                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Step 1: æ£€æµ‹è§¦å‘                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ PostToolUse / Stop Hook / Validator Subagent               â”‚ â”‚
â”‚  â”‚ æ£€æµ‹åˆ°ä¸¥é‡é—®é¢˜ â†’ æ ‡è®° revert_pending = true                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚  Step 2: è¯„ä¼°ä¸¥é‡ç¨‹åº¦                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ severity = critical â†’ è‡ªåŠ¨ revert                          â”‚ â”‚
â”‚  â”‚ severity = high/medium â†’ è¯¢é—®äººç±»                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚  Step 3: æ‰§è¡Œ Git Revert                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ git revert HEAD --no-edit                                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚  Step 4: æ›´æ–°çŠ¶æ€                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ plan.md: status = needs_replan                              â”‚ â”‚
â”‚  â”‚ code_review.md: è®°å½• Revert åŸå›                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚  Step 5: å›åˆ° Plan é˜¶æ®µ                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ä¿ç•™ research.md (è°ƒç ”ç»“æœä»æœ‰æ•ˆ)                           â”‚ â”‚
â”‚  â”‚ åŒæ­¥æ•™è®­åˆ° project-why.md                                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Revert è§¦å‘æ¡ä»¶**:

| è§¦å‘æ¥æº | æ¡ä»¶ | ä¸¥é‡ç¨‹åº¦ | å¤„ç†æ–¹å¼ |
|----------|------|----------|----------|
| L3 ä¸šåŠ¡è§„åˆ™ | Protected Interface è¢«ä¿®æ”¹ | critical | **è‡ªåŠ¨ revert** |
| L3 ä¸šåŠ¡è§„åˆ™ | åˆ†å±‚æ¶æ„è¢«ç ´å | critical | **è‡ªåŠ¨ revert** |
| L4 å®‰å…¨æ£€æŸ¥ | SQL æ³¨å…¥ / XSS / ç¡¬ç¼–ç å¯†é’¥ | critical | **è‡ªåŠ¨ revert** |
| Validator Subagent | å‘ç°æ¶æ„å†²çª | high | è¯¢é—®äººç±»ç¡®è®¤ |
| äººç±» Review æ‰¹æ³¨ | åŒ…å« `[REVERT]` æ ‡è®° | - | **è‡ªåŠ¨ revert** |
| æµ‹è¯•ç»“æœ | æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•å¤±è´¥ > 30% | high | **è‡ªåŠ¨ revert** |

**Revert åçš„çŠ¶æ€å˜åŒ–**:

| ç»„ä»¶ | Revert å‰ | Revert å |
|------|-----------|-----------|
| Git | æœ‰é”™è¯¯ commit | å›åˆ°ä¸Šä¸€ä¸ªå¥åº· commit |
| plan.md | executing | needs_replan |
| code_review.md | in_review | åŒ…å« Revert è®°å½• |
| research.md | approved | approved (ä¸å˜) |
| ä»£ç æ–‡ä»¶ | æœ‰é—®é¢˜ä»£ç  | å›æ»šåˆ°å¥åº·çŠ¶æ€ |

**å…³é”®è®¾è®¡åŸåˆ™**:

1. **é˜¶æ®µå†…å¾ªç¯** (æ ‡æ³¨/Linter/æµ‹è¯•): åœ¨å½“å‰é˜¶æ®µå†…å¾ªç¯ï¼Œç›´åˆ°æ¡ä»¶æ»¡è¶³
2. **è·¨é˜¶æ®µå›é€€** (Revert): åªæœ‰ Revert ä¼šè·³å› Plan é˜¶æ®µ
3. **ä¿ç•™è°ƒç ”æˆæœ**: Revert å research.md ä¿æŒä¸å˜ï¼Œé¿å…é‡å¤è°ƒç ”
4. **æ•™è®­æ²‰æ·€**: æ¯æ¬¡ Revert éƒ½åŒæ­¥åˆ° project-why.mdï¼Œé¿å…é‡å¤çŠ¯é”™
5. **æœæ–­åŸåˆ™**: æ–¹å‘é”™äº†ç›´æ¥å›æ»šï¼Œæ¯”å¢é‡ patch æ›´çœ token

---

### 3.11 Task List Scanner

**å¯¹åº”éœ€æ±‚**: FR-020 `/nomos:list-tasks` å­å‘½ä»¤

**ç›®çš„**: å¿«é€Ÿåˆ—å‡ºæ‰€æœ‰ä»»åŠ¡åŠå…¶çŠ¶æ€ï¼Œæ”¯æŒé«˜æ•ˆçš„å¤šä»»åŠ¡ç®¡ç†ã€‚

**èŒè´£**:
- æ‰«æ tasks/ ç›®å½•ä¸‹æ‰€æœ‰ä»»åŠ¡æ–‡ä»¶å¤¹
- è¯»å–æ¯ä¸ªä»»åŠ¡çš„ YAML Frontmatter è·å–çŠ¶æ€
- æ”¯æŒ filter è¿‡æ»¤ï¼ˆæŒ‰çŠ¶æ€ã€æ—¥æœŸã€ç±»å‹ï¼‰
- è¾“å‡ºæ ¼å¼åŒ–çš„ä»»åŠ¡åˆ—è¡¨

**æ¥å£**:

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `/nomos:list-tasks` | åˆ—å‡ºæ‰€æœ‰ä»»åŠ¡ |
| `/nomos:list-tasks --status=executing` | åªæ˜¾ç¤ºæ‰§è¡Œä¸­çš„ä»»åŠ¡ |
| `/nomos:list-tasks --recent=7` | åªæ˜¾ç¤ºæœ€è¿‘ 7 å¤©çš„ä»»åŠ¡ |

**è¾“å‡ºæ ¼å¼**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“‹ Task List (å…± 5 ä¸ªä»»åŠ¡)                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  ğŸ”µ æ‰§è¡Œä¸­                                                           â”‚
â”‚  â”œâ”€â”€ t1-2026-02-25-user-login        [executing]   Phase 2/3       â”‚
â”‚  â””â”€â”€ t3-2026-02-24-payment-api       [executing]   Phase 1/2       â”‚
â”‚                                                                      â”‚
â”‚  ğŸŸ¡ ç­‰å¾…ä¸­                                                           â”‚
â”‚  â””â”€â”€ t2-2026-02-23-auth-refactor     [needs_replan] ç­‰å¾…é‡æ–°è§„åˆ’    â”‚
â”‚                                                                      â”‚
â”‚  âœ… å·²å®Œæˆ                                                           â”‚
â”‚  â”œâ”€â”€ t4-2026-02-20-logger-fix        [done]        PR #42          â”‚
â”‚  â””â”€â”€ t5-2026-02-18-db-migration      [archived]    2026-02-20      â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å®ç°é€»è¾‘**:

```python
# .claude/skills/nomos/list-tasks/SKILL.md è§¦å‘çš„é€»è¾‘

import os
import glob
from datetime import datetime

def list_tasks(filter_status=None, recent_days=None):
    """åˆ—å‡ºæ‰€æœ‰ä»»åŠ¡"""
    tasks = []

    # 1. æ‰«æ tasks/ ç›®å½•
    task_dirs = glob.glob("tasks/t*-*/")

    for task_dir in task_dirs:
        # 2. è¯»å– plan.md çš„ YAML Frontmatter
        plan_path = os.path.join(task_dir, "plan.md")
        if os.path.exists(plan_path):
            frontmatter = parse_yaml_frontmatter(plan_path)
            tasks.append({
                "id": extract_task_id(task_dir),
                "path": task_dir,
                "status": frontmatter.get("status", "unknown"),
                "created": frontmatter.get("created", ""),
                "pr_url": frontmatter.get("pr_url", ""),
            })

    # 3. è¿‡æ»¤
    if filter_status:
        tasks = [t for t in tasks if t["status"] == filter_status]

    if recent_days:
        cutoff = datetime.now() - timedelta(days=recent_days)
        tasks = [t for t in tasks if parse_date(t["created"]) > cutoff]

    # 4. æ’åºï¼šæ‰§è¡Œä¸­ > ç­‰å¾…ä¸­ > å·²å®Œæˆ
    status_order = {"executing": 0, "needs_replan": 1, "done": 2, "archived": 3}
    tasks.sort(key=lambda t: status_order.get(t["status"], 99))

    return tasks
```

**æ€§èƒ½ä¼˜åŒ–**: æ”¯æŒ task-cache.json ç¼“å­˜ï¼ˆè§ 3.17ï¼‰

---

### 3.12 Knowledge Intelligence Engine

**å¯¹åº”éœ€æ±‚**: FR-022 project-why.md æ™ºèƒ½ç»´æŠ¤ã€FR-119 Knowledge Similarity Detectorã€FR-120 Knowledge Merge

**ç›®çš„**: æ™ºèƒ½ç»´æŠ¤ project-why.mdï¼Œé¿å…çŸ¥è¯†å†—ä½™ï¼Œæå‡çŸ¥è¯†è´¨é‡ã€‚

**èŒè´£**:
- **ç›¸ä¼¼æ£€æµ‹**: æ£€æµ‹æ–°å¢å†…å®¹ä¸å·²æœ‰çŸ¥è¯†çš„ç›¸ä¼¼åº¦
- **çŸ¥è¯†åˆå¹¶**: å°†ç›¸ä¼¼å†…å®¹æ•´åˆï¼Œä¸ç”¨æˆ·ç¡®è®¤
- **çŸ¥è¯†å¢å¼º**: æ·±åŒ–å·²æœ‰ç†è§£ï¼Œè¡¥å……ç»†èŠ‚
- **å»é‡æ¸…ç†**: å®šæœŸæ¸…ç†é‡å¤æˆ–è¿‡æ—¶çš„çŸ¥è¯†æ¡ç›®

#### 3.12.1 ç›¸ä¼¼æ£€æµ‹ç®—æ³•

```python
def detect_similarity(new_content: str, existing_knowledge: list) -> list:
    """
    æ£€æµ‹æ–°å†…å®¹ä¸å·²æœ‰çŸ¥è¯†çš„ç›¸ä¼¼åº¦

    Returns:
        [
            {"id": "WHY-001", "similarity": 0.85, "action": "merge"},
            {"id": "WHY-002", "similarity": 0.42, "action": "skip"},
        ]
    """
    results = []

    for entry in existing_knowledge:
        # 1. å…³é”®è¯é‡å åº¦
        keyword_score = calculate_keyword_overlap(
            extract_keywords(new_content),
            extract_keywords(entry["content"])
        )

        # 2. è¯­ä¹‰ç›¸ä¼¼åº¦ï¼ˆåŸºäº embeddingï¼‰
        semantic_score = calculate_semantic_similarity(
            new_content,
            entry["content"]
        )

        # 3. ç»¼åˆè¯„åˆ†
        similarity = 0.4 * keyword_score + 0.6 * semantic_score

        # 4. å†³å®šè¡ŒåŠ¨
        if similarity > 0.8:
            action = "merge"      # é«˜ç›¸ä¼¼ï¼Œå»ºè®®åˆå¹¶
        elif similarity > 0.5:
            action = "enhance"    # ä¸­ç­‰ç›¸ä¼¼ï¼Œå»ºè®®å¢å¼º
        else:
            action = "skip"       # ä½ç›¸ä¼¼ï¼Œç‹¬ç«‹æ–°å¢

        results.append({
            "id": entry["id"],
            "similarity": similarity,
            "action": action
        })

    return sorted(results, key=lambda x: x["similarity"], reverse=True)
```

#### 3.12.2 çŸ¥è¯†åˆå¹¶æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      çŸ¥è¯†åˆå¹¶æµç¨‹                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  Step 1: Agent å‡†å¤‡æ›´æ–° project-why.md                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Agent å®Œæˆä»»åŠ¡ï¼Œå‡†å¤‡å°†æ–°çŸ¥è¯†å†™å…¥ project-why.md                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 2: è§¦å‘ç›¸ä¼¼æ£€æµ‹                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Knowledge Intelligence Engine æ£€æµ‹æ–°å†…å®¹ä¸å·²æœ‰æ¡ç›®çš„ç›¸ä¼¼åº¦       â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ æ£€æµ‹ç»“æœ:                                                       â”‚ â”‚
â”‚  â”‚ - WHY-015 "è®¤è¯æµç¨‹" ç›¸ä¼¼åº¦ 0.87 â†’ merge                        â”‚ â”‚
â”‚  â”‚ - WHY-023 "é”™è¯¯å¤„ç†" ç›¸ä¼¼åº¦ 0.52 â†’ enhance                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 3: ç”Ÿæˆåˆå¹¶å»ºè®®                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ”” æ£€æµ‹åˆ°ç›¸ä¼¼çŸ¥è¯†ï¼Œå»ºè®®åˆå¹¶ï¼š                                    â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ WHY-015 "è®¤è¯æµç¨‹" (ç›¸ä¼¼åº¦ 87%)                                  â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚ â”‚ å·²æœ‰: ç”¨æˆ·ç™»å½•éœ€è¦éªŒè¯æ‰‹æœºå·å’ŒéªŒè¯ç                         â”‚ â”‚ â”‚
â”‚  â”‚ â”‚ æ–°å¢: å¾®ä¿¡ç™»å½•éœ€è¦éªŒè¯ openid å’Œ access_token              â”‚ â”‚ â”‚
â”‚  â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚ â”‚
â”‚  â”‚ â”‚ åˆå¹¶: ç”¨æˆ·è®¤è¯æ”¯æŒå¤šç§æ–¹å¼ï¼šæ‰‹æœºå·+éªŒè¯ç ã€å¾®ä¿¡ OAuthã€‚     â”‚ â”‚ â”‚
â”‚  â”‚ â”‚       éœ€è¦éªŒè¯çš„å…³é”®ä¿¡æ¯ï¼šphone/code æˆ– openid/token        â”‚ â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ [ç¡®è®¤åˆå¹¶] [ä¿æŒç‹¬ç«‹] [æ‰‹åŠ¨ç¼–è¾‘]                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 4: æ‰§è¡Œåˆå¹¶                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ç”¨æˆ·ç¡®è®¤åï¼š                                                     â”‚ â”‚
â”‚  â”‚ - åˆ é™¤ WHY-015 åŸæ¡ç›®                                           â”‚ â”‚
â”‚  â”‚ - å†™å…¥åˆå¹¶åçš„æ–°æ¡ç›®                                             â”‚ â”‚
â”‚  â”‚ - è®°å½•åˆå¹¶å†å²åˆ° metadata                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.12.3 çŸ¥è¯†å¢å¼ºæ¨¡å¼

å½“æ£€æµ‹åˆ°ä¸­ç­‰ç›¸ä¼¼åº¦ï¼ˆ0.5-0.8ï¼‰æ—¶ï¼Œä¸åˆå¹¶è€Œæ˜¯å¢å¼ºï¼š

```markdown
### WHY-023: é”™è¯¯å¤„ç†è§„èŒƒ

<!-- åŸæœ‰å†…å®¹ -->
> æ‰€æœ‰çš„ API é”™è¯¯å¿…é¡»è¿”å›æ ‡å‡†æ ¼å¼ï¼š{code, message, details}

<!-- å¢å¼ºå†…å®¹ (2026-02-25) -->
> è¡¥å……ï¼šå¾®ä¿¡ç›¸å…³é”™è¯¯éœ€è¦é¢å¤–è¿”å› errcode å’Œ errmsg å­—æ®µï¼Œ
> ä¾¿äºå¯¹æ¥å¾®ä¿¡å®˜æ–¹æ–‡æ¡£æ’æŸ¥é—®é¢˜ã€‚
> å‚è€ƒï¼šGate 1.4 å¾®ä¿¡æˆæƒè¾¹ç•Œå¤„ç†
```

#### 3.12.4 project-why.md å…ƒæ•°æ®ç»“æ„

```yaml
---
# project-why.md YAML Frontmatter
version: 12
last_updated: 2026-02-25T14:30:00
total_entries: 28
merge_history:
  - date: 2026-02-25
    merged_from: [WHY-015, WHY-016]
    merged_to: WHY-015
    reason: "è®¤è¯æµç¨‹ç›¸å…³ï¼Œåˆå¹¶åæ›´å®Œæ•´"
  - date: 2026-02-20
    merged_from: [WHY-008, WHY-011]
    merged_to: WHY-008
    reason: "éƒ½æ˜¯å…³äºæ•°æ®åº“äº‹åŠ¡çš„å¤„ç†"
---

## 1. ä¸šåŠ¡ç†è§£

### WHY-001: ç”¨æˆ·è®¤è¯æµç¨‹ {#why-001}
> åˆ›å»º: 2026-02-15
> æ›´æ–°: 2026-02-25 (åˆå¹¶ WHY-016)
> æ¥æº: t1-2026-02-25-user-login

ç”¨æˆ·è®¤è¯æ”¯æŒå¤šç§æ–¹å¼ï¼šæ‰‹æœºå·+éªŒè¯ç ã€å¾®ä¿¡ OAuthã€‚
éœ€è¦éªŒè¯çš„å…³é”®ä¿¡æ¯ï¼šphone/code æˆ– openid/tokenã€‚

**å¤±è´¥æ•™è®­**:
- ä¸è¦åœ¨ session ä¸­å­˜å‚¨æ•æ„Ÿä¿¡æ¯ (æ¥è‡ª t5-2026-02-10)
```

---

### 3.13 Tree-sitter Multi-language Parser

**å¯¹åº”éœ€æ±‚**: FR-101 Tree-sitter å¤šè¯­è¨€ AST è§£æ

**ç›®çš„**: æä¾›ç»Ÿä¸€çš„å¤šè¯­è¨€ AST è§£æèƒ½åŠ›ï¼Œæ”¯æŒè·¨è¯­è¨€çš„ä»£ç åˆ†æã€‚

**èŒè´£**:
- è§£æå¤šç§ç¼–ç¨‹è¯­è¨€çš„ AST
- æå–å‡½æ•°/ç±»/å˜é‡å®šä¹‰
- æ£€æµ‹ Protected Interface å˜æ›´
- æ”¯æŒè·¨æ–‡ä»¶å¼•ç”¨åˆ†æ

#### 3.13.1 æ”¯æŒçš„è¯­è¨€

| è¯­è¨€ | Tree-sitter Grammar | ä¸»è¦ç”¨é€” |
|------|---------------------|---------|
| Python | tree-sitter-python | å‡½æ•°ç­¾åã€ç±»ç»“æ„ã€å¯¼å…¥åˆ†æ |
| JavaScript | tree-sitter-javascript | å‡½æ•°ç­¾åã€å¯¹è±¡ç»“æ„ |
| TypeScript | tree-sitter-typescript | ç±»å‹å®šä¹‰ã€æ¥å£ç­¾å |
| Go | tree-sitter-go | å‡½æ•°ç­¾åã€ç»“æ„ä½“å®šä¹‰ |
| Java | tree-sitter-java | ç±»ç­¾åã€æ–¹æ³•ç­¾å |
| Rust | tree-sitter-rust | å‡½æ•°ç­¾åã€trait å®šä¹‰ |

#### 3.13.2 ç»Ÿä¸€ AST æ¥å£

```python
from abc import ABC, abstractmethod
from dataclasses import dataclass
from typing import List, Optional

@dataclass
class FunctionSignature:
    """ç»Ÿä¸€çš„å‡½æ•°ç­¾åç»“æ„"""
    name: str
    parameters: List[dict]  # [{"name": "x", "type": "int"}, ...]
    return_type: Optional[str]
    decorators: List[str]
    visibility: str  # public/private/protected
    source_file: str
    line_start: int
    line_end: int

class LanguageParser(ABC):
    """è¯­è¨€è§£æå™¨åŸºç±»"""

    @abstractmethod
    def parse_file(self, file_path: str) -> dict:
        """è§£ææ–‡ä»¶ï¼Œè¿”å› AST"""
        pass

    @abstractmethod
    def extract_functions(self, ast: dict) -> List[FunctionSignature]:
        """æå–æ‰€æœ‰å‡½æ•°å®šä¹‰"""
        pass

    @abstractmethod
    def extract_classes(self, ast: dict) -> List[dict]:
        """æå–æ‰€æœ‰ç±»å®šä¹‰"""
        pass

    @abstractmethod
    def extract_imports(self, ast: dict) -> List[str]:
        """æå–æ‰€æœ‰å¯¼å…¥"""
        pass

    @abstractmethod
    def detect_interface_change(self, old_ast: dict, new_ast: dict) -> List[dict]:
        """æ£€æµ‹æ¥å£å˜æ›´"""
        pass
```

#### 3.13.3 Python è§£æå™¨ç¤ºä¾‹

```python
import tree_sitter_python as tspython
from tree_sitter import Language, Parser

class PythonParser(LanguageParser):
    def __init__(self):
        self.parser = Parser(Language(tspython.language()))

    def extract_functions(self, ast: dict) -> List[FunctionSignature]:
        functions = []

        # æŸ¥è¯¢æ‰€æœ‰å‡½æ•°å®šä¹‰
        query = self.language.query("""
            (function_definition
                name: (identifier) @name
                parameters: (parameters) @params
                return_type: (type)? @return_type
            ) @func
        """)

        for match in query.captures(ast.root_node):
            func_node = match[0]
            functions.append(FunctionSignature(
                name=self._extract_name(func_node),
                parameters=self._extract_params(func_node),
                return_type=self._extract_return_type(func_node),
                decorators=self._extract_decorators(func_node),
                visibility="public",  # Python é»˜è®¤ public
                source_file=ast.file_path,
                line_start=func_node.start_point[0],
                line_end=func_node.end_point[0]
            ))

        return functions

    def detect_interface_change(self, old_ast: dict, new_ast: dict) -> List[dict]:
        """æ£€æµ‹æ¥å£å˜æ›´"""
        changes = []

        old_funcs = {f.name: f for f in self.extract_functions(old_ast)}
        new_funcs = {f.name: f for f in self.extract_functions(new_ast)}

        # æ£€æµ‹åˆ é™¤çš„å‡½æ•°
        for name in old_funcs:
            if name not in new_funcs:
                changes.append({
                    "type": "function_removed",
                    "name": name,
                    "severity": "critical"
                })

        # æ£€æµ‹ç­¾åå˜æ›´
        for name, new_func in new_funcs.items():
            if name in old_funcs:
                old_func = old_funcs[name]
                if old_func.parameters != new_func.parameters:
                    changes.append({
                        "type": "signature_changed",
                        "name": name,
                        "old": old_func.parameters,
                        "new": new_func.parameters,
                        "severity": "major"
                    })

        return changes
```

#### 3.13.4 ä¸ Protected Interface é›†æˆ

```python
def check_protected_interface_violation(file_path: str, protected_interfaces: list):
    """æ£€æŸ¥æ˜¯å¦è¿å Protected Interface"""
    parser = get_parser_for_file(file_path)
    ast = parser.parse_file(file_path)

    for interface in protected_interfaces:
        # interface æ ¼å¼: "src/auth/service.py::AuthService.login()"
        interface_file, interface_signature = interface.split("::")

        if file_path.endswith(interface_file):
            changes = parser.detect_interface_change(
                get_cached_ast(interface_file),
                ast
            )

            for change in changes:
                if interface_signature in change.get("name", ""):
                    return {
                        "violated": True,
                        "interface": interface,
                        "change": change
                    }

    return {"violated": False}
```

---

### 3.14 Code Reviewer Subagent

**å¯¹åº”éœ€æ±‚**: FR-105 Code Reviewer Subagent

**ç›®çš„**: è‡ªåŠ¨åŒ–ä»£ç å®¡æŸ¥ï¼Œç”Ÿæˆç»“æ„åŒ–çš„ code_review.mdã€‚

**èŒè´£**:
- è¯»å– plan.md å’Œå·²ç”Ÿæˆçš„ä»£ç 
- æ‰§è¡Œä»£ç è´¨é‡æ£€æŸ¥
- è¿è¡Œæµ‹è¯•å¹¶æ”¶é›†è¦†ç›–ç‡
- ç”Ÿæˆ code_review.md

#### 3.14.1 ä¸ Validator Subagent çš„åŒºåˆ«

| ç»´åº¦ | Validator Subagent | Code Reviewer Subagent |
|------|-------------------|------------------------|
| **è§¦å‘æ—¶æœº** | Plan é˜¶æ®µå®Œæˆå | Execute é˜¶æ®µå®Œæˆå |
| **å®¡æŸ¥å¯¹è±¡** | plan.mdï¼ˆè®¾è®¡æ–‡æ¡£ï¼‰ | å®é™…ä»£ç  + æµ‹è¯• |
| **å®¡æŸ¥æ–¹å¼** | åªè¯»å®¡æŸ¥ + å†™ Review Comments | æ‰§è¡Œ Linter + è¿è¡Œæµ‹è¯• |
| **è¾“å‡º** | plan.md çš„ Review Comments | code_review.md å®Œæ•´æŠ¥å‘Š |
| **é˜»å¡çº§åˆ«** | é«˜ï¼ˆè®¾è®¡é—®é¢˜å¿…é¡»å…ˆè§£å†³ï¼‰ | é«˜ï¼ˆä»£ç é—®é¢˜å¿…é¡»å…ˆè§£å†³ï¼‰ |

#### 3.14.2 å®¡æŸ¥æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Code Reviewer Subagent æµç¨‹                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  Step 1: è§¦å‘                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ è§¦å‘æ¡ä»¶:                                                       â”‚ â”‚
â”‚  â”‚ - æ‰€æœ‰ Phase Gates ä»£ç å·²ç”Ÿæˆ                                   â”‚ â”‚
â”‚  â”‚ - æˆ–æ‰‹åŠ¨è§¦å‘ /nomos:review                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 2: æ”¶é›†ä¿¡æ¯                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ è¯»å–:                                                           â”‚ â”‚
â”‚  â”‚ - plan.md: Phase Gates åˆ—è¡¨ã€éªŒæ”¶æ ‡å‡†                           â”‚ â”‚
â”‚  â”‚ - å˜æ›´æ–‡ä»¶åˆ—è¡¨: git diff --name-only                            â”‚ â”‚
â”‚  â”‚ - ä»£ç å†…å®¹: æ‰€æœ‰å˜æ›´çš„æ–‡ä»¶                                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 3: æ‰§è¡Œæ£€æŸ¥                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 1. ä¸‰å±‚ Linter æ£€æŸ¥ â†’ è®°å½•é”™è¯¯/è­¦å‘Š                              â”‚ â”‚
â”‚  â”‚ 2. è¿è¡Œæµ‹è¯• â†’ è®°å½•é€šè¿‡ç‡/è¦†ç›–ç‡                                  â”‚ â”‚
â”‚  â”‚ 3. ä»£ç å¤æ‚åº¦åˆ†æ â†’ æ ‡è®°é«˜é£é™©æ–‡ä»¶                               â”‚ â”‚
â”‚  â”‚ 4. ä¸ plan.md å¯¹ç…§ â†’ æ£€æŸ¥æ˜¯å¦é—æ¼ Gate                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 4: ç”ŸæˆæŠ¥å‘Š                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ç”Ÿæˆ code_review.md:                                            â”‚ â”‚
â”‚  â”‚ - ç¬¬ 1 èŠ‚: Linter ç»“æœ                                          â”‚ â”‚
â”‚  â”‚ - ç¬¬ 2 èŠ‚: æµ‹è¯•ç»“æœ                                              â”‚ â”‚
â”‚  â”‚ - ç¬¬ 3 èŠ‚: æ–‡ä»¶å˜æ›´åˆ—è¡¨                                          â”‚ â”‚
â”‚  â”‚ - ç¬¬ 4 èŠ‚: Review Comments (è‡ªåŠ¨ç”Ÿæˆ + äººç±»è¿½åŠ )                 â”‚ â”‚
â”‚  â”‚ - ç¬¬ 5 èŠ‚: è¦†ç›–ç‡æŠ¥å‘Š                                            â”‚ â”‚
â”‚  â”‚ - ç¬¬ 6 èŠ‚: Revert è®°å½• (å¦‚æœ‰)                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 5: é˜»å¡åˆ¤æ–­                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ å¦‚æœå­˜åœ¨:                                                       â”‚ â”‚
â”‚  â”‚ - Linter é”™è¯¯ > 0                                               â”‚ â”‚
â”‚  â”‚ - æµ‹è¯•å¤±è´¥ > 0                                                  â”‚ â”‚
â”‚  â”‚ - è¦†ç›–ç‡ < 80%                                                  â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ â†’ é˜»å¡ï¼Œè¿”å›é”™è¯¯è®© Agent ä¿®å¤                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.14.3 è‡ªåŠ¨ç”Ÿæˆçš„ Review Comments

Code Reviewer Subagent ä¼šæ ¹æ®æ£€æŸ¥ç»“æœè‡ªåŠ¨ç”Ÿæˆ Review Commentsï¼š

```markdown
## 4. Review Comments

### RC-AUTO-1: æµ‹è¯•è¦†ç›–ç‡ä¸è¶³
> ä½ç½®: å…¨å±€
> åˆ›å»ºæ—¶é—´: 2026-02-25 15:30
> ä¸¥é‡ç¨‹åº¦: [MAJOR]
> çŠ¶æ€: [ ] pending
> æ¥æº: Code Reviewer Subagent (è‡ªåŠ¨ç”Ÿæˆ)

å½“å‰æµ‹è¯•è¦†ç›–ç‡ 72%ï¼Œä½äºç›®æ ‡ 80%ã€‚
å»ºè®®è¡¥å……ä»¥ä¸‹æµ‹è¯•ï¼š
- `test_wechat_login_timeout`: å¾®ä¿¡ç™»å½•è¶…æ—¶åœºæ™¯
- `test_wechat_login_cancelled`: ç”¨æˆ·å–æ¶ˆæˆæƒåœºæ™¯

### RC-AUTO-2: å¤æ‚åº¦è­¦å‘Š
> ä½ç½®: src/auth/service.py:45
> åˆ›å»ºæ—¶é—´: 2026-02-25 15:30
> ä¸¥é‡ç¨‹åº¦: [MINOR]
> çŠ¶æ€: [ ] pending
> æ¥æº: Code Reviewer Subagent (è‡ªåŠ¨ç”Ÿæˆ)

å‡½æ•° `process_wechat_callback` åœˆå¤æ‚åº¦ 12ï¼Œå»ºè®®æ‹†åˆ†ã€‚
```

---

### 3.15 Task Archive Manager

**å¯¹åº”éœ€æ±‚**: FR-106 ä»»åŠ¡å½’æ¡£

**ç›®çš„**: è‡ªåŠ¨åŒ–ç®¡ç†å·²å®Œæˆä»»åŠ¡çš„å½’æ¡£ï¼Œä¿æŒ tasks/ ç›®å½•æ•´æ´ã€‚

**èŒè´£**:
- æ£€æµ‹ä»»åŠ¡å®ŒæˆçŠ¶æ€
- ç§»åŠ¨å·²å®Œæˆä»»åŠ¡åˆ° archive/
- ç»´æŠ¤ short-id-mapping.json
- æ”¯æŒå½’æ¡£ä»»åŠ¡æŸ¥è¯¢

#### 3.15.1 å½’æ¡£è§¦å‘æ¡ä»¶

| æ¡ä»¶ | è¯´æ˜ |
|------|------|
| `status: done` | ä»»åŠ¡å·²å®Œæˆï¼ŒPR å·²åˆå¹¶ |
| `pr_url` å­˜åœ¨ | æœ‰å¯¹åº”çš„ PR é“¾æ¥ |
| æ— æœªæäº¤æ›´æ”¹ | å·¥ä½œåŒºå¹²å‡€ |

#### 3.15.2 å½’æ¡£æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ä»»åŠ¡å½’æ¡£æµç¨‹                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  Step 1: æ£€æµ‹å®ŒæˆçŠ¶æ€                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Stop Hook æˆ– /nomos:archive è§¦å‘æ£€æŸ¥                       â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ æ£€æŸ¥:                                                           â”‚ â”‚
â”‚  â”‚ - plan.md status == "done"                                      â”‚ â”‚
â”‚  â”‚ - plan.md pr_url å­˜åœ¨                                           â”‚ â”‚
â”‚  â”‚ - git status --porcelain ä¸ºç©º                                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 2: æ‰§è¡Œå½’æ¡£                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ # åˆ›å»ºå½’æ¡£ç›®å½•ï¼ˆæŒ‰å¹´æœˆç»„ç»‡ï¼‰                                     â”‚ â”‚
â”‚  â”‚ mkdir -p tasks/archive/2026-02/                                 â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ # ç§»åŠ¨ä»»åŠ¡æ–‡ä»¶å¤¹                                                 â”‚ â”‚
â”‚  â”‚ mv tasks/t1-2026-02-25-user-login tasks/archive/2026-02/        â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ # æ›´æ–°æ˜ å°„æ–‡ä»¶                                                   â”‚ â”‚
â”‚  â”‚ æ›´æ–° short-id-mapping.json                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 3: æ›´æ–°ç´¢å¼•                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ # short-id-mapping.json                                         â”‚ â”‚
â”‚  â”‚ {                                                               â”‚ â”‚
â”‚  â”‚   "t1": {                                                       â”‚ â”‚
â”‚  â”‚     "path": "tasks/archive/2026-02/t1-2026-02-25-user-login",   â”‚ â”‚
â”‚  â”‚     "status": "archived",                                       â”‚ â”‚
â”‚  â”‚     "archived_at": "2026-02-26T10:00:00"                        â”‚ â”‚
â”‚  â”‚   }                                                             â”‚ â”‚
â”‚  â”‚ }                                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  Step 4: æ¸…ç†å¼•ç”¨                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ - å¦‚æœæ˜¯å½“å‰ä»»åŠ¡ï¼Œæ¸…ç©º current-task.txt                         â”‚ â”‚
â”‚  â”‚ - ä» task-cache.json ç§»é™¤                                       â”‚ â”‚
â”‚  â”‚ - è®°å½•å½’æ¡£æ—¥å¿—                                                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.15.3 å½’æ¡£ç›®å½•ç»“æ„

```
tasks/
â”œâ”€â”€ t2-2026-02-24-payment-api/     # æ‰§è¡Œä¸­
â”œâ”€â”€ t3-2026-02-26-notification/    # æ‰§è¡Œä¸­
â”œâ”€â”€ archive/
â”‚   â”œâ”€â”€ 2026-01/                   # æŒ‰æœˆå½’æ¡£
â”‚   â”‚   â”œâ”€â”€ t1-2026-01-15-logger/
â”‚   â”‚   â””â”€â”€ t2-2026-01-20-config/
â”‚   â””â”€â”€ 2026-02/
â”‚       â”œâ”€â”€ t1-2026-02-25-user-login/
â”‚       â””â”€â”€ t4-2026-02-10-db-fix/
â””â”€â”€ short-id-mapping.json
```

---

### 3.16 Layer 3 Rule Templates

**å¯¹åº”éœ€æ±‚**: FR-107 ç¬¬ä¸‰å±‚è§„åˆ™ç¤ºä¾‹æ¨¡æ¿

**ç›®çš„**: æä¾›å¼€ç®±å³ç”¨çš„ä¸šåŠ¡è§„åˆ™æ¨¡æ¿ï¼Œé™ä½è‡ªå®šä¹‰è§„åˆ™çš„å¼€å‘æˆæœ¬ã€‚

#### 3.16.1 å†…ç½®è§„åˆ™æ¨¡æ¿

| æ¨¡æ¿åç§° | ç”¨é€” | è§¦å‘æ¡ä»¶ |
|---------|------|---------|
| `module-isolation` | æ¨¡å—éš”ç¦»æ£€æŸ¥ | è·¨æ¨¡å— import |
| `i18n-force-customt` | å¼ºåˆ¶ä½¿ç”¨ customT() | å­—ç¬¦ä¸²ç¡¬ç¼–ç  |
| `trace-id-propagation` | trace_id ä¼ é€’æ£€æŸ¥ | API è°ƒç”¨ |
| `protected-interface` | æ¥å£ä¿æŠ¤ | å‡½æ•°ç­¾åå˜æ›´ |
| `no-hardcoded-secret` | ç¦æ­¢ç¡¬ç¼–ç å¯†é’¥ | å­—ç¬¦ä¸²åŒ¹é… |
| `tenant-isolation` | å¤šç§Ÿæˆ·éš”ç¦» | æ•°æ®åº“æŸ¥è¯¢ |
| `api-version-prefix` | API ç‰ˆæœ¬å‰ç¼€ | è·¯ç”±å®šä¹‰ |

#### 3.16.2 è§„åˆ™æ¨¡æ¿ç»“æ„

```python
# .claude/rules/templates/module_isolation.py

"""
è§„åˆ™æ¨¡æ¿: æ¨¡å—éš”ç¦»æ£€æŸ¥
ç”¨é€”: ç¡®ä¿æ¨¡å—é—´ä¸ç›´æ¥ä¾èµ–å†…éƒ¨å®ç°
"""

from dataclasses import dataclass
from typing import List

@dataclass
class ModuleIsolationConfig:
    """é…ç½®é¡¹"""
    # å®šä¹‰æ¨¡å—è¾¹ç•Œ
    modules: dict = {
        "auth": ["src/auth/**", "src/api/auth/**"],
        "payment": ["src/payment/**", "src/api/payment/**"],
        "notification": ["src/notification/**"],
    }

    # å…è®¸çš„è·¨æ¨¡å—è®¿é—®ï¼ˆç™½åå•ï¼‰
    allowed_imports: dict = {
        "auth": ["src/common/**", "src/models/**"],
        "payment": ["src/common/**", "src/models/**", "src/auth/public/**"],
    }

    # ä¸¥é‡ç¨‹åº¦
    severity: str = "major"


class ModuleIsolationRule(BaseRule):
    """æ¨¡å—éš”ç¦»è§„åˆ™"""

    def __init__(self, config: ModuleIsolationConfig = None):
        self.config = config or ModuleIsolationConfig()

    def check(self, file_path: str, content: str) -> RuleResult:
        """æ£€æŸ¥æ¨¡å—éš”ç¦»"""
        violations = []

        # 1. ç¡®å®šæ–‡ä»¶æ‰€å±æ¨¡å—
        source_module = self._get_module(file_path)
        if not source_module:
            return RuleResult(passed=True)  # ä¸åœ¨å®šä¹‰çš„æ¨¡å—å†…

        # 2. æå–æ‰€æœ‰ import
        imports = self._extract_imports(content)

        # 3. æ£€æŸ¥æ¯ä¸ª import æ˜¯å¦è¿åéš”ç¦»
        for imp in imports:
            target_module = self._get_module(imp)
            if target_module and target_module != source_module:
                # æ£€æŸ¥æ˜¯å¦åœ¨ç™½åå•
                if not self._is_allowed(source_module, imp):
                    violations.append({
                        "line": imp.line,
                        "message": f"è·¨æ¨¡å—è®¿é—®: {source_module} â†’ {target_module}",
                        "suggestion": f"ä½¿ç”¨ {target_module} çš„å…¬å…±æ¥å£ï¼Œæˆ–æ·»åŠ åˆ° allowed_imports"
                    })

        return RuleResult(
            passed=len(violations) == 0,
            violations=violations
        )
```

#### 3.16.3 è§„åˆ™æ¨¡æ¿ä½¿ç”¨æ–¹å¼

```yaml
# .claude/rules/layer3.yml
templates:
  # å¼•ç”¨å†…ç½®æ¨¡æ¿
  - name: module-isolation
    enabled: true
    config:
      severity: major

  - name: i18n-force-customt
    enabled: true
    config:
      severity: error
      i18n_function: "customT"

  # è‡ªå®šä¹‰è§„åˆ™
  - name: custom-tenant-check
    handler: "./custom_rules/tenant_check.py"
    config:
      severity: critical
```

---

### 3.17 Task Cache

**å¯¹åº”éœ€æ±‚**: FR-117 ä»»åŠ¡ç¼“å­˜

**ç›®çš„**: åŠ é€Ÿä»»åŠ¡åˆ—è¡¨æŸ¥è¯¢å’ŒçŠ¶æ€æ£€æŸ¥ï¼Œé¿å…é¢‘ç¹è¯»å–æ–‡ä»¶ç³»ç»Ÿã€‚

**èŒè´£**:
- ç¼“å­˜ä»»åŠ¡å…ƒæ•°æ®
- å¢é‡æ›´æ–°ç¼“å­˜
- æä¾›å¿«é€ŸæŸ¥è¯¢æ¥å£

#### 3.17.1 ç¼“å­˜ç»“æ„

```json
// tasks/task-cache.json
{
  "version": 1,
  "last_updated": "2026-02-25T16:00:00",
  "tasks": {
    "t1-2026-02-25-user-login": {
      "status": "executing",
      "phase": 2,
      "total_phases": 3,
      "gates_completed": 4,
      "gates_total": 6,
      "created": "2026-02-25T10:00:00",
      "last_modified": "2026-02-25T15:30:00",
      "branch": "feat/2026-02-25-user-login",
      "has_pending_annotations": true,
      "test_coverage": 72
    },
    "t2-2026-02-24-payment-api": {
      "status": "executing",
      "phase": 1,
      "total_phases": 2,
      "gates_completed": 2,
      "gates_total": 4,
      "created": "2026-02-24T09:00:00",
      "last_modified": "2026-02-25T14:00:00",
      "branch": "feat/2026-02-24-payment-api",
      "has_pending_annotations": false,
      "test_coverage": 85
    }
  }
}
```

#### 3.17.2 ç¼“å­˜æ›´æ–°ç­–ç•¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç¼“å­˜æ›´æ–°ç­–ç•¥                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  è§¦å‘æ›´æ–°çš„æ—¶æœº:                                                     â”‚
â”‚                                                                      â”‚
â”‚  1. PostToolUse Hook                                                â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚     â”‚ æ£€æµ‹åˆ° Write/Edit plan.md â†’ æ›´æ–°è¯¥ä»»åŠ¡çš„ç¼“å­˜                 â”‚ â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â”‚  2. Git æ“ä½œå                                                       â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚     â”‚ commit / branch switch â†’ æ›´æ–°ç›¸å…³ä»»åŠ¡çš„ last_modified       â”‚ â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â”‚  3. å®šæœŸåˆ·æ–°ï¼ˆå¯é€‰ï¼‰                                                 â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚     â”‚ æ¯ 5 åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡ï¼ŒåŒæ­¥æ–‡ä»¶ç³»ç»ŸçŠ¶æ€                           â”‚ â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â”‚  4. å¼ºåˆ¶åˆ·æ–°                                                         â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚     â”‚ /nomos:list-tasks --refresh                            â”‚ â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.17.3 ç¼“å­˜è¯»å–ä¼˜å…ˆçº§

```python
def get_task_list(use_cache=True):
    """è·å–ä»»åŠ¡åˆ—è¡¨"""
    if use_cache:
        cache = load_cache()
        if cache.is_valid():
            return cache.tasks

    # ç¼“å­˜æ— æ•ˆæˆ–å¼ºåˆ¶åˆ·æ–°ï¼Œä»æ–‡ä»¶ç³»ç»Ÿè¯»å–
    tasks = scan_tasks_from_filesystem()
    update_cache(tasks)
    return tasks


def load_cache():
    """åŠ è½½ç¼“å­˜"""
    cache_path = "tasks/task-cache.json"
    if os.path.exists(cache_path):
        with open(cache_path) as f:
            return TaskCache.from_json(f.read())
    return TaskCache.empty()
```

---

### 3.18 Future Extensions (P2 Requirements)

**å¯¹åº”éœ€æ±‚**: FR-201 YAML é…ç½®ã€FR-202 å¢é‡ Linterã€FR-203 è¯¯æŠ¥è¦†ç›–ã€FR-204 è·¨æ–‡ä»¶ä¾èµ–

è¿™äº› P2 ä¼˜å…ˆçº§éœ€æ±‚åœ¨ Open Questions ä¸­å·²æœ‰æ–¹å‘æ€§è®¾è®¡ï¼Œæ­¤å¤„ä»…ä½œç®€è¦è¯´æ˜ï¼Œå¾…åç»­è¿­ä»£å®ç°ã€‚

#### 3.18.1 FR-201: YAML é…ç½®æ–‡ä»¶

è¯¦è§ PRD Q1 çš„è®¾è®¡æ–¹æ¡ˆï¼šå£°æ˜å¼ YAML + å¯é€‰ Python æ‰©å±•åŒè½¨æ¨¡å¼ã€‚

#### 3.18.2 FR-202: å¢é‡ Linter

è¯¦è§ PRD Q8 çš„è®¾è®¡æ–¹æ¡ˆï¼šå¢é‡æ£€æŸ¥ + å¹¶è¡Œæ‰§è¡Œ + ç¼“å­˜ä¸‰æ¿æ–§ã€‚

#### 3.18.3 FR-203: Linter è¯¯æŠ¥è¦†ç›–

è¯¦è§ PRD Q5 çš„è®¾è®¡æ–¹æ¡ˆï¼šä¸‰çº§è±å…æœºåˆ¶ï¼ˆè¡Œçº§/æ–‡ä»¶çº§/è§„åˆ™çº§ï¼‰ã€‚

#### 3.18.4 FR-204: è·¨æ–‡ä»¶ä¾èµ–æ£€æŸ¥

è¯¦è§ PRD Q6 çš„è®¾è®¡æ–¹æ¡ˆï¼šåˆ†ä¸¤é˜¶æ®µï¼Œå…ˆå£°æ˜å¼æ£€æŸ¥ï¼Œå AST è‡ªåŠ¨æ£€æµ‹ã€‚

---

## 4. æ•°æ®æ¶æ„

### 4.1 æ•°æ®æµ

```mermaid
sequenceDiagram
    actor User
    participant SKILL as Why-First SKILL
    participant Why as project-why.md
    participant Task as Task æ–‡ä»¶å¤¹
    participant Hooks as Hooks é—¨æ§
    participant Git as Git ä»“åº“

    User->>SKILL: /nomos:start éœ€æ±‚
    SKILL->>Git: åˆ›å»º feature åˆ†æ”¯
    SKILL->>Task: åˆ›å»º task æ–‡ä»¶å¤¹
    SKILL->>Why: åŠ è½½ç›¸å…³ Why
    SKILL->>User: ç”Ÿæˆ Why é—®é¢˜
    User->>Task: æ‰¹æ³¨ research.md
    SKILL->>Why: æ›´æ–° project-why.md
    SKILL->>Task: ç”Ÿæˆ plan.md
    User->>Task: æ‰¹æ³¨ plan.md
    SKILL->>Hooks: è¯·æ±‚å†™ä»£ç 
    Hooks->>Task: æ£€æŸ¥ Phase Gates
    Hooks->>SKILL: æ”¾è¡Œ/é˜»å¡
    SKILL->>Git: commit + PR
```

### 4.2 æ ¸å¿ƒæ•°æ®æ¨¡å‹

**project-why.md**(å…¨é¡¹ç›®çŸ¥è¯†åº“)
```markdown
## Auth Module Why

### ä¸ºä»€ä¹ˆ AuthService.login() ä½¿ç”¨ SQLAlchemy?
**åŸå› **: 2025-11 é—ç•™çº¦æŸ,éœ€è¦æ”¯æŒäº‹åŠ¡å›æ»š
**ç›¸å…³ä»£ç **: src/auth/service.py:47
**æœ€åæ›´æ–°**: 2026-02-23
**çŠ¶æ€**: âœ… ä»æœ‰æ•ˆ

### ä¸ºä»€ä¹ˆå¾®ä¿¡å›è°ƒå¿…é¡»èµ° ApiGateway?
**åŸå› **: ç»Ÿä¸€é‰´æƒå’Œé™æµ
**ç›¸å…³ä»£ç **: src/auth/oauth/wechat.py:23
**æœ€åæ›´æ–°**: 2026-02-20
**çŠ¶æ€**: âš ï¸ å¾…ç¡®è®¤(ç”¨æˆ·æ‰¹æ³¨:å¯èƒ½æ”¹ä¸ºç›´è¿)
```

**research.md**(å•ä»»åŠ¡è°ƒç ”)
```markdown
## å—å½±å“æ¨¡å—
- src/auth/service.py
- src/auth/oauth/wechat.py

## Protected Interfaces
- AuthService.login(username, password) â†’ ç­¾åä¸èƒ½æ”¹

## Open Questions
- [ ] å¾®ä¿¡å›è°ƒæ˜¯å¦ä»éœ€èµ° ApiGateway?
- [ ] éªŒè¯ç é˜²åˆ·ç­–ç•¥?

## Human Research Notes
> å¾®ä¿¡å›è°ƒæ”¹ä¸ºç›´è¿,ApiGateway å·²åºŸå¼ƒ
> âœ… Addressed by AI (2026-02-23)
```

**plan.md**(å•ä»»åŠ¡è®¡åˆ’)
```markdown
## Phase Gates
- [x] Research å®Œæˆ
- [x] Test Skeleton ç”Ÿæˆ
- [ ] å®ç°å®Œæˆ
- [ ] Code Review é€šè¿‡

## Review Comments
> Phase 3 å¿…é¡»åŒæ—¶äº§å‡ºå•å…ƒæµ‹è¯•
> âœ… Addressed (å·²åœ¨ tests/ ç”Ÿæˆéª¨æ¶)
```

### 4.3 çŠ¶æ€ç®¡ç†

| çŠ¶æ€ç±»å‹ | å­˜å‚¨ä½ç½® | ä½œç”¨åŸŸ | ç”Ÿå‘½å‘¨æœŸ |
|---------|---------|-------|---------|
| **å…¨é¡¹ç›®çŸ¥è¯†** | project-why.md | å…¨å±€ | æ°¸ä¹…(æŒç»­æ›´æ–°) |
| **ä»»åŠ¡çŠ¶æ€** | tasks/t1-xxx/ | å•ä»»åŠ¡ | ä»»åŠ¡å®Œæˆåå½’æ¡£ |
| **ä¼šè¯ä¸Šä¸‹æ–‡** | .claude/current-task.txt | å½“å‰ä¼šè¯ | ä¼šè¯ç»“æŸæ¸…é™¤ |
| **Short ID æ˜ å°„** | tasks/short-id-mapping.json | å…¨å±€ | æ°¸ä¹… |
| **Git åˆ†æ”¯** | .git/ | å•ä»»åŠ¡ | åˆå¹¶åå¯åˆ é™¤ |

---

## 5. é€šä¿¡åè®®

### 5.1 Hooks è§¦å‘æœºåˆ¶

**PreToolUse Hook**:
```bash
# Input: tool_name, tool_args, context
# Output: allow/deny + reason

#!/bin/bash
TOOL_NAME=$1
TOOL_ARGS=$2

if [[ "$TOOL_NAME" == "Write" || "$TOOL_NAME" == "Edit" ]]; then
    # æ£€æŸ¥ plan.md Phase Gates
    if ! check_gates_passed; then
        echo "DENY: Phase Gates æœªå…¨éƒ¨é€šè¿‡"
        exit 1
    fi

    # è¿è¡Œ AgentLinterEngine
    if ! run_linter "$TOOL_ARGS"; then
        echo "DENY: Linter æ£€æŸ¥å¤±è´¥"
        exit 1
    fi
fi

echo "ALLOW"
exit 0
```

**SessionStart Hook**:
```bash
#!/bin/bash
# åŠ è½½ project-why.md ç›¸å…³ç‰‡æ®µ
CURRENT_TASK=$(cat .claude/current-task.txt)
extract_relevant_why "$CURRENT_TASK" > /tmp/why-context.md

# æ³¨å…¥åˆ° Claude ä¸Šä¸‹æ–‡
echo "å·²åŠ è½½ project-why.md ç›¸å…³å†…å®¹"
```

### 5.2 SKILL å†…éƒ¨é€šä¿¡

**å­å‘½ä»¤è·¯ç”±**:
```markdown
# SKILL.md
å½“ç”¨æˆ·è¾“å…¥ /nomos:<subcommand> æ—¶:
- (æ— å‚æ•°) â†’ æ˜¾ç¤ºå¸®åŠ©
- start â†’ å¯åŠ¨å®Œæ•´æµç¨‹ (Why-First â†’ Research â†’ Plan â†’ Execute)
- new-task â†’ åˆ›å»ºä»»åŠ¡æ–‡ä»¶å¤¹
- research â†’ æ‰§è¡Œ Research é˜¶æ®µ
- plan â†’ æ‰§è¡Œ Plan é˜¶æ®µ
- execute â†’ æ‰§è¡Œ Execute é˜¶æ®µ
- view-task â†’ å¯åŠ¨ Task Viewer
- list-tasks â†’ åˆ—å‡ºæ‰€æœ‰ä»»åŠ¡
- switch-task <task-id> â†’ åˆ‡æ¢ä»»åŠ¡
- update-why â†’ æ›´æ–° project-why.md
- update-diagram â†’ æ›´æ–° Mermaid å›¾è¡¨
- archive â†’ å½’æ¡£ä»»åŠ¡
- validate â†’ è§¦å‘ Validator Subagent
```

**å®Œæ•´ SKILL å‘½ä»¤åˆ—è¡¨** (ç»Ÿä¸€ `/nomos` å‰ç¼€):

| å‘½ä»¤ | åŠŸèƒ½ | è¯´æ˜ |
|------|------|------|
| `/nomos` | æ˜¾ç¤ºå¸®åŠ© | åˆ—å‡ºæ‰€æœ‰å¯ç”¨å­å‘½ä»¤ |
| `/nomos:start` | å¯åŠ¨æ–°ä»»åŠ¡ | å®Œæ•´æµç¨‹: Why-First â†’ Research â†’ Plan â†’ Execute |
| `/nomos:new-task` | åˆ›å»ºä»»åŠ¡æ–‡ä»¶å¤¹ | ä»…åˆ›å»º tasks/tN-YYYY-MM-DD-name/ ç»“æ„ |
| `/nomos:research` | æ‰§è¡Œ Research é˜¶æ®µ | ç”Ÿæˆ/æ›´æ–° research.md |
| `/nomos:plan` | æ‰§è¡Œ Plan é˜¶æ®µ | ç”Ÿæˆ/æ›´æ–° plan.md |
| `/nomos:execute` | æ‰§è¡Œ Execute é˜¶æ®µ | å¼€å§‹ç¼–ç å®ç° |
| `/nomos:view-task` | å¯åŠ¨ Task Viewer | æ‰“å¼€æµè§ˆå™¨æŸ¥çœ‹å’Œæ ‡æ³¨ |
| `/nomos:list-tasks` | åˆ—å‡ºæ‰€æœ‰ä»»åŠ¡ | æ˜¾ç¤ºä»»åŠ¡ IDã€çŠ¶æ€ã€æè¿° |
| `/nomos:switch-task` | åˆ‡æ¢ä»»åŠ¡ | åˆ‡æ¢åˆ°æŒ‡å®šä»»åŠ¡ä¸Šä¸‹æ–‡ |
| `/nomos:update-why` | æ›´æ–° project-why.md | åˆ›å»º/æ›´æ–°é¡¹ç›®çŸ¥è¯†åº“ |
| `/nomos:update-diagram` | æ›´æ–° Mermaid å›¾ | é‡æ–°ç”Ÿæˆ plan.md ä¸­çš„æµç¨‹å›¾ |
| `/nomos:archive` | å½’æ¡£ä»»åŠ¡ | ç§»åŠ¨å®Œæˆçš„ä»»åŠ¡åˆ° tasks/archive/ |
| `/nomos:validate` | è§¦å‘éªŒè¯ | è¿è¡Œ Validator Subagent å®¡æŸ¥ |
| `/nomos:clarify` | éœ€æ±‚æ¾„æ¸… | è½»é‡çº§å¯¹è¯ï¼Œå¸®åŠ©ç”¨æˆ·æ¾„æ¸…æ¨¡ç³Šéœ€æ±‚ (P1) |

---

## 5.7 /nomos:clarify å­å‘½ä»¤è®¾è®¡

`/nomos:clarify` æ˜¯ä¸€ä¸ªè½»é‡çº§çš„éœ€æ±‚æ¾„æ¸…å­å‘½ä»¤ï¼Œç”¨äºåœ¨ `/nomos:start` ä¹‹å‰å¸®åŠ©ç”¨æˆ·æ¾„æ¸…æ¨¡ç³Šçš„éœ€æ±‚ã€‚

### 5.7.1 å®šä½

- **å¯é€‰æ­¥éª¤**ï¼Œéœ€æ±‚æ¸…æ™°æ—¶å¯ç›´æ¥ `/nomos:start`
- **è½»é‡çº§**ï¼Œä¸ç”Ÿæˆä»»ä½•æ–‡ä»¶ï¼Œåªåœ¨æ§åˆ¶å°è¾“å‡º
- **å€Ÿé‰´ doc-architect** çš„ç»“æ„åŒ–æ€ç»´ï¼Œä½†å¤§å¹…ç®€åŒ–

### 5.7.2 å·¥ä½œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    /nomos:clarify å·¥ä½œæµç¨‹                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  ç”¨æˆ·: /nomos:clarify                                                â”‚
â”‚       â”‚                                                              â”‚
â”‚       â–¼                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Step 1: å€¾å¬                                                    â”‚ â”‚
â”‚  â”‚ è®©ç”¨æˆ·è‡ªç”±æè¿°æƒ³æ³•ï¼Œè®°å½•å…³é”®ä¿¡æ¯                                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚       â”‚                                                              â”‚
â”‚       â–¼                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Step 2: æå–                                                    â”‚ â”‚
â”‚  â”‚ - å…³é”®è¯: æŠ€æœ¯æœ¯è¯­ã€äº§å“åã€åŠŸèƒ½å                                â”‚ â”‚
â”‚  â”‚ - ç—›ç‚¹: ç”¨æˆ·æƒ³è§£å†³ä»€ä¹ˆé—®é¢˜                                       â”‚ â”‚
â”‚  â”‚ - çº¦æŸ: æŠ€æœ¯/æ—¶é—´/èµ„æºé™åˆ¶                                       â”‚ â”‚
â”‚  â”‚ - é—®é¢˜ç‚¹: ä¸ç¡®å®šæˆ–æ¨¡ç³Šçš„åœ°æ–¹                                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚       â”‚                                                              â”‚
â”‚       â–¼                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Step 3: åˆ†ç±»                                                    â”‚ â”‚
â”‚  â”‚ - ä¸šåŠ¡ä»·å€¼: è§£å†³ä»€ä¹ˆç—›ç‚¹ï¼Ÿå¸¦æ¥ä»€ä¹ˆä»·å€¼ï¼Ÿ                         â”‚ â”‚
â”‚  â”‚ - æŠ€æœ¯çº¦æŸ: æœ‰å“ªäº›é™åˆ¶ï¼Ÿä¾èµ–ä»€ä¹ˆï¼Ÿ                               â”‚ â”‚
â”‚  â”‚ - è§„æ ¼è¦æ±‚: è¾“å…¥è¾“å‡ºï¼Ÿè¾¹ç•Œæ¡ä»¶ï¼Ÿ                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚       â”‚                                                              â”‚
â”‚       â–¼                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Step 4: è¿½é—® (æœ€å¤š 3 è½®)                                        â”‚ â”‚
â”‚  â”‚ åªé—®çœŸæ­£ä¸ç¡®å®šçš„å…³é”®é—®é¢˜ï¼Œæ¯è½®ä¸è¶…è¿‡ 2 ä¸ªé—®é¢˜                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚       â”‚                                                              â”‚
â”‚       â–¼                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Step 5: è¾“å‡ºæ¾„æ¸…æŠ¥å‘Š                                            â”‚ â”‚
â”‚  â”‚ åœ¨æ§åˆ¶å°æ˜¾ç¤ºç»“æ„åŒ–æŠ¥å‘Šï¼Œä¸ç”Ÿæˆæ–‡ä»¶                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚       â”‚                                                              â”‚
â”‚       â–¼                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Step 6: ç¡®è®¤                                                    â”‚ â”‚
â”‚  â”‚ ç”¨æˆ·ç¡®è®¤åæç¤ºä½¿ç”¨ /nomos:start å¼€å§‹                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.7.3 æ¾„æ¸…æŠ¥å‘Šæ ¼å¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“‹ éœ€æ±‚æ¾„æ¸…æŠ¥å‘Š                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  ğŸ“ ä»»åŠ¡åç§°: [å»ºè®®çš„ä»»åŠ¡å]                                         â”‚
â”‚                                                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  ğŸ¯ ä¸šåŠ¡ä»·å€¼                                                        â”‚
â”‚  - ç—›ç‚¹: [ç”¨æˆ·æƒ³è§£å†³çš„é—®é¢˜]                                          â”‚
â”‚  - ä»·å€¼: [å¸¦æ¥çš„æ”¶ç›Š]                                                â”‚
â”‚                                                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  ğŸ”§ æŠ€æœ¯çº¦æŸ                                                        â”‚
â”‚  - æŠ€æœ¯æ ˆ: [ç›¸å…³æŠ€æœ¯]                                                â”‚
â”‚  - ä¾èµ–: [å¤–éƒ¨ä¾èµ–]                                                  â”‚
â”‚  - é™åˆ¶: [æ—¶é—´/èµ„æºé™åˆ¶]                                             â”‚
â”‚                                                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  ğŸ“ è§„æ ¼è¦æ±‚                                                        â”‚
â”‚  - è¾“å…¥: [ç³»ç»Ÿæ¥æ”¶ä»€ä¹ˆ]                                              â”‚
â”‚  - è¾“å‡º: [ç³»ç»Ÿäº§ç”Ÿä»€ä¹ˆ]                                              â”‚
â”‚  - è¾¹ç•Œ: [è¾¹ç•Œæ¡ä»¶]                                                  â”‚
â”‚                                                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  â“ å¾…ç¡®è®¤äº‹é¡¹                                                       â”‚
â”‚  - [ ] é—®é¢˜1                                                        â”‚
â”‚  - [ ] é—®é¢˜2                                                        â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… ç¡®è®¤åæ‰§è¡Œ: /nomos:start <ä»»åŠ¡å>
```

### 5.7.4 ä¸ doc-architect çš„å…³ç³»

| å…ƒç´  | doc-architect | /nomos:clarify |
|------|---------------|----------------|
| **è¾“å…¥** | å¤§é‡å¤´è„‘é£æš´ç¬”è®° | ç”¨æˆ·å£è¯­æè¿° (1-2 å¥è¯) |
| **è¾“å‡º** | PRD + æ¶æ„ + API æ–‡æ¡£ | æ§åˆ¶å°æ¾„æ¸…æŠ¥å‘Š (ä¸ç”Ÿæˆæ–‡ä»¶) |
| **æµç¨‹** | P0-P6 å…± 7 é˜¶æ®µ | 4-6 æ­¥å¯¹è¯ |
| **æå–é€»è¾‘** | å®Œæ•´ Phase 2-3 | ç®€åŒ–ç‰ˆæå– |
| **åˆ†ç±»ç»´åº¦** | å®Œæ•´ä¸‰ç»´åˆ†ç±» | ç®€åŒ–ä¸º 3 ç±» |
| **éªŒè¯** | 3 è½®è¿­ä»£éªŒè¯ | æ—  (è½»é‡çº§) |

### 5.7.5 æç¤ºè¯æ¨¡æ¿

```markdown
# .claude/skills/nomos/prompts/clarify.md

ä½ æ­£åœ¨æ‰§è¡Œ Nomos çš„éœ€æ±‚æ¾„æ¸…æµç¨‹ã€‚

## ç›®æ ‡

å¸®åŠ©ç”¨æˆ·å°†æ¨¡ç³Šçš„æƒ³æ³•è½¬åŒ–ä¸ºæ¸…æ™°çš„éœ€æ±‚æè¿°ï¼Œä½†ä¸ç”Ÿæˆä»»ä½•æ–‡ä»¶ã€‚

## æ‰§è¡Œæ­¥éª¤

1. **å€¾å¬ç”¨æˆ·æè¿°**
   - è®©ç”¨æˆ·è‡ªç”±æè¿°æƒ³æ³•
   - ä¸è¦æ‰“æ–­ï¼Œè®°å½•å…³é”®ä¿¡æ¯

2. **æå–å…³é”®ä¿¡æ¯**
   - å…³é”®è¯: æŠ€æœ¯æœ¯è¯­ã€äº§å“åã€åŠŸèƒ½å
   - ç—›ç‚¹: ç”¨æˆ·æƒ³è§£å†³ä»€ä¹ˆé—®é¢˜
   - çº¦æŸ: æŠ€æœ¯/æ—¶é—´/èµ„æºé™åˆ¶
   - é—®é¢˜ç‚¹: ä¸ç¡®å®šæˆ–æ¨¡ç³Šçš„åœ°æ–¹

3. **ç»“æ„åŒ–åˆ†ç±»**
   - ä¸šåŠ¡ä»·å€¼: è¿™ä¸ªéœ€æ±‚è§£å†³ä»€ä¹ˆç—›ç‚¹ï¼Ÿå¸¦æ¥ä»€ä¹ˆä»·å€¼ï¼Ÿ
   - æŠ€æœ¯çº¦æŸ: æœ‰å“ªäº›æŠ€æœ¯é™åˆ¶ï¼Ÿä¾èµ–ä»€ä¹ˆï¼Ÿ
   - è§„æ ¼è¦æ±‚: è¾“å…¥è¾“å‡ºæ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆè¾¹ç•Œæ¡ä»¶ï¼Ÿ

4. **è¿½é—®æ¾„æ¸…** (æœ€å¤š 3 è½®)
   - åªé—®çœŸæ­£ä¸ç¡®å®šçš„å…³é”®é—®é¢˜
   - æ¯è½®ä¸è¶…è¿‡ 2 ä¸ªé—®é¢˜

5. **è¾“å‡ºæ¾„æ¸…æŠ¥å‘Š**
   - ä½¿ç”¨æ ‡å‡†æ ¼å¼åœ¨æ§åˆ¶å°æ˜¾ç¤º
   - ä¸ç”Ÿæˆä»»ä½•æ–‡ä»¶

6. **å¼•å¯¼ä¸‹ä¸€æ­¥**
   - ç¡®è®¤åæç¤º: `/nomos:start <ä»»åŠ¡å>`
   - éœ€è¦ä¿®æ”¹åˆ™ç»§ç»­å¯¹è¯

## çº¦æŸ

- ä¸ç”Ÿæˆä»»ä½•æ–‡ä»¶
- ä¸åšæŠ€æœ¯æ–¹æ¡ˆè®¾è®¡
- åªæ¾„æ¸…éœ€æ±‚ï¼Œä¸è¯„ä¼°å¯è¡Œæ€§
- æœ€å¤š 3 è½®è¿½é—®
```

### 5.7.6 ä½¿ç”¨åœºæ™¯

| åœºæ™¯ | æ˜¯å¦éœ€è¦ clarify |
|------|------------------|
| ç”¨æˆ·è¯´"å¸®æˆ‘åŠ ä¸ªç™»å½•åŠŸèƒ½" | âœ… éœ€è¦ (éœ€æ±‚æ¨¡ç³Š) |
| ç”¨æˆ·è¯´"å®ç° JWT è®¤è¯ï¼Œæ”¯æŒ refresh tokenï¼Œè¿‡æœŸæ—¶é—´ 7 å¤©" | âŒ ä¸éœ€è¦ (éœ€æ±‚æ¸…æ™°) |
| ç”¨æˆ·è¯´"ä¼˜åŒ–æ€§èƒ½" | âœ… éœ€è¦ (å¤ªæ¨¡ç³Š) |
| ç”¨æˆ·è¯´"æŠŠé¦–é¡µåŠ è½½æ—¶é—´ä» 3s é™åˆ° 1s ä»¥å†…" | âŒ ä¸éœ€è¦ (ç›®æ ‡æ˜ç¡®) |

---

## 6. éƒ¨ç½²æ¶æ„

### 6.1 æœ¬åœ°å¼€å‘ç¯å¢ƒ

```
å¼€å‘æœº
â”œâ”€â”€ Claude Code CLI
â”œâ”€â”€ .claude/
â”‚   â”œâ”€â”€ skills/nomos/
â”‚   â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ config.yml
â”œâ”€â”€ project-why.md
â””â”€â”€ tasks/
    â”œâ”€â”€ t1-2026-02-23-feature/
    â””â”€â”€ t2-2026-02-24-refactor/
```

### 6.2 Task Viewer æœåŠ¡å™¨

**å¯åŠ¨æ–¹å¼**:
```bash
# è‡ªåŠ¨å¯åŠ¨(SKILL è°ƒç”¨)
python .claude/scripts/task-viewer-server.py --task t1 --port 8765
```

**ç«¯å£åˆ†é…ç­–ç•¥**:
- èµ·å§‹ç«¯å£: 8765
- å†²çªæ£€æµ‹: è‡ªåŠ¨é€’å¢(8766, 8767...)
- å¤šå®ä¾‹: æ¯ä¸ªä»»åŠ¡ç‹¬ç«‹ç«¯å£

**è‡ªåŠ¨å…³é—­æœºåˆ¶**:
- 30 åˆ†é’Ÿæ— æ´»åŠ¨è‡ªåŠ¨å…³é—­
- æµè§ˆå™¨å…³é—­æ—¶é€šè¿‡ WebSocket é€šçŸ¥æœåŠ¡å™¨
- ä¼˜é›…å…³é—­:ä¿å­˜çŠ¶æ€åé€€å‡º

---

## 7. å¯é æ€§ä¸å¯ç”¨æ€§

### 7.1 å¤±è´¥åœºæ™¯ä¸æ¢å¤

| å¤±è´¥ç±»å‹ | å½±å“ | æ¢å¤æœºåˆ¶ |
|---------|------|---------|
| **AI å¹»è§‰/è¯¯åˆ¤** | ç”Ÿæˆé”™è¯¯ research/plan | Validator Subagent æŒ‘åˆº + äººç±»æ‰¹æ³¨ä¿®æ­£ + è®°å½•åˆ° project-why.md |
| **Hooks é˜»å¡** | æ— æ³•å†™ä»£ç  | æ£€æŸ¥ plan.md Phase Gates,ä¿®å¤åé‡è¯• |
| **ä¼šè¯ä¸­æ–­** | ä¸Šä¸‹æ–‡ä¸¢å¤± | SessionStart Hook è‡ªåŠ¨åŠ è½½ task æ–‡ä»¶å¤¹ + project-why.md |
| **Git å†²çª** | åˆ†æ”¯åˆå¹¶å¤±è´¥ | æ‰‹åŠ¨è§£å†³(æš‚ä¸è‡ªåŠ¨åŒ–) |
| **Task Viewer å´©æºƒ** | æ— æ³•æŸ¥çœ‹æ–‡æ¡£ | è‡ªåŠ¨é‡å¯æˆ–ç›´æ¥æŸ¥çœ‹ MD æ–‡ä»¶ |

### 7.2 æœæ–­ Revert + å¤±è´¥å­¦ä¹ 

**è§¦å‘æ¡ä»¶**:
- Validator Subagent æ‰“åˆ† < 70
- äººç±»æ‰¹æ³¨"é‡æ¥"
- Hooks è¿ç»­é˜»å¡ 3 æ¬¡

**æ‰§è¡Œæ­¥éª¤**:
1. `git revert` å›æ»šä»£ç 
2. åˆ›å»º `lessons/2026-02-23-failed-attempt.md`
3. AI åˆ†æå¤±è´¥åŸå› ,å†™å…¥ project-why.md
4. ä¸‹æ¬¡ç›¸åŒæ¨¡å—è‡ªåŠ¨å¼•ç”¨æ•™è®­

**å¤±è´¥è®°å½•ç¤ºä¾‹**:
```markdown
## Auth Module Why

### âŒ å¤±è´¥æ•™è®­: 2026-02-23 å¾®ä¿¡ç™»å½•é‡æ„
**é”™è¯¯**: è¯¯ä»¥ä¸ºå¯ä»¥ç›´æ¥åˆ é™¤ ApiGateway è°ƒç”¨
**åŸå› **: æœªæ³¨æ„åˆ°é£æ§æœåŠ¡ä¾èµ– ApiGateway çš„ IP ç™½åå•
**æ•™è®­**: é‡æ„å‰å¿…é¡»æ£€æŸ¥æ‰€æœ‰ä¸‹æ¸¸ä¾èµ–
**ç›¸å…³ä»£ç **: src/auth/oauth/wechat.py:23
```

---

## 8. æ€§èƒ½è€ƒè™‘

### 8.1 æ€§èƒ½ç›®æ ‡

| æŒ‡æ ‡ | ç›®æ ‡ | æµ‹é‡æ–¹å¼ |
|------|------|---------|
| **Why é—®é¢˜ç”Ÿæˆ** | < 5 ç§’ | ä»éœ€æ±‚è¾“å…¥åˆ°é—®é¢˜åˆ—è¡¨è¾“å‡º |
| **Hooks æ£€æŸ¥** | < 2 ç§’ | PreToolUse æ‰§è¡Œæ—¶é—´ |
| **Task Viewer å¯åŠ¨** | < 3 ç§’ | æœåŠ¡å™¨å¯åŠ¨åˆ°æµè§ˆå™¨æ‰“å¼€ |
| **Mermaid æ¸²æŸ“** | < 1 ç§’ | å›¾è¡¨æ›´æ–°åˆ°æ˜¾ç¤º |

### 8.2 ä¼˜åŒ–ç­–ç•¥

- **project-why.md åˆ†ç‰‡åŠ è½½**: åªåŠ è½½ç›¸å…³æ¨¡å—,ä¸å…¨é‡è¯»å–
- **Hooks å¹¶è¡Œæ‰§è¡Œ**: å¤šä¸ª Hook è„šæœ¬å¹¶è¡Œè¿è¡Œ
- **Mermaid å¢é‡æ¸²æŸ“**: åªé‡æ–°æ¸²æŸ“å˜æ›´éƒ¨åˆ†
- **Task Viewer ç¼“å­˜**: é™æ€èµ„æº CDN ç¼“å­˜

---

## 9. ç›‘æ§ä¸å¯è§‚æµ‹æ€§

### 9.1 å…³é”®æŒ‡æ ‡

| æŒ‡æ ‡ | ç±»å‹ | ç”¨é€” | è®°å½•ä½ç½® |
|------|------|------|---------|
| **Why é—®é¢˜æ•°é‡** | ä¸šåŠ¡ | è¯„ä¼°è°ƒç ”æ·±åº¦ | research.md |
| **Phase Gates é€šè¿‡ç‡** | è´¨é‡ | è¯„ä¼°æµç¨‹åˆšæ€§ | plan.md |
| **Hooks é˜»å¡æ¬¡æ•°** | æŠ€æœ¯ | å‘ç°æµç¨‹ç“¶é¢ˆ | .claude/logs/hooks.log |
| **Revert æ¬¡æ•°** | è´¨é‡ | è¯„ä¼° AI å‡†ç¡®åº¦ | lessons/ ç›®å½• |
| **Token æ¶ˆè€—** | æˆæœ¬ | ä¼˜åŒ– prompt | .claude/logs/tokens.log |

### 9.2 æ—¥å¿—è®°å½•

**Hooks æ—¥å¿—**:
```
[2026-02-23 14:32:15] PreToolUse: Write src/auth/service.py
[2026-02-23 14:32:16] Linter: PASS (0 errors)
[2026-02-23 14:32:16] Phase Gates: FAIL (Test Skeleton æœªç”Ÿæˆ)
[2026-02-23 14:32:16] Result: DENY
```

**ä»»åŠ¡å®Œæˆæ€»ç»“**:
```markdown
# daily-win.md (2026-02-23)

## ä»Šæ—¥æˆå°±
- å®Œæˆ 2 ä¸ªä»»åŠ¡(t1, t2)
- é›¶è¿”å·¥(è¿ç»­ 5 å¤©)
- project-why.md æ–°å¢ 3 æ¡çŸ¥è¯†
- èŠ‚çœ 42% token(ç›¸æ¯”æ—  Why-First)

## ğŸ† Architect Streak Ã—5
```

---

## 10. æŠ€æœ¯å†³ç­–

### 10.1 å…³é”®æŠ€æœ¯é€‰å‹

| æŠ€æœ¯ | ç†ç”± | å¤‡é€‰æ–¹æ¡ˆ |
|------|------|---------|
| **Markdown æ–‡ä»¶** | äººç±»å¯è¯»ã€Git å‹å¥½ã€è·¨ä¼šè¯æŒä¹…åŒ– | JSON(ä¸å¤Ÿå¯è¯»)ã€æ•°æ®åº“(è¿‡é‡) |
| **Claude Code Hooks** | ç‰©ç†é—¨æ§ã€å®˜æ–¹æ”¯æŒã€åˆšæ€§æ‰§è¡Œ | çº¯ prompt(è½¯çº¦æŸ)ã€è‡ªå®šä¹‰æ‹¦æˆªå™¨(å¤æ‚) |
| **Python HTTP æœåŠ¡å™¨** | å†…ç½®ã€è½»é‡ã€è·¨å¹³å° | Node.js(éœ€é¢å¤–å®‰è£…)ã€Go(ç¼–è¯‘å¤æ‚) |
| **Mermaid.js** | å£°æ˜å¼ã€CDN å¯ç”¨ã€ç¤¾åŒºæ´»è·ƒ | PlantUML(éœ€ Java)ã€D3.js(å­¦ä¹ æ›²çº¿é™¡) |
| **Git åˆ†æ”¯éš”ç¦»** | æ ‡å‡†å®è·µã€å¹¶è¡Œæ”¯æŒã€æ˜“å›æ»š | Git worktree(ç”¨æˆ·ä¸éœ€è¦)ã€å•åˆ†æ”¯(å†²çªå¤š) |

### 10.2 æ¶æ„æƒè¡¡

**Why-First vs ç›´æ¥å¼€å‘**:
- âœ… ä¼˜åŠ¿: å‰ç½®è°ƒç ”,å‡å°‘è¿”å·¥,ç´¯ç§¯çŸ¥è¯†
- âš ï¸ åŠ£åŠ¿: åˆæœŸåé—®è¾ƒå¤š(5-10 ä¸ªä»»åŠ¡åæ”¹å–„)
- **å†³ç­–**: é‡‡ç”¨ Why-First,é•¿æœŸæ”¶ç›Šè¿œå¤§äºçŸ­æœŸæˆæœ¬

**Hooks åˆšæ€§ vs Prompt è½¯çº¦æŸ**:
- âœ… ä¼˜åŠ¿: ç‰©ç†é˜»å¡,AI æ— æ³•è·³æ­¥
- âš ï¸ åŠ£åŠ¿: é…ç½®å¤æ‚,è°ƒè¯•å›°éš¾
- **å†³ç­–**: é‡‡ç”¨ Hooks,åˆšæ€§æ˜¯æ ¸å¿ƒéœ€æ±‚

**Task æ–‡ä»¶å¤¹ vs å•æ–‡ä»¶**:
- âœ… ä¼˜åŠ¿: éš”ç¦»æ¸…æ™°,å¹¶è¡Œæ”¯æŒ,æ˜“å½’æ¡£
- âš ï¸ åŠ£åŠ¿: æ–‡ä»¶æ•°é‡å¤š
- **å†³ç­–**: é‡‡ç”¨æ–‡ä»¶å¤¹,å¯ç»´æŠ¤æ€§ä¼˜å…ˆ

### 10.3 å·²çŸ¥æŠ€æœ¯å€º

- **project-why.md è†¨èƒ€**: é•¿æœŸä½¿ç”¨åå¯èƒ½è¿‡å¤§,éœ€è¦åˆ†æ¨¡å—æ‹†åˆ†æˆ–å½’æ¡£æœºåˆ¶
- **Hooks è„šæœ¬ç»´æŠ¤**: æ¯ä¸ªé¡¹ç›®éœ€è‡ªå®šä¹‰,ç¼ºå°‘å¯è§†åŒ–é…ç½®ç•Œé¢
- **Mermaid å›¾è¡¨å¤æ‚åº¦**: å¤§å‹é¡¹ç›®æµç¨‹å›¾å¯èƒ½è¿‡äºå¤æ‚,éœ€è¦åˆ†å±‚å±•ç¤º
- **å¹¶è¡Œä»»åŠ¡åˆ‡æ¢**: å½“å‰éœ€æ‰‹åŠ¨åˆ‡æ¢,æœªæ¥å¯è€ƒè™‘è‡ªåŠ¨æ£€æµ‹å’Œæ¨è

---

## 11. æ‰©å±•æ€§è®¾è®¡

### 11.1 SKILL Marketplace æ¨¡å¼

**è®¾è®¡ç›®æ ‡**: è®© Why-First Nomos Flow å¯åˆ†äº«,åŒæ—¶æ”¯æŒé¡¹ç›®ä¸ªæ€§åŒ–ã€‚

**æ–‡ä»¶ç»“æ„**:
```
.claude/skills/nomos/
â”œâ”€â”€ SKILL.md                        # ä¸»å…¥å£ï¼Œé€šç”¨æµç¨‹å®šä¹‰
â”œâ”€â”€ marketplace/
â”‚   â”œâ”€â”€ start/SKILL.md              # å¯åŠ¨å®Œæ•´æµç¨‹
â”‚   â”œâ”€â”€ new-task/SKILL.md           # åˆ›å»ºä»»åŠ¡æ–‡ä»¶å¤¹
â”‚   â”œâ”€â”€ research/SKILL.md           # Research é˜¶æ®µ
â”‚   â”œâ”€â”€ plan/SKILL.md               # Plan é˜¶æ®µ
â”‚   â”œâ”€â”€ execute/SKILL.md            # Execute é˜¶æ®µ
â”‚   â”œâ”€â”€ view-task/SKILL.md          # Task Viewer
â”‚   â”œâ”€â”€ list-tasks/SKILL.md         # ä»»åŠ¡åˆ—è¡¨
â”‚   â”œâ”€â”€ switch-task/SKILL.md        # ä»»åŠ¡åˆ‡æ¢
â”‚   â”œâ”€â”€ update-why/SKILL.md         # project-why.md ç®¡ç†
â”‚   â”œâ”€â”€ update-diagram/SKILL.md     # Mermaid å›¾æ›´æ–°
â”‚   â”œâ”€â”€ archive/SKILL.md            # ä»»åŠ¡å½’æ¡£
â”‚   â””â”€â”€ validate/SKILL.md           # Validator Subagent
â””â”€â”€ marketplace.json                # å­å‘½ä»¤æ˜ å°„é…ç½®
```

**marketplace.json é…ç½®**:
```json
{
  "name": "nomos",
  "version": "1.0.0",
  "commands": {
    "start": "nomos/start",
    "new-task": "nomos/new-task",
    "research": "nomos/research",
    "plan": "nomos/plan",
    "execute": "nomos/execute",
    "view-task": "nomos/view-task",
    "list-tasks": "nomos/list-tasks",
    "switch-task": "nomos/switch-task",
    "update-why": "nomos/update-why",
    "update-diagram": "nomos/update-diagram",
    "archive": "nomos/archive",
    "validate": "nomos/validate"
  }
}
```

**è°ƒç”¨æ–¹å¼**:
```bash
/nomos                    # æ˜¾ç¤ºå¸®åŠ©
/nomos:start              # å®Œæ•´æµç¨‹
/nomos:new-task           # åˆ›å»ºä»»åŠ¡
/nomos:research           # åªè°ƒç ”
/nomos:plan               # åªè§„åˆ’
/nomos:execute            # åªæ‰§è¡Œ
/nomos:view-task          # æŸ¥çœ‹ä»»åŠ¡
/nomos:list-tasks         # åˆ—å‡ºä»»åŠ¡
/nomos:switch-task t1     # åˆ‡æ¢ä»»åŠ¡
/nomos:update-why         # æ›´æ–°çŸ¥è¯†åº“
/nomos:update-diagram     # æ›´æ–°å›¾è¡¨
/nomos:archive            # å½’æ¡£ä»»åŠ¡
/nomos:validate           # è§¦å‘éªŒè¯
```

#### 11.1.1 å­ SKILL ç¼–æ’æœºåˆ¶

**å¯¹åº”éœ€æ±‚**: FR-114 SKILL Marketplace

**ä¸» SKILL è°ƒç”¨å­ SKILL çš„æ–¹å¼**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SKILL ç¼–æ’æµç¨‹                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  /nomos:start "ç”¨æˆ·ç™»å½•åŠŸèƒ½"                                    â”‚
â”‚       â”‚                                                              â”‚
â”‚       â–¼                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ä¸» SKILL (SKILL.md)                                            â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ ## æµç¨‹ç¼–æ’                                                     â”‚ â”‚
â”‚  â”‚ 1. è°ƒç”¨ /nomos:new-task                                   â”‚ â”‚
â”‚  â”‚ 2. è°ƒç”¨ /nomos:research                                   â”‚ â”‚
â”‚  â”‚ 3. è°ƒç”¨ /nomos:plan                                       â”‚ â”‚
â”‚  â”‚ 4. ç­‰å¾…äººç±»æ‰¹æ³¨...                                              â”‚ â”‚
â”‚  â”‚ 5. è°ƒç”¨ /nomos:execute                                    â”‚ â”‚
â”‚  â”‚ 6. è°ƒç”¨ /nomos:validate                                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚       â”‚                                                              â”‚
â”‚       â”‚ å†…éƒ¨è°ƒç”¨ï¼ˆé€šè¿‡ Agent Handlerï¼‰                               â”‚
â”‚       â–¼                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ å­ SKILL: new-task/SKILL.md                                    â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚ - åˆ›å»º tasks/t1-xxx/ æ–‡ä»¶å¤¹                                     â”‚ â”‚
â”‚  â”‚ - åˆ›å»ºä¸‰ä»¶å¥—æ–‡ä»¶ï¼ˆresearch.md, plan.md, code_review.mdï¼‰        â”‚ â”‚
â”‚  â”‚ - åˆ›å»º Git åˆ†æ”¯                                                 â”‚ â”‚
â”‚  â”‚ - æ›´æ–° current-task.txt                                         â”‚ â”‚
â”‚  â”‚ - è¿”å› task_id ç»™ä¸» SKILL                                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å­ SKILL æ¨¡æ¿ç»“æ„**:

```markdown
# .claude/skills/nomos/new-task/SKILL.md

---
name: nomos/new-task
description: åˆ›å»ºæ–°ä»»åŠ¡å¹¶åˆå§‹åŒ–æ–‡ä»¶å¤¹
version: 1.0.0
inputs:
  - name: task_name
    description: ä»»åŠ¡åç§°
    required: true
  - name: task_type
    description: ä»»åŠ¡ç±»å‹ (feat/fix/refactor/test/docs)
    default: feat
outputs:
  - name: task_id
    description: ç”Ÿæˆçš„ä»»åŠ¡ ID
  - name: branch_name
    description: åˆ›å»ºçš„åˆ†æ”¯å
---

## ä»»åŠ¡

æ ¹æ®ç”¨æˆ·è¾“å…¥çš„ä»»åŠ¡åç§°ï¼Œåˆ›å»ºæ–°ä»»åŠ¡ã€‚

## æ­¥éª¤

1. è§£æä»»åŠ¡åç§°ï¼Œç”Ÿæˆ task_idï¼ˆæ ¼å¼ï¼št{N}-YYYY-MM-DD-{name}ï¼‰
2. æ£€æŸ¥ tasks/ ç›®å½•ï¼Œç¡®å®šä¸‹ä¸€ä¸ªåºå· N
3. åˆ›å»ºä»»åŠ¡æ–‡ä»¶å¤¹ï¼š`mkdir -p tasks/{task_id}`
4. åˆ›å»ºä¸‰ä»¶å¥—æ–‡ä»¶ï¼ˆä½¿ç”¨æ¨¡æ¿ï¼‰ï¼š
   - research.mdï¼ˆYAML Frontmatter + ç©ºå†…å®¹ï¼‰
   - plan.mdï¼ˆYAML Frontmatter + ç©ºå†…å®¹ï¼‰
   - code_review.mdï¼ˆYAML Frontmatter + ç©ºå†…å®¹ï¼‰
5. åˆ›å»º Git åˆ†æ”¯ï¼š`git checkout -b {task_type}/YYYY-MM-DD-{name}`
6. æ›´æ–° `.claude/current-task.txt`
7. æ›´æ–° `tasks/short-id-mapping.json`
8. è¿”å›ç»“æœç»™è°ƒç”¨è€…

## è¾“å‡ºæ ¼å¼

```json
{
  "task_id": "t1-2026-02-25-user-login",
  "branch_name": "feat/2026-02-25-user-login",
  "folder_path": "tasks/t1-2026-02-25-user-login/"
}
```
```

#### 11.1.2 SKILL ç‰ˆæœ¬ç®¡ç†

```json
// marketplace.json æ”¯æŒç‰ˆæœ¬é”å®š
{
  "name": "nomos",
  "version": "1.2.0",
  "min_claude_version": "1.0.0",
  "commands": {
    "start": {
      "skill": "nomos/start",
      "version": "^1.1.0"
    },
    "validate": {
      "skill": "nomos/validate",
      "version": "^1.0.0",
      "handler": {
        "type": "agent",
        "timeout": 60
      }
    }
  }
}
```

#### 11.1.3 SKILL å…±äº«æœºåˆ¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SKILL å…±äº«æ¨¡å¼                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  æ¨¡å¼ 1: é¡¹ç›®å†… SKILL                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ .claude/skills/nomos/                                     â”‚ â”‚
â”‚  â”‚ - éšé¡¹ç›® Git ä»“åº“ç‰ˆæœ¬æ§åˆ¶                                       â”‚ â”‚
â”‚  â”‚ - å›¢é˜Ÿæˆå‘˜è‡ªåŠ¨å…±äº«                                              â”‚ â”‚
â”‚  â”‚ - å¯æ ¹æ®é¡¹ç›®éœ€æ±‚å®šåˆ¶                                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â”‚  æ¨¡å¼ 2: å…¨å±€ SKILL                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ~/.claude/skills/nomos/                                   â”‚ â”‚
â”‚  â”‚ - è·¨é¡¹ç›®å…±äº«                                                    â”‚ â”‚
â”‚  â”‚ - ä¸ªäººåå¥½è®¾ç½®                                                  â”‚ â”‚
â”‚  â”‚ - ä¼˜å…ˆçº§ä½äºé¡¹ç›®å†… SKILL                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â”‚  æ¨¡å¼ 3: è¿œç¨‹ SKILLï¼ˆæœªæ¥ï¼‰                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ github:org/repo/skills/nomos                              â”‚ â”‚
â”‚  â”‚ - é€šè¿‡ Git URL å¼•ç”¨                                             â”‚ â”‚
â”‚  â”‚ - æ”¯æŒç‰ˆæœ¬æ ‡ç­¾                                                  â”‚ â”‚
â”‚  â”‚ - è‡ªåŠ¨æ›´æ–°æ£€æŸ¥                                                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 11.2 è‡ªå®šä¹‰è§„åˆ™æ‰©å±•

**BaseRule æ¥å£**:
```python
class BaseRule:
    def check(self, code, context) -> RuleResult:
        """
        Args:
            code: å¾…æ£€æŸ¥ä»£ç 
            context: ä¸Šä¸‹æ–‡(plan.md, research.md ç­‰)
        Returns:
            RuleResult(passed, errors, warnings)
        """
        pass

# é¡¹ç›®è‡ªå®šä¹‰è§„åˆ™
class CustomI18nRule(BaseRule):
    def check(self, code, context):
        if 't(' in code and 'customT(' not in code:
            return RuleResult(
                passed=False,
                errors=["å¿…é¡»ä½¿ç”¨ customT() è€Œä¸æ˜¯ t()"]
            )
        return RuleResult(passed=True)
```

### 11.3 æœªæ¥å¢å¼ºæ–¹å‘

- **AI æˆå°±ç³»ç»Ÿ**: è¿ç»­é›¶è¿”å·¥ã€çŸ¥è¯†åº“è´¡çŒ®ç­‰å¾½ç« 
- **å›¢é˜Ÿåä½œ**: å¤šäººå…±äº« project-why.md,å†²çªè‡ªåŠ¨åˆå¹¶
- **æ™ºèƒ½æ¨è**: æ ¹æ®å†å²ä»»åŠ¡æ¨èç›¸ä¼¼ Why é—®é¢˜
- **å¯è§†åŒ–ä»ªè¡¨ç›˜**: Web ç•Œé¢æŸ¥çœ‹æ‰€æœ‰ä»»åŠ¡ã€çŸ¥è¯†åº“ã€ç»Ÿè®¡æ•°æ®

---

## é™„å½•

### A. æ ¸å¿ƒæ–‡ä»¶æ¸…å•

| æ–‡ä»¶è·¯å¾„ | ç”¨é€” | ç»´æŠ¤è€… |
|---------|------|--------|
| `project-why.md` | å…¨é¡¹ç›®çŸ¥è¯†åº“ | AI + äººç±»æ‰¹æ³¨ |
| `tasks/t1-xxx/research.md` | å•ä»»åŠ¡è°ƒç ” | AI ç”Ÿæˆ,äººç±»æ‰¹æ³¨ |
| `tasks/t1-xxx/plan.md` | å•ä»»åŠ¡è®¡åˆ’ | AI ç”Ÿæˆ,äººç±»æ‰¹æ³¨ |
| `tasks/t1-xxx/code_review.md` | ä»£ç å®¡æŸ¥ | AI ç”Ÿæˆ,äººç±»æ‰¹æ³¨ |
| `.claude/skills/nomos/SKILL.md` | ä¸»æµç¨‹å®šä¹‰ | å¼€å‘è€… |
| `.claude/hooks/*.sh` | Hooks è„šæœ¬ | é¡¹ç›®å®šåˆ¶ |
| `tasks/short-id-mapping.json` | Short ID æ˜ å°„ | è‡ªåŠ¨ç»´æŠ¤ |

### B. ç¼©å†™è¯è¡¨

| ç¼©å†™ | å…¨ç§° |
|------|------|
| **PRD** | Product Requirements Document |
| **TDD** | Test-Driven Development |
| **CDN** | Content Delivery Network |
| **API** | Application Programming Interface |
| **HTTP** | Hypertext Transfer Protocol |
| **WebSocket** | Web Socket Protocol |
| **SVG** | Scalable Vector Graphics |
| **JSON** | JavaScript Object Notation |
| **YAML** | YAML Ain't Markup Language |

### C. å‚è€ƒæ–‡æ¡£

- [Claude Code Hooks å®˜æ–¹æ–‡æ¡£](https://docs.anthropic.com/claude-code/hooks)
- [Claude Code Skills å¼€å‘æŒ‡å—](https://docs.anthropic.com/claude-code/skills)
- [Superpowers Marketplace](https://github.com/obra/superpowers)
- [Mermaid.js æ–‡æ¡£](https://mermaid.js.org/)
- [02_PRD.md](./02_PRD.md) - äº§å“éœ€æ±‚æ–‡æ¡£
- [01_Structured_Notes.md](./01_Structured_Notes.md) - ç»“æ„åŒ–ç¬”è®°
