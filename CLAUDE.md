# CLAUDE.md - 项目指南

本文档记录 Claude Code 在本项目中的工作规范和约定。

---

## 1. 控制台绘图规范

在 CLI 终端环境中，使用以下方式呈现复杂信息：

### 1.1 ASCII 方框图（流程图/架构图）

用于展示**流程、架构、系统交互**等复杂结构：

```
┌─────────────────────────────────────────────────────────────────┐
│                         标题                                     │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌──────────────┐                                               │
│  │   组件 A     │                                               │
│  └──────┬───────┘                                               │
│         │                                                        │
│         ▼                                                        │
│  ┌──────────────┐     条件 A      ┌──────────┐                  │
│  │   组件 B     │ ──────────────► │  分支 X  │                  │
│  └──────┬───────┘                 └──────────┘                  │
│         │                                                        │
│         │ 条件 B                                                 │
│         ▼                                                        │
│  ┌──────────────┐                                               │
│  │   组件 C     │                                               │
│  └──────────────┘                                               │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

**绘制规则**:

| 元素 | 字符 | 示例 |
|------|------|------|
| 水平线 | `─` | `──────` |
| 垂直线 | `│` | `│` |
| 左上角 | `┌` | `┌────` |
| 右上角 | `┐` | `────┐` |
| 左下角 | `└` | `└────` |
| 右下角 | `┘` | `────┘` |
| 左连接 | `├` | `├────` |
| 右连接 | `┤` | `────┤` |
| 上连接 | `┬` | `┬` |
| 下连接 | `┴` | `┴` |
| 十字交叉 | `┼` | `┼` |
| 箭头 | `▼` `►` `◀` `▲` | `▼` `──►` |

**嵌套框**:

```
┌─────────────────────────────────────────────────────────────────┐
│                      外层容器                                    │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                    内层容器 A                               │ │
│  │  ┌──────────┐  ┌──────────┐                               │ │
│  │  │  元素 1  │  │  元素 2  │                               │ │
│  │  └──────────┘  └──────────┘                               │ │
│  └────────────────────────────────────────────────────────────┘ │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                    内层容器 B                               │ │
│  └────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

**循环/分支表示**:

```
│  ┌──────────────┐     条件失败      ┌──────────┐               │
│  │   处理逻辑   │ ◄─────────────── │  判断点  │               │
│  └──────────────┘                   └──────────┘               │
│         │                                │                      │
│         │ 条件通过                       │                      │
│         ▼                                │                      │
│  ┌──────────────┐                        │                      │
│  │   下一步     │ ◄──────────────────────┘                      │
│  └──────────────┘                                               │
```

### 1.2 Markdown 表格（对比/汇总）

用于展示**结构化数据、对比信息、配置项**等：

**基础表格**:

| 列 1 | 列 2 | 列 3 |
|------|------|------|
| 数据 | 数据 | 数据 |
| 数据 | 数据 | 数据 |

**对比表格**:

| 维度 | 方案 A | 方案 B |
|------|--------|--------|
| **优点** | 描述 | 描述 |
| **缺点** | 描述 | 描述 |
| **适用场景** | 描述 | 描述 |

**配置表格**:

| 参数 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| `param1` | string | `"default"` | 参数说明 |
| `param2` | int | `100` | 参数说明 |

**状态表格**:

| 组件 | 状态 | 说明 |
|------|------|------|
| 组件 A | ✅ 完成 | 描述 |
| 组件 B | ⏳ 进行中 | 描述 |
| 组件 C | ❌ 待处理 | 描述 |

### 1.3 代码块（示例/模板）

用于展示**代码示例、配置文件、数据结构**：

```markdown
# 标题说明

## 代码示例

\`\`\`python
def example():
    """代码说明"""
    return "value"
\`\`\`

## 配置示例

\`\`\`yaml
key: value
nested:
  key: value
\`\`\`
```

### 1.4 列表（步骤/要点）

用于展示**有序步骤、无序要点**：

**有序列表**（流程步骤）:

1. 第一步：描述
2. 第二步：描述
   - 子步骤 A
   - 子步骤 B
3. 第三步：描述

**无序列表**（要点罗列）:

- 要点一
- 要点二
  - 子要点
- 要点三

### 1.5 混合使用示例

```
┌─────────────────────────────────────────────────────────────────┐
│                    处理流程                                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  Step 1: 数据输入                                                │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │ 输入格式: JSON                                              │ │
│  │ { "key": "value" }                                         │ │
│  └────────────────────────────────────────────────────────────┘ │
│         │                                                        │
│         ▼                                                        │
│  Step 2: 数据处理                                                │
│  ┌─────────────────┐                                            │
│  │ 处理类型判断    │                                            │
│  └────────┬────────┘                                            │
│           │                                                      │
│     ┌─────┴─────┐                                               │
│     │           │                                               │
│   类型 A      类型 B                                             │
│     │           │                                               │
│     ▼           ▼                                               │
│  处理 A      处理 B                                              │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

| 处理类型 | 输入 | 输出 | 说明 |
|---------|------|------|------|
| 类型 A | JSON | XML | 转换处理 |
| 类型 B | JSON | CSV | 扁平化处理 |

---

## 2. 文档规范

### 2.1 文档结构

- 每个文档使用 YAML Frontmatter 包含元数据
- 使用清晰的层级标题（#, ##, ###）
- 复杂概念配合图表说明

### 2.2 术语约定

| 术语 | 含义 |
|------|------|
| N0mosAi | 项目品牌名 |
| Nomos | 项目内部引用名（源自希腊语 νόμος，法则） |
| nomosai | 仓库名/包名（全小写） |
| nomos | CLI 命令前缀 |
| Agent | AI 智能体（如 Claude） |
| Hook | Claude Code 生命周期钩子 |
| Phase | 阶段（Why-First/Research/Plan/Execute/Review） |
| Gate | 阶段门控点 |
| 标注 | 人类在文档中的批注 |

---

## 3. 项目结构

```
cw_N0mosAi/
├── CLAUDE.md                    # 项目指南
├── .claude/skills/doc-architect/ # 文档架构技能
└── doc-arch/agent-nomos-flow/   # N0mosAi 项目文档（11个文件）
```

---

## 4. 绘图字符快速参考

### 4.1 框线字符

```
角: ┌ ┐ └ ┘
边: ├ ┤ ┬ ┴ ┼
线: │ ─
双线: ╔ ╗ ╚ ╝ ║ ═
```

### 4.2 箭头

```
简单: → ← ↑ ↓
实心: ► ◄ ▲ ▼
长箭: ⟵ ⟶ ⟷
弯曲: ↳ ↴ ↱ ↰
双向: ↔ ↕ ⇄
```

### 4.3 常用符号

```
项目符号: • ◦ ▪ ▫ ★ ☆ ◆ ◇
对勾: ✅ ✓ ✔ ☑
叉号: ❌ ✗ ✘ ☒
问号: ❓ ? ❔
感叹: ❗ ⚠️ ⚡
数字: ① ② ③ ④ ⑤ ⑥ ⑦ ⑧ ⑨ ⑩
```

### 4.4 快速复制区

绘制流程图时常用组合：

```
# 基础框
┌──────────┐
│  内容    │
└──────────┘

# 带箭头流程
┌──────┐     ┌──────┐
│  A   │ ──► │  B   │
└──────┘     └──────┘

# 分支
      ┌──────┐
   ┌─►│  B   │
   │  └──────┘
┌──┴──┐
│  A  │
└──┬──┘
   │  ┌──────┐
   └─►│  C   │
      └──────┘

# 循环
┌──────┐
│  A   │ ◄──┐
└──┬───┘    │
   │        │
   └────────┘
```

---

## 5. Emoji 状态图标库

在文档和图表中，使用以下 Emoji 增强可读性和表达力：

### 5.1 状态与结果

| Emoji | 含义 | 使用场景 |
|:---:|------|---------|
| ✅ | 完成/通过 | 任务完成、测试通过、审核通过 |
| ❌ | 失败/错误/禁止 | 任务失败、测试失败、禁止操作 |
| ⏳ | 进行中/等待 | 任务进行中、等待处理 |
| ⏸️ | 暂停/阻塞 | 流程阻塞、等待依赖 |
| 🚫 | 不可用/禁用 | 功能禁用、不可访问 |
| ⚠️ | 警告/注意 | 需要注意的事项 |
| 🆕 | 新增 | 新功能、新文件 |
| 🔄 | 循环/重试 | 循环流程、重试操作 |
| 🔁 | 重复/迭代 | 迭代开发、重复执行 |

### 5.2 角色与身份

| Emoji | 含义 | 使用场景 |
|:---:|------|---------|
| 👤 | 用户/人类 | 人类操作、用户输入 |
| 🤖 | Agent/AI | AI 生成、Agent 回复 |
| 👨‍💻 | 开发者 | 开发者相关操作 |
| 👥 | 团队/多人 | 团队协作、多人参与 |
| 🔍 | 审查者 | 代码审查、Validator |

### 5.3 文件与数据

| Emoji | 含义 | 使用场景 |
|:---:|------|---------|
| 📄 | 文档/文件 | 普通文件 |
| 📝 | 笔记/标注 | 标注、批注、笔记 |
| 📋 | 清单/列表 | Checklist、任务列表 |
| 📊 | 图表/数据 | Mermaid 图、数据图表 |
| 🗂️ | 文件夹/归档 | 目录、归档文件 |
| 💾 | 保存/存储 | 保存操作、存储 |

### 5.4 操作与动作

| Emoji | 含义 | 使用场景 |
|:---:|------|---------|
| ➕ | 添加/新增 | 添加内容、新增功能 |
| ➖ | 删除/移除 | 删除内容、移除功能 |
| ✏️ | 编辑/修改 | 修改操作 |
| 🔧 | 配置/设置 | 配置项、设置 |
| 🚀 | 启动/部署 | 启动服务、部署 |
| 🛑 | 停止/终止 | 停止服务、终止流程 |
| ⚡ | 快速/触发 | 触发器、快速操作 |
| 🔗 | 连接/链接 | 关联、依赖关系 |
| 🔀 | 分支/切换 | Git 分支、任务切换 |

### 5.5 流程与阶段

| Emoji | 含义 | 使用场景 |
|:---:|------|---------|
| 🎯 | 目标/终点 | 任务目标、阶段终点 |
| 🚪 | 入口/门控 | 阶段门控、入口点 |
| 🔄 | 循环 | 循环流程 |
| ⤴️ | 上升/前进 | 进入下一阶段 |
| ⤵️ | 下降/回退 | 回到上一阶段、Revert |
| 🔀 | 分支 | 条件分支 |
| 📍 | 定位/锚点 | 标注位置、锚点 |

### 5.6 消息与通知

| Emoji | 含义 | 使用场景 |
|:---:|------|---------|
| 💬 | 对话/评论 | 评论、对话 |
| 🔔 | 通知/提醒 | 提醒、通知 |
| ❓ | 问题/疑问 | 提问、疑问 |
| 💡 | 想法/建议 | 建议、想法 |
| 📢 | 公告/广播 | 重要通知 |
| 🤔 | 思考/分析 | 思考过程、分析 |

### 5.7 质量与安全

| Emoji | 含义 | 使用场景 |
|:---:|------|---------|
| 🔒 | 安全/锁定 | 安全相关、权限控制 |
| 🔓 | 解锁/开放 | 开放访问 |
| 🛡️ | 保护/防御 | 安全防护、Protected Interface |
| ⚠️ | 警告 | 警告信息 |
| 🚨 | 严重警告/紧急 | 严重错误、紧急情况 |
| 🧪 | 测试 | 测试相关 |
| 🧹 | 清理 | 代码清理、重构 |

### 5.8 Git 与版本控制

| Emoji | 含义 | 使用场景 |
|:---:|------|---------|
| 📦 | 提交/包 | Git commit |
| 🔀 | 分支 | Git branch |
| 🏷️ | 标签 | Git tag、版本标签 |
| ⬆️ | 合并/升级 | Merge、升级 |
| ⏪ | 回滚 | Git revert |
| 📤 | 推送 | Git push |
| 📥 | 拉取 | Git pull |

### 5.9 颜色状态（文字描述）

在无法使用颜色的地方，用 Emoji 或文字表示：

| 状态 | Emoji | 文字描述 |
|------|:---:|---------|
| 成功/绿色 | 🟢 | `[GREEN]` `[OK]` |
| 警告/黄色 | 🟡 | `[YELLOW]` `[WARN]` |
| 错误/红色 | 🔴 | `[RED]` `[ERROR]` |
| 信息/蓝色 | 🔵 | `[BLUE]` `[INFO]` |
| 待处理/橙色 | 🟠 | `[ORANGE]` `[PENDING]` |
| 紫色/AI追问 | 🟣 | `[PURPLE]` `[AI_QUESTION]` |

### 5.10 组合使用示例

```
┌─────────────────────────────────────────────────────────────────┐
│  📋 任务状态面板                                                │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  🎯 当前任务: t1-2026-02-25-user-login                          │
│  📍 当前阶段: Execute (Phase 2/3)                               │
│                                                                  │
│  📊 进度概览:                                                    │
│  ├── ✅ Why-First    (完成)                                     │
│  ├── ✅ Research     (完成)                                     │
│  ├── ✅ Plan         (完成)                                     │
│  ├── ⏳ Execute      (进行中 - 60%)                             │
│  └── ⏸️ Review       (待开始)                                   │
│                                                                  │
│  🔔 待处理事项:                                                  │
│  ├── 📝 RC-1: pending (🟠 MAJOR)                                │
│  ├── ❓ RC-2: pending_ai_question (🟣 AI追问)                   │
│  └── ✅ RC-3: addressed (已处理)                                │
│                                                                  │
│  🧪 测试状态:                                                    │
│  ├── 🟢 单元测试: 94% 通过                                      │
│  ├── 🟢 集成测试: 88% 通过                                      │
│  └── ⏳ E2E 测试: 待执行                                        │
│                                                                  │
│  🔀 Git 状态:                                                    │
│  ├── 🔀 分支: feat/2026-02-25-user-login                        │
│  ├── 📦 Commits: 5 个                                           │
│  └── 📤 未推送: 2 个                                            │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 5.11 严重程度标记

| 严重程度 | Emoji | 标记格式 | 阻塞行为 |
|---------|:---:|---------|---------|
| 致命 | 🚨 | `[CRITICAL]` | 阻塞 + 可能 Revert |
| 严重 | ⚠️ | `[MAJOR]` | 阻塞 |
| 次要 | 📝 | `[MINOR]` | 不阻塞 |
| 建议 | 💡 | `[SUGGEST]` | 不阻塞 |
| 回滚 | ⏪ | `[REVERT]` | 自动 Revert |

---

*最后更新: 2026-02-25*
